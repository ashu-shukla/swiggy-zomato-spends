/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var XLSX = {}; function make_xlsx_lib(e) {
    e.version = "0.18.9"; var r = 1200, t = 1252; var a; var n = [874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 1e4]; var s = { 0: 1252, 1: 65001, 2: 65001, 77: 1e4, 128: 932, 129: 949, 130: 1361, 134: 936, 136: 950, 161: 1253, 162: 1254, 163: 1258, 177: 1255, 178: 1256, 186: 1257, 204: 1251, 222: 874, 238: 1250, 255: 1252, 69: 6969 }; var i = function (e) { if (n.indexOf(e) == -1) return; t = s[0] = e }; function l() { i(1252) } var o = function (e) { r = e; i(e) }; function c() { o(1200); l() } function f(e) { var r = []; for (var t = 0, a = e.length; t < a; ++t)r[t] = e.charCodeAt(t); return r } function u(e) { var r = []; for (var t = 0; t < e.length >> 1; ++t)r[t] = String.fromCharCode(e.charCodeAt(2 * t) + (e.charCodeAt(2 * t + 1) << 8)); return r.join("") } function h(e) { var r = []; for (var t = 0; t < e.length >> 1; ++t)r[t] = String.fromCharCode(e.charCodeAt(2 * t + 1) + (e.charCodeAt(2 * t) << 8)); return r.join("") } var d = function (e) { var r = e.charCodeAt(0), t = e.charCodeAt(1); if (r == 255 && t == 254) return u(e.slice(2)); if (r == 254 && t == 255) return h(e.slice(2)); if (r == 65279) return e.slice(1); return e }; var m = function Sc(e) { return String.fromCharCode(e) }; var p = function Cc(e) { return String.fromCharCode(e) }; function v(e) { a = e; o = function (e) { r = e; i(e) }; d = function (e) { if (e.charCodeAt(0) === 255 && e.charCodeAt(1) === 254) { return a.utils.decode(1200, f(e.slice(2))) } return e }; m = function n(e) { if (r === 1200) return String.fromCharCode(e); return a.utils.decode(r, [e & 255, e >> 8])[0] }; p = function s(e) { return a.utils.decode(t, [e])[0] }; ta() } var g = null; var b = true; var w = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="; function k(e) { var r = ""; var t = 0, a = 0, n = 0, s = 0, i = 0, l = 0, o = 0; for (var c = 0; c < e.length;) { t = e.charCodeAt(c++); s = t >> 2; a = e.charCodeAt(c++); i = (t & 3) << 4 | a >> 4; n = e.charCodeAt(c++); l = (a & 15) << 2 | n >> 6; o = n & 63; if (isNaN(a)) { l = o = 64 } else if (isNaN(n)) { o = 64 } r += w.charAt(s) + w.charAt(i) + w.charAt(l) + w.charAt(o) } return r } function y(e) { var r = ""; var t = 0, a = 0, n = 0, s = 0, i = 0, l = 0, o = 0; e = e.replace(/[^\w\+\/\=]/g, ""); for (var c = 0; c < e.length;) { s = w.indexOf(e.charAt(c++)); i = w.indexOf(e.charAt(c++)); t = s << 2 | i >> 4; r += String.fromCharCode(t); l = w.indexOf(e.charAt(c++)); a = (i & 15) << 4 | l >> 2; if (l !== 64) { r += String.fromCharCode(a) } o = w.indexOf(e.charAt(c++)); n = (l & 3) << 6 | o; if (o !== 64) { r += String.fromCharCode(n) } } return r } var x = function () { return typeof Buffer !== "undefined" && typeof undefined !== "undefined" && typeof {} !== "undefined" && !!{}.node }(); var S = function () { if (typeof Buffer !== "undefined") { var e = !Buffer.from; if (!e) try { Buffer.from("foo", "utf8") } catch (r) { e = true } return e ? function (e, r) { return r ? new Buffer(e, r) : new Buffer(e) } : Buffer.from.bind(Buffer) } return function () { } }(); function C(e) { if (x) return Buffer.alloc ? Buffer.alloc(e) : new Buffer(e); return typeof Uint8Array != "undefined" ? new Uint8Array(e) : new Array(e) } function _(e) { if (x) return Buffer.allocUnsafe ? Buffer.allocUnsafe(e) : new Buffer(e); return typeof Uint8Array != "undefined" ? new Uint8Array(e) : new Array(e) } var A = function _c(e) { if (x) return S(e, "binary"); return e.split("").map(function (e) { return e.charCodeAt(0) & 255 }) }; function F(e) { if (typeof ArrayBuffer === "undefined") return A(e); var r = new ArrayBuffer(e.length), t = new Uint8Array(r); for (var a = 0; a != e.length; ++a)t[a] = e.charCodeAt(a) & 255; return r } function E(e) { if (Array.isArray(e)) return e.map(function (e) { return String.fromCharCode(e) }).join(""); var r = []; for (var t = 0; t < e.length; ++t)r[t] = String.fromCharCode(e[t]); return r.join("") } function T(e) { if (typeof Uint8Array === "undefined") throw new Error("Unsupported"); return new Uint8Array(e) } function D(e) { if (typeof ArrayBuffer == "undefined") throw new Error("Unsupported"); if (e instanceof ArrayBuffer) return D(new Uint8Array(e)); var r = new Array(e.length); for (var t = 0; t < e.length; ++t)r[t] = e[t]; return r } var O = x ? function (e) { return Buffer.concat(e.map(function (e) { return Buffer.isBuffer(e) ? e : S(e) })) } : function (e) { if (typeof Uint8Array !== "undefined") { var r = 0, t = 0; for (r = 0; r < e.length; ++r)t += e[r].length; var a = new Uint8Array(t); var n = 0; for (r = 0, t = 0; r < e.length; t += n, ++r) { n = e[r].length; if (e[r] instanceof Uint8Array) a.set(e[r], t); else if (typeof e[r] == "string") { throw "wtf" } else a.set(new Uint8Array(e[r]), t) } return a } return [].concat.apply([], e.map(function (e) { return Array.isArray(e) ? e : [].slice.call(e) })) }; function M(e) { var r = [], t = 0, a = e.length + 250; var n = C(e.length + 255); for (var s = 0; s < e.length; ++s) { var i = e.charCodeAt(s); if (i < 128) n[t++] = i; else if (i < 2048) { n[t++] = 192 | i >> 6 & 31; n[t++] = 128 | i & 63 } else if (i >= 55296 && i < 57344) { i = (i & 1023) + 64; var l = e.charCodeAt(++s) & 1023; n[t++] = 240 | i >> 8 & 7; n[t++] = 128 | i >> 2 & 63; n[t++] = 128 | l >> 6 & 15 | (i & 3) << 4; n[t++] = 128 | l & 63 } else { n[t++] = 224 | i >> 12 & 15; n[t++] = 128 | i >> 6 & 63; n[t++] = 128 | i & 63 } if (t > a) { r.push(n.slice(0, t)); t = 0; n = C(65535); a = 65530 } } r.push(n.slice(0, t)); return O(r) } var N = /\u0000/g, P = /[\u0001-\u0006]/g; function I(e) { var r = "", t = e.length - 1; while (t >= 0) r += e.charAt(t--); return r } function R(e, r) { var t = "" + e; return t.length >= r ? t : xr("0", r - t.length) + t } function L(e, r) { var t = "" + e; return t.length >= r ? t : xr(" ", r - t.length) + t } function B(e, r) { var t = "" + e; return t.length >= r ? t : t + xr(" ", r - t.length) } function z(e, r) { var t = "" + Math.round(e); return t.length >= r ? t : xr("0", r - t.length) + t } function W(e, r) { var t = "" + e; return t.length >= r ? t : xr("0", r - t.length) + t } var U = Math.pow(2, 32); function j(e, r) { if (e > U || e < -U) return z(e, r); var t = Math.round(e); return W(t, r) } function H(e, r) { r = r || 0; return e.length >= 7 + r && (e.charCodeAt(r) | 32) === 103 && (e.charCodeAt(r + 1) | 32) === 101 && (e.charCodeAt(r + 2) | 32) === 110 && (e.charCodeAt(r + 3) | 32) === 101 && (e.charCodeAt(r + 4) | 32) === 114 && (e.charCodeAt(r + 5) | 32) === 97 && (e.charCodeAt(r + 6) | 32) === 108 } var V = [["Sun", "Sunday"], ["Mon", "Monday"], ["Tue", "Tuesday"], ["Wed", "Wednesday"], ["Thu", "Thursday"], ["Fri", "Friday"], ["Sat", "Saturday"]]; var X = [["J", "Jan", "January"], ["F", "Feb", "February"], ["M", "Mar", "March"], ["A", "Apr", "April"], ["M", "May", "May"], ["J", "Jun", "June"], ["J", "Jul", "July"], ["A", "Aug", "August"], ["S", "Sep", "September"], ["O", "Oct", "October"], ["N", "Nov", "November"], ["D", "Dec", "December"]]; function G(e) { if (!e) e = {}; e[0] = "General"; e[1] = "0"; e[2] = "0.00"; e[3] = "#,##0"; e[4] = "#,##0.00"; e[9] = "0%"; e[10] = "0.00%"; e[11] = "0.00E+00"; e[12] = "# ?/?"; e[13] = "# ??/??"; e[14] = "m/d/yy"; e[15] = "d-mmm-yy"; e[16] = "d-mmm"; e[17] = "mmm-yy"; e[18] = "h:mm AM/PM"; e[19] = "h:mm:ss AM/PM"; e[20] = "h:mm"; e[21] = "h:mm:ss"; e[22] = "m/d/yy h:mm"; e[37] = "#,##0 ;(#,##0)"; e[38] = "#,##0 ;[Red](#,##0)"; e[39] = "#,##0.00;(#,##0.00)"; e[40] = "#,##0.00;[Red](#,##0.00)"; e[45] = "mm:ss"; e[46] = "[h]:mm:ss"; e[47] = "mmss.0"; e[48] = "##0.0E+0"; e[49] = "@"; e[56] = '"上午/下午 "hh"時"mm"分"ss"秒 "'; return e } var Y = { 0: "General", 1: "0", 2: "0.00", 3: "#,##0", 4: "#,##0.00", 9: "0%", 10: "0.00%", 11: "0.00E+00", 12: "# ?/?", 13: "# ??/??", 14: "m/d/yy", 15: "d-mmm-yy", 16: "d-mmm", 17: "mmm-yy", 18: "h:mm AM/PM", 19: "h:mm:ss AM/PM", 20: "h:mm", 21: "h:mm:ss", 22: "m/d/yy h:mm", 37: "#,##0 ;(#,##0)", 38: "#,##0 ;[Red](#,##0)", 39: "#,##0.00;(#,##0.00)", 40: "#,##0.00;[Red](#,##0.00)", 45: "mm:ss", 46: "[h]:mm:ss", 47: "mmss.0", 48: "##0.0E+0", 49: "@", 56: '"上午/下午 "hh"時"mm"分"ss"秒 "' }; var J = { 5: 37, 6: 38, 7: 39, 8: 40, 23: 0, 24: 0, 25: 0, 26: 0, 27: 14, 28: 14, 29: 14, 30: 14, 31: 14, 50: 14, 51: 14, 52: 14, 53: 14, 54: 14, 55: 14, 56: 14, 57: 14, 58: 14, 59: 1, 60: 2, 61: 3, 62: 4, 67: 9, 68: 10, 69: 12, 70: 13, 71: 14, 72: 14, 73: 15, 74: 16, 75: 17, 76: 20, 77: 21, 78: 22, 79: 45, 80: 46, 81: 47, 82: 0 }; var K = { 5: '"$"#,##0_);\\("$"#,##0\\)', 63: '"$"#,##0_);\\("$"#,##0\\)', 6: '"$"#,##0_);[Red]\\("$"#,##0\\)', 64: '"$"#,##0_);[Red]\\("$"#,##0\\)', 7: '"$"#,##0.00_);\\("$"#,##0.00\\)', 65: '"$"#,##0.00_);\\("$"#,##0.00\\)', 8: '"$"#,##0.00_);[Red]\\("$"#,##0.00\\)', 66: '"$"#,##0.00_);[Red]\\("$"#,##0.00\\)', 41: '_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)', 42: '_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)', 43: '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)', 44: '_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)' }; function Z(e, r, t) { var a = e < 0 ? -1 : 1; var n = e * a; var s = 0, i = 1, l = 0; var o = 1, c = 0, f = 0; var u = Math.floor(n); while (c < r) { u = Math.floor(n); l = u * i + s; f = u * c + o; if (n - u < 5e-8) break; n = 1 / (n - u); s = i; i = l; o = c; c = f } if (f > r) { if (c > r) { f = o; l = s } else { f = c; l = i } } if (!t) return [0, a * l, f]; var h = Math.floor(a * l / f); return [h, a * l - h * f, f] } function q(e, r, t) { if (e > 2958465 || e < 0) return null; var a = e | 0, n = Math.floor(86400 * (e - a)), s = 0; var i = []; var l = { D: a, T: n, u: 86400 * (e - a) - n, y: 0, m: 0, d: 0, H: 0, M: 0, S: 0, q: 0 }; if (Math.abs(l.u) < 1e-6) l.u = 0; if (r && r.date1904) a += 1462; if (l.u > .9999) { l.u = 0; if (++n == 86400) { l.T = n = 0; ++a; ++l.D } } if (a === 60) { i = t ? [1317, 10, 29] : [1900, 2, 29]; s = 3 } else if (a === 0) { i = t ? [1317, 8, 29] : [1900, 1, 0]; s = 6 } else { if (a > 60) --a; var o = new Date(1900, 0, 1); o.setDate(o.getDate() + a - 1); i = [o.getFullYear(), o.getMonth() + 1, o.getDate()]; s = o.getDay(); if (a < 60) s = (s + 6) % 7; if (t) s = ce(o, i) } l.y = i[0]; l.m = i[1]; l.d = i[2]; l.S = n % 60; n = Math.floor(n / 60); l.M = n % 60; n = Math.floor(n / 60); l.H = n; l.q = s; return l } var Q = new Date(1899, 11, 31, 0, 0, 0); var ee = Q.getTime(); var re = new Date(1900, 2, 1, 0, 0, 0); function te(e, r) { var t = e.getTime(); if (r) t -= 1461 * 24 * 60 * 60 * 1e3; else if (e >= re) t += 24 * 60 * 60 * 1e3; return (t - (ee + (e.getTimezoneOffset() - Q.getTimezoneOffset()) * 6e4)) / (24 * 60 * 60 * 1e3) } function ae(e) { return e.indexOf(".") == -1 ? e : e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/, "$1") } function ne(e) { if (e.indexOf("E") == -1) return e; return e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/, "$1E").replace(/(E[+-])(\d)$/, "$10$2") } function se(e) { var r = e < 0 ? 12 : 11; var t = ae(e.toFixed(12)); if (t.length <= r) return t; t = e.toPrecision(10); if (t.length <= r) return t; return e.toExponential(5) } function ie(e) { var r = ae(e.toFixed(11)); return r.length > (e < 0 ? 12 : 11) || r === "0" || r === "-0" ? e.toPrecision(6) : r } function le(e) { var r = Math.floor(Math.log(Math.abs(e)) * Math.LOG10E), t; if (r >= -4 && r <= -1) t = e.toPrecision(10 + r); else if (Math.abs(r) <= 9) t = se(e); else if (r === 10) t = e.toFixed(10).substr(0, 12); else t = ie(e); return ae(ne(t.toUpperCase())) } function oe(e, r) { switch (typeof e) { case "string": return e; case "boolean": return e ? "TRUE" : "FALSE"; case "number": return (e | 0) === e ? e.toString(10) : le(e); case "undefined": return ""; case "object": if (e == null) return ""; if (e instanceof Date) return $e(14, te(e, r && r.date1904), r); }throw new Error("unsupported value in General format: " + e) } function ce(e, r) { r[0] -= 581; var t = e.getDay(); if (e < 60) t = (t + 6) % 7; return t } function fe(e, r, t, a) { var n = "", s = 0, i = 0, l = t.y, o, c = 0; switch (e) { case 98: l = t.y + 543; case 121: switch (r.length) { case 1: ; case 2: o = l % 100; c = 2; break; default: o = l % 1e4; c = 4; break; }break; case 109: switch (r.length) { case 1: ; case 2: o = t.m; c = r.length; break; case 3: return X[t.m - 1][1]; case 5: return X[t.m - 1][0]; default: return X[t.m - 1][2]; }break; case 100: switch (r.length) { case 1: ; case 2: o = t.d; c = r.length; break; case 3: return V[t.q][0]; default: return V[t.q][1]; }break; case 104: switch (r.length) { case 1: ; case 2: o = 1 + (t.H + 11) % 12; c = r.length; break; default: throw "bad hour format: " + r; }break; case 72: switch (r.length) { case 1: ; case 2: o = t.H; c = r.length; break; default: throw "bad hour format: " + r; }break; case 77: switch (r.length) { case 1: ; case 2: o = t.M; c = r.length; break; default: throw "bad minute format: " + r; }break; case 115: if (r != "s" && r != "ss" && r != ".0" && r != ".00" && r != ".000") throw "bad second format: " + r; if (t.u === 0 && (r == "s" || r == "ss")) return R(t.S, r.length); if (a >= 2) i = a === 3 ? 1e3 : 100; else i = a === 1 ? 10 : 1; s = Math.round(i * (t.S + t.u)); if (s >= 60 * i) s = 0; if (r === "s") return s === 0 ? "0" : "" + s / i; n = R(s, 2 + a); if (r === "ss") return n.substr(0, 2); return "." + n.substr(2, r.length - 1); case 90: switch (r) { case "[h]": ; case "[hh]": o = t.D * 24 + t.H; break; case "[m]": ; case "[mm]": o = (t.D * 24 + t.H) * 60 + t.M; break; case "[s]": ; case "[ss]": o = ((t.D * 24 + t.H) * 60 + t.M) * 60 + Math.round(t.S + t.u); break; default: throw "bad abstime format: " + r; }c = r.length === 3 ? 1 : 2; break; case 101: o = l; c = 1; break; }var f = c > 0 ? R(o, c) : ""; return f } function ue(e) { var r = 3; if (e.length <= r) return e; var t = e.length % r, a = e.substr(0, t); for (; t != e.length; t += r)a += (a.length > 0 ? "," : "") + e.substr(t, r); return a } var he = /%/g; function de(e, r, t) { var a = r.replace(he, ""), n = r.length - a.length; return Me(e, a, t * Math.pow(10, 2 * n)) + xr("%", n) } function me(e, r, t) { var a = r.length - 1; while (r.charCodeAt(a - 1) === 44) --a; return Me(e, r.substr(0, a), t / Math.pow(10, 3 * (r.length - a))) } function pe(e, r) { var t; var a = e.indexOf("E") - e.indexOf(".") - 1; if (e.match(/^#+0.0E\+0$/)) { if (r == 0) return "0.0E+0"; else if (r < 0) return "-" + pe(e, -r); var n = e.indexOf("."); if (n === -1) n = e.indexOf("E"); var s = Math.floor(Math.log(r) * Math.LOG10E) % n; if (s < 0) s += n; t = (r / Math.pow(10, s)).toPrecision(a + 1 + (n + s) % n); if (t.indexOf("e") === -1) { var i = Math.floor(Math.log(r) * Math.LOG10E); if (t.indexOf(".") === -1) t = t.charAt(0) + "." + t.substr(1) + "E+" + (i - t.length + s); else t += "E+" + (i - s); while (t.substr(0, 2) === "0.") { t = t.charAt(0) + t.substr(2, n) + "." + t.substr(2 + n); t = t.replace(/^0+([1-9])/, "$1").replace(/^0+\./, "0.") } t = t.replace(/\+-/, "-") } t = t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/, function (e, r, t, a) { return r + t + a.substr(0, (n + s) % n) + "." + a.substr(s) + "E" }) } else t = r.toExponential(a); if (e.match(/E\+00$/) && t.match(/e[+-]\d$/)) t = t.substr(0, t.length - 1) + "0" + t.charAt(t.length - 1); if (e.match(/E\-/) && t.match(/e\+/)) t = t.replace(/e\+/, "e"); return t.replace("e", "E") } var ve = /# (\?+)( ?)\/( ?)(\d+)/; function ge(e, r, t) { var a = parseInt(e[4], 10), n = Math.round(r * a), s = Math.floor(n / a); var i = n - s * a, l = a; return t + (s === 0 ? "" : "" + s) + " " + (i === 0 ? xr(" ", e[1].length + 1 + e[4].length) : L(i, e[1].length) + e[2] + "/" + e[3] + R(l, e[4].length)) } function be(e, r, t) { return t + (r === 0 ? "" : "" + r) + xr(" ", e[1].length + 2 + e[4].length) } var we = /^#*0*\.([0#]+)/; var ke = /\).*[0#]/; var ye = /\(###\) ###\\?-####/; function xe(e) { var r = "", t; for (var a = 0; a != e.length; ++a)switch (t = e.charCodeAt(a)) { case 35: break; case 63: r += " "; break; case 48: r += "0"; break; default: r += String.fromCharCode(t); }return r } function Se(e, r) { var t = Math.pow(10, r); return "" + Math.round(e * t) / t } function Ce(e, r) { var t = e - Math.floor(e), a = Math.pow(10, r); if (r < ("" + Math.round(t * a)).length) return 0; return Math.round(t * a) } function _e(e, r) { if (r < ("" + Math.round((e - Math.floor(e)) * Math.pow(10, r))).length) { return 1 } return 0 } function Ae(e) { if (e < 2147483647 && e > -2147483648) return "" + (e >= 0 ? e | 0 : e - 1 | 0); return "" + Math.floor(e) } function Fe(e, r, t) { if (e.charCodeAt(0) === 40 && !r.match(ke)) { var a = r.replace(/\( */, "").replace(/ \)/, "").replace(/\)/, ""); if (t >= 0) return Fe("n", a, t); return "(" + Fe("n", a, -t) + ")" } if (r.charCodeAt(r.length - 1) === 44) return me(e, r, t); if (r.indexOf("%") !== -1) return de(e, r, t); if (r.indexOf("E") !== -1) return pe(r, t); if (r.charCodeAt(0) === 36) return "$" + Fe(e, r.substr(r.charAt(1) == " " ? 2 : 1), t); var n; var s, i, l, o = Math.abs(t), c = t < 0 ? "-" : ""; if (r.match(/^00+$/)) return c + j(o, r.length); if (r.match(/^[#?]+$/)) { n = j(t, 0); if (n === "0") n = ""; return n.length > r.length ? n : xe(r.substr(0, r.length - n.length)) + n } if (s = r.match(ve)) return ge(s, o, c); if (r.match(/^#+0+$/)) return c + j(o, r.length - r.indexOf("0")); if (s = r.match(we)) { n = Se(t, s[1].length).replace(/^([^\.]+)$/, "$1." + xe(s[1])).replace(/\.$/, "." + xe(s[1])).replace(/\.(\d*)$/, function (e, r) { return "." + r + xr("0", xe(s[1]).length - r.length) }); return r.indexOf("0.") !== -1 ? n : n.replace(/^0\./, ".") } r = r.replace(/^#+([0.])/, "$1"); if (s = r.match(/^(0*)\.(#*)$/)) { return c + Se(o, s[2].length).replace(/\.(\d*[1-9])0*$/, ".$1").replace(/^(-?\d*)$/, "$1.").replace(/^0\./, s[1].length ? "0." : ".") } if (s = r.match(/^#{1,3},##0(\.?)$/)) return c + ue(j(o, 0)); if (s = r.match(/^#,##0\.([#0]*0)$/)) { return t < 0 ? "-" + Fe(e, r, -t) : ue("" + (Math.floor(t) + _e(t, s[1].length))) + "." + R(Ce(t, s[1].length), s[1].length) } if (s = r.match(/^#,#*,#0/)) return Fe(e, r.replace(/^#,#*,/, ""), t); if (s = r.match(/^([0#]+)(\\?-([0#]+))+$/)) { n = I(Fe(e, r.replace(/[\\-]/g, ""), t)); i = 0; return I(I(r.replace(/\\/g, "")).replace(/[0#]/g, function (e) { return i < n.length ? n.charAt(i++) : e === "0" ? "0" : "" })) } if (r.match(ye)) { n = Fe(e, "##########", t); return "(" + n.substr(0, 3) + ") " + n.substr(3, 3) + "-" + n.substr(6) } var f = ""; if (s = r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)) { i = Math.min(s[4].length, 7); l = Z(o, Math.pow(10, i) - 1, false); n = "" + c; f = Me("n", s[1], l[1]); if (f.charAt(f.length - 1) == " ") f = f.substr(0, f.length - 1) + "0"; n += f + s[2] + "/" + s[3]; f = B(l[2], i); if (f.length < s[4].length) f = xe(s[4].substr(s[4].length - f.length)) + f; n += f; return n } if (s = r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)) { i = Math.min(Math.max(s[1].length, s[4].length), 7); l = Z(o, Math.pow(10, i) - 1, true); return c + (l[0] || (l[1] ? "" : "0")) + " " + (l[1] ? L(l[1], i) + s[2] + "/" + s[3] + B(l[2], i) : xr(" ", 2 * i + 1 + s[2].length + s[3].length)) } if (s = r.match(/^[#0?]+$/)) { n = j(t, 0); if (r.length <= n.length) return n; return xe(r.substr(0, r.length - n.length)) + n } if (s = r.match(/^([#0?]+)\.([#0]+)$/)) { n = "" + t.toFixed(Math.min(s[2].length, 10)).replace(/([^0])0+$/, "$1"); i = n.indexOf("."); var u = r.indexOf(".") - i, h = r.length - n.length - u; return xe(r.substr(0, u) + n + r.substr(r.length - h)) } if (s = r.match(/^00,000\.([#0]*0)$/)) { i = Ce(t, s[1].length); return t < 0 ? "-" + Fe(e, r, -t) : ue(Ae(t)).replace(/^\d,\d{3}$/, "0$&").replace(/^\d*$/, function (e) { return "00," + (e.length < 3 ? R(0, 3 - e.length) : "") + e }) + "." + R(i, s[1].length) } switch (r) { case "###,##0.00": return Fe(e, "#,##0.00", t); case "###,###": ; case "##,###": ; case "#,###": var d = ue(j(o, 0)); return d !== "0" ? c + d : ""; case "###,###.00": return Fe(e, "###,##0.00", t).replace(/^0\./, "."); case "#,###.00": return Fe(e, "#,##0.00", t).replace(/^0\./, "."); default: ; }throw new Error("unsupported format |" + r + "|") } function Ee(e, r, t) { var a = r.length - 1; while (r.charCodeAt(a - 1) === 44) --a; return Me(e, r.substr(0, a), t / Math.pow(10, 3 * (r.length - a))) } function Te(e, r, t) { var a = r.replace(he, ""), n = r.length - a.length; return Me(e, a, t * Math.pow(10, 2 * n)) + xr("%", n) } function De(e, r) { var t; var a = e.indexOf("E") - e.indexOf(".") - 1; if (e.match(/^#+0.0E\+0$/)) { if (r == 0) return "0.0E+0"; else if (r < 0) return "-" + De(e, -r); var n = e.indexOf("."); if (n === -1) n = e.indexOf("E"); var s = Math.floor(Math.log(r) * Math.LOG10E) % n; if (s < 0) s += n; t = (r / Math.pow(10, s)).toPrecision(a + 1 + (n + s) % n); if (!t.match(/[Ee]/)) { var i = Math.floor(Math.log(r) * Math.LOG10E); if (t.indexOf(".") === -1) t = t.charAt(0) + "." + t.substr(1) + "E+" + (i - t.length + s); else t += "E+" + (i - s); t = t.replace(/\+-/, "-") } t = t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/, function (e, r, t, a) { return r + t + a.substr(0, (n + s) % n) + "." + a.substr(s) + "E" }) } else t = r.toExponential(a); if (e.match(/E\+00$/) && t.match(/e[+-]\d$/)) t = t.substr(0, t.length - 1) + "0" + t.charAt(t.length - 1); if (e.match(/E\-/) && t.match(/e\+/)) t = t.replace(/e\+/, "e"); return t.replace("e", "E") } function Oe(e, r, t) { if (e.charCodeAt(0) === 40 && !r.match(ke)) { var a = r.replace(/\( */, "").replace(/ \)/, "").replace(/\)/, ""); if (t >= 0) return Oe("n", a, t); return "(" + Oe("n", a, -t) + ")" } if (r.charCodeAt(r.length - 1) === 44) return Ee(e, r, t); if (r.indexOf("%") !== -1) return Te(e, r, t); if (r.indexOf("E") !== -1) return De(r, t); if (r.charCodeAt(0) === 36) return "$" + Oe(e, r.substr(r.charAt(1) == " " ? 2 : 1), t); var n; var s, i, l, o = Math.abs(t), c = t < 0 ? "-" : ""; if (r.match(/^00+$/)) return c + R(o, r.length); if (r.match(/^[#?]+$/)) { n = "" + t; if (t === 0) n = ""; return n.length > r.length ? n : xe(r.substr(0, r.length - n.length)) + n } if (s = r.match(ve)) return be(s, o, c); if (r.match(/^#+0+$/)) return c + R(o, r.length - r.indexOf("0")); if (s = r.match(we)) { n = ("" + t).replace(/^([^\.]+)$/, "$1." + xe(s[1])).replace(/\.$/, "." + xe(s[1])); n = n.replace(/\.(\d*)$/, function (e, r) { return "." + r + xr("0", xe(s[1]).length - r.length) }); return r.indexOf("0.") !== -1 ? n : n.replace(/^0\./, ".") } r = r.replace(/^#+([0.])/, "$1"); if (s = r.match(/^(0*)\.(#*)$/)) { return c + ("" + o).replace(/\.(\d*[1-9])0*$/, ".$1").replace(/^(-?\d*)$/, "$1.").replace(/^0\./, s[1].length ? "0." : ".") } if (s = r.match(/^#{1,3},##0(\.?)$/)) return c + ue("" + o); if (s = r.match(/^#,##0\.([#0]*0)$/)) { return t < 0 ? "-" + Oe(e, r, -t) : ue("" + t) + "." + xr("0", s[1].length) } if (s = r.match(/^#,#*,#0/)) return Oe(e, r.replace(/^#,#*,/, ""), t); if (s = r.match(/^([0#]+)(\\?-([0#]+))+$/)) { n = I(Oe(e, r.replace(/[\\-]/g, ""), t)); i = 0; return I(I(r.replace(/\\/g, "")).replace(/[0#]/g, function (e) { return i < n.length ? n.charAt(i++) : e === "0" ? "0" : "" })) } if (r.match(ye)) { n = Oe(e, "##########", t); return "(" + n.substr(0, 3) + ") " + n.substr(3, 3) + "-" + n.substr(6) } var f = ""; if (s = r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)) { i = Math.min(s[4].length, 7); l = Z(o, Math.pow(10, i) - 1, false); n = "" + c; f = Me("n", s[1], l[1]); if (f.charAt(f.length - 1) == " ") f = f.substr(0, f.length - 1) + "0"; n += f + s[2] + "/" + s[3]; f = B(l[2], i); if (f.length < s[4].length) f = xe(s[4].substr(s[4].length - f.length)) + f; n += f; return n } if (s = r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)) { i = Math.min(Math.max(s[1].length, s[4].length), 7); l = Z(o, Math.pow(10, i) - 1, true); return c + (l[0] || (l[1] ? "" : "0")) + " " + (l[1] ? L(l[1], i) + s[2] + "/" + s[3] + B(l[2], i) : xr(" ", 2 * i + 1 + s[2].length + s[3].length)) } if (s = r.match(/^[#0?]+$/)) { n = "" + t; if (r.length <= n.length) return n; return xe(r.substr(0, r.length - n.length)) + n } if (s = r.match(/^([#0]+)\.([#0]+)$/)) { n = "" + t.toFixed(Math.min(s[2].length, 10)).replace(/([^0])0+$/, "$1"); i = n.indexOf("."); var u = r.indexOf(".") - i, h = r.length - n.length - u; return xe(r.substr(0, u) + n + r.substr(r.length - h)) } if (s = r.match(/^00,000\.([#0]*0)$/)) { return t < 0 ? "-" + Oe(e, r, -t) : ue("" + t).replace(/^\d,\d{3}$/, "0$&").replace(/^\d*$/, function (e) { return "00," + (e.length < 3 ? R(0, 3 - e.length) : "") + e }) + "." + R(0, s[1].length) } switch (r) { case "###,###": ; case "##,###": ; case "#,###": var d = ue("" + o); return d !== "0" ? c + d : ""; default: if (r.match(/\.[0#?]*$/)) return Oe(e, r.slice(0, r.lastIndexOf(".")), t) + xe(r.slice(r.lastIndexOf("."))); }throw new Error("unsupported format |" + r + "|") } function Me(e, r, t) { return (t | 0) === t ? Oe(e, r, t) : Fe(e, r, t) } function Ne(e) { var r = []; var t = false; for (var a = 0, n = 0; a < e.length; ++a)switch (e.charCodeAt(a)) { case 34: t = !t; break; case 95: ; case 42: ; case 92: ++a; break; case 59: r[r.length] = e.substr(n, a - n); n = a + 1; }r[r.length] = e.substr(n); if (t === true) throw new Error("Format |" + e + "| unterminated string "); return r } var Pe = /\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/; function Ie(e) { var r = 0, t = "", a = ""; while (r < e.length) { switch (t = e.charAt(r)) { case "G": if (H(e, r)) r += 6; r++; break; case '"': for (; e.charCodeAt(++r) !== 34 && r < e.length;) { } ++r; break; case "\\": r += 2; break; case "_": r += 2; break; case "@": ++r; break; case "B": ; case "b": if (e.charAt(r + 1) === "1" || e.charAt(r + 1) === "2") return true; case "M": ; case "D": ; case "Y": ; case "H": ; case "S": ; case "E": ; case "m": ; case "d": ; case "y": ; case "h": ; case "s": ; case "e": ; case "g": return true; case "A": ; case "a": ; case "上": if (e.substr(r, 3).toUpperCase() === "A/P") return true; if (e.substr(r, 5).toUpperCase() === "AM/PM") return true; if (e.substr(r, 5).toUpperCase() === "上午/下午") return true; ++r; break; case "[": a = t; while (e.charAt(r++) !== "]" && r < e.length) a += e.charAt(r); if (a.match(Pe)) return true; break; case ".": ; case "0": ; case "#": while (r < e.length && ("0#?.,E+-%".indexOf(t = e.charAt(++r)) > -1 || t == "\\" && e.charAt(r + 1) == "-" && "0#".indexOf(e.charAt(r + 2)) > -1)) { } break; case "?": while (e.charAt(++r) === t) { } break; case "*": ++r; if (e.charAt(r) == " " || e.charAt(r) == "*") ++r; break; case "(": ; case ")": ++r; break; case "1": ; case "2": ; case "3": ; case "4": ; case "5": ; case "6": ; case "7": ; case "8": ; case "9": while (r < e.length && "0123456789".indexOf(e.charAt(++r)) > -1) { } break; case " ": ++r; break; default: ++r; break; } } return false } function Re(e, r, t, a) { var n = [], s = "", i = 0, l = "", o = "t", c, f, u; var h = "H"; while (i < e.length) { switch (l = e.charAt(i)) { case "G": if (!H(e, i)) throw new Error("unrecognized character " + l + " in " + e); n[n.length] = { t: "G", v: "General" }; i += 7; break; case '"': for (s = ""; (u = e.charCodeAt(++i)) !== 34 && i < e.length;)s += String.fromCharCode(u); n[n.length] = { t: "t", v: s }; ++i; break; case "\\": var d = e.charAt(++i), m = d === "(" || d === ")" ? d : "t"; n[n.length] = { t: m, v: d }; ++i; break; case "_": n[n.length] = { t: "t", v: " " }; i += 2; break; case "@": n[n.length] = { t: "T", v: r }; ++i; break; case "B": ; case "b": if (e.charAt(i + 1) === "1" || e.charAt(i + 1) === "2") { if (c == null) { c = q(r, t, e.charAt(i + 1) === "2"); if (c == null) return "" } n[n.length] = { t: "X", v: e.substr(i, 2) }; o = l; i += 2; break }; case "M": ; case "D": ; case "Y": ; case "H": ; case "S": ; case "E": l = l.toLowerCase(); case "m": ; case "d": ; case "y": ; case "h": ; case "s": ; case "e": ; case "g": if (r < 0) return ""; if (c == null) { c = q(r, t); if (c == null) return "" } s = l; while (++i < e.length && e.charAt(i).toLowerCase() === l) s += l; if (l === "m" && o.toLowerCase() === "h") l = "M"; if (l === "h") l = h; n[n.length] = { t: l, v: s }; o = l; break; case "A": ; case "a": ; case "上": var p = { t: l, v: l }; if (c == null) c = q(r, t); if (e.substr(i, 3).toUpperCase() === "A/P") { if (c != null) p.v = c.H >= 12 ? e.charAt(i + 2) : l; p.t = "T"; h = "h"; i += 3 } else if (e.substr(i, 5).toUpperCase() === "AM/PM") { if (c != null) p.v = c.H >= 12 ? "PM" : "AM"; p.t = "T"; i += 5; h = "h" } else if (e.substr(i, 5).toUpperCase() === "上午/下午") { if (c != null) p.v = c.H >= 12 ? "下午" : "上午"; p.t = "T"; i += 5; h = "h" } else { p.t = "t"; ++i } if (c == null && p.t === "T") return ""; n[n.length] = p; o = l; break; case "[": s = l; while (e.charAt(i++) !== "]" && i < e.length) s += e.charAt(i); if (s.slice(-1) !== "]") throw 'unterminated "[" block: |' + s + "|"; if (s.match(Pe)) { if (c == null) { c = q(r, t); if (c == null) return "" } n[n.length] = { t: "Z", v: s.toLowerCase() }; o = s.charAt(1) } else if (s.indexOf("$") > -1) { s = (s.match(/\$([^-\[\]]*)/) || [])[1] || "$"; if (!Ie(e)) n[n.length] = { t: "t", v: s } } break; case ".": if (c != null) { s = l; while (++i < e.length && (l = e.charAt(i)) === "0") s += l; n[n.length] = { t: "s", v: s }; break }; case "0": ; case "#": s = l; while (++i < e.length && "0#?.,E+-%".indexOf(l = e.charAt(i)) > -1) s += l; n[n.length] = { t: "n", v: s }; break; case "?": s = l; while (e.charAt(++i) === l) s += l; n[n.length] = { t: l, v: s }; o = l; break; case "*": ++i; if (e.charAt(i) == " " || e.charAt(i) == "*") ++i; break; case "(": ; case ")": n[n.length] = { t: a === 1 ? "t" : l, v: l }; ++i; break; case "1": ; case "2": ; case "3": ; case "4": ; case "5": ; case "6": ; case "7": ; case "8": ; case "9": s = l; while (i < e.length && "0123456789".indexOf(e.charAt(++i)) > -1) s += e.charAt(i); n[n.length] = { t: "D", v: s }; break; case " ": n[n.length] = { t: l, v: l }; ++i; break; case "$": n[n.length] = { t: "t", v: "$" }; ++i; break; default: if (",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l) === -1) throw new Error("unrecognized character " + l + " in " + e); n[n.length] = { t: "t", v: l }; ++i; break; } } var v = 0, g = 0, b; for (i = n.length - 1, o = "t"; i >= 0; --i) { switch (n[i].t) { case "h": ; case "H": n[i].t = h; o = "h"; if (v < 1) v = 1; break; case "s": if (b = n[i].v.match(/\.0+$/)) g = Math.max(g, b[0].length - 1); if (v < 3) v = 3; case "d": ; case "y": ; case "M": ; case "e": o = n[i].t; break; case "m": if (o === "s") { n[i].t = "M"; if (v < 2) v = 2 } break; case "X": break; case "Z": if (v < 1 && n[i].v.match(/[Hh]/)) v = 1; if (v < 2 && n[i].v.match(/[Mm]/)) v = 2; if (v < 3 && n[i].v.match(/[Ss]/)) v = 3; } } switch (v) { case 0: break; case 1: if (c.u >= .5) { c.u = 0; ++c.S } if (c.S >= 60) { c.S = 0; ++c.M } if (c.M >= 60) { c.M = 0; ++c.H } break; case 2: if (c.u >= .5) { c.u = 0; ++c.S } if (c.S >= 60) { c.S = 0; ++c.M } break; }var w = "", k; for (i = 0; i < n.length; ++i) { switch (n[i].t) { case "t": ; case "T": ; case " ": ; case "D": break; case "X": n[i].v = ""; n[i].t = ";"; break; case "d": ; case "m": ; case "y": ; case "h": ; case "H": ; case "M": ; case "s": ; case "e": ; case "b": ; case "Z": n[i].v = fe(n[i].t.charCodeAt(0), n[i].v, c, g); n[i].t = "t"; break; case "n": ; case "?": k = i + 1; while (n[k] != null && ((l = n[k].t) === "?" || l === "D" || (l === " " || l === "t") && n[k + 1] != null && (n[k + 1].t === "?" || n[k + 1].t === "t" && n[k + 1].v === "/") || n[i].t === "(" && (l === " " || l === "n" || l === ")") || l === "t" && (n[k].v === "/" || n[k].v === " " && n[k + 1] != null && n[k + 1].t == "?"))) { n[i].v += n[k].v; n[k] = { v: "", t: ";" }; ++k } w += n[i].v; i = k - 1; break; case "G": n[i].t = "t"; n[i].v = oe(r, t); break; } } var y = "", x, S; if (w.length > 0) { if (w.charCodeAt(0) == 40) { x = r < 0 && w.charCodeAt(0) === 45 ? -r : r; S = Me("n", w, x) } else { x = r < 0 && a > 1 ? -r : r; S = Me("n", w, x); if (x < 0 && n[0] && n[0].t == "t") { S = S.substr(1); n[0].v = "-" + n[0].v } } k = S.length - 1; var C = n.length; for (i = 0; i < n.length; ++i)if (n[i] != null && n[i].t != "t" && n[i].v.indexOf(".") > -1) { C = i; break } var _ = n.length; if (C === n.length && S.indexOf("E") === -1) { for (i = n.length - 1; i >= 0; --i) { if (n[i] == null || "n?".indexOf(n[i].t) === -1) continue; if (k >= n[i].v.length - 1) { k -= n[i].v.length; n[i].v = S.substr(k + 1, n[i].v.length) } else if (k < 0) n[i].v = ""; else { n[i].v = S.substr(0, k + 1); k = -1 } n[i].t = "t"; _ = i } if (k >= 0 && _ < n.length) n[_].v = S.substr(0, k + 1) + n[_].v } else if (C !== n.length && S.indexOf("E") === -1) { k = S.indexOf(".") - 1; for (i = C; i >= 0; --i) { if (n[i] == null || "n?".indexOf(n[i].t) === -1) continue; f = n[i].v.indexOf(".") > -1 && i === C ? n[i].v.indexOf(".") - 1 : n[i].v.length - 1; y = n[i].v.substr(f + 1); for (; f >= 0; --f) { if (k >= 0 && (n[i].v.charAt(f) === "0" || n[i].v.charAt(f) === "#")) y = S.charAt(k--) + y } n[i].v = y; n[i].t = "t"; _ = i } if (k >= 0 && _ < n.length) n[_].v = S.substr(0, k + 1) + n[_].v; k = S.indexOf(".") + 1; for (i = C; i < n.length; ++i) { if (n[i] == null || "n?(".indexOf(n[i].t) === -1 && i !== C) continue; f = n[i].v.indexOf(".") > -1 && i === C ? n[i].v.indexOf(".") + 1 : 0; y = n[i].v.substr(0, f); for (; f < n[i].v.length; ++f) { if (k < S.length) y += S.charAt(k++) } n[i].v = y; n[i].t = "t"; _ = i } } } for (i = 0; i < n.length; ++i)if (n[i] != null && "n?".indexOf(n[i].t) > -1) { x = a > 1 && r < 0 && i > 0 && n[i - 1].v === "-" ? -r : r; n[i].v = Me(n[i].t, n[i].v, x); n[i].t = "t" } var A = ""; for (i = 0; i !== n.length; ++i)if (n[i] != null) A += n[i].v; return A } var Le = /\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/; function Be(e, r) { if (r == null) return false; var t = parseFloat(r[2]); switch (r[1]) { case "=": if (e == t) return true; break; case ">": if (e > t) return true; break; case "<": if (e < t) return true; break; case "<>": if (e != t) return true; break; case ">=": if (e >= t) return true; break; case "<=": if (e <= t) return true; break; }return false } function ze(e, r) { var t = Ne(e); var a = t.length, n = t[a - 1].indexOf("@"); if (a < 4 && n > -1) --a; if (t.length > 4) throw new Error("cannot find right format for |" + t.join("|") + "|"); if (typeof r !== "number") return [4, t.length === 4 || n > -1 ? t[t.length - 1] : "@"]; switch (t.length) { case 1: t = n > -1 ? ["General", "General", "General", t[0]] : [t[0], t[0], t[0], "@"]; break; case 2: t = n > -1 ? [t[0], t[0], t[0], t[1]] : [t[0], t[1], t[0], "@"]; break; case 3: t = n > -1 ? [t[0], t[1], t[0], t[2]] : [t[0], t[1], t[2], "@"]; break; case 4: break; }var s = r > 0 ? t[0] : r < 0 ? t[1] : t[2]; if (t[0].indexOf("[") === -1 && t[1].indexOf("[") === -1) return [a, s]; if (t[0].match(/\[[=<>]/) != null || t[1].match(/\[[=<>]/) != null) { var i = t[0].match(Le); var l = t[1].match(Le); return Be(r, i) ? [a, t[0]] : Be(r, l) ? [a, t[1]] : [a, t[i != null && l != null ? 2 : 1]] } return [a, s] } function $e(e, r, t) { if (t == null) t = {}; var a = ""; switch (typeof e) { case "string": if (e == "m/d/yy" && t.dateNF) a = t.dateNF; else a = e; break; case "number": if (e == 14 && t.dateNF) a = t.dateNF; else a = (t.table != null ? t.table : Y)[e]; if (a == null) a = t.table && t.table[J[e]] || Y[J[e]]; if (a == null) a = K[e] || "General"; break; }if (H(a, 0)) return oe(r, t); if (r instanceof Date) r = te(r, t.date1904); var n = ze(a, r); if (H(n[1])) return oe(r, t); if (r === true) r = "TRUE"; else if (r === false) r = "FALSE"; else if (r === "" || r == null) return ""; return Re(n[1], r, t, n[0]) } function We(e, r) { if (typeof r != "number") { r = +r || -1; for (var t = 0; t < 392; ++t) { if (Y[t] == undefined) { if (r < 0) r = t; continue } if (Y[t] == e) { r = t; break } } if (r < 0) r = 391 } Y[r] = e; return r } function Ue(e) { for (var r = 0; r != 392; ++r)if (e[r] !== undefined) We(e[r], r) } function je() { Y = G() } var He = { format: $e, load: We, _table: Y, load_table: Ue, parse_date_code: q, is_date: Ie, get_table: function Ac() { return He._table = Y } }; var Ve = { 5: '"$"#,##0_);\\("$"#,##0\\)', 6: '"$"#,##0_);[Red]\\("$"#,##0\\)', 7: '"$"#,##0.00_);\\("$"#,##0.00\\)', 8: '"$"#,##0.00_);[Red]\\("$"#,##0.00\\)', 23: "General", 24: "General", 25: "General", 26: "General", 27: "m/d/yy", 28: "m/d/yy", 29: "m/d/yy", 30: "m/d/yy", 31: "m/d/yy", 32: "h:mm:ss", 33: "h:mm:ss", 34: "h:mm:ss", 35: "h:mm:ss", 36: "m/d/yy", 41: '_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)', 42: '_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)', 43: '_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)', 44: '_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)', 50: "m/d/yy", 51: "m/d/yy", 52: "m/d/yy", 53: "m/d/yy", 54: "m/d/yy", 55: "m/d/yy", 56: "m/d/yy", 57: "m/d/yy", 58: "m/d/yy", 59: "0", 60: "0.00", 61: "#,##0", 62: "#,##0.00", 63: '"$"#,##0_);\\("$"#,##0\\)', 64: '"$"#,##0_);[Red]\\("$"#,##0\\)', 65: '"$"#,##0.00_);\\("$"#,##0.00\\)', 66: '"$"#,##0.00_);[Red]\\("$"#,##0.00\\)', 67: "0%", 68: "0.00%", 69: "# ?/?", 70: "# ??/??", 71: "m/d/yy", 72: "m/d/yy", 73: "d-mmm-yy", 74: "d-mmm", 75: "mmm-yy", 76: "h:mm", 77: "h:mm:ss", 78: "m/d/yy h:mm", 79: "mm:ss", 80: "[h]:mm:ss", 81: "mmss.0" }; var Xe = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g; function Ge(e) { var r = typeof e == "number" ? Y[e] : e; r = r.replace(Xe, "(\\d+)"); return new RegExp("^" + r + "$") } function Ye(e, r, t) { var a = -1, n = -1, s = -1, i = -1, l = -1, o = -1; (r.match(Xe) || []).forEach(function (e, r) { var c = parseInt(t[r + 1], 10); switch (e.toLowerCase().charAt(0)) { case "y": a = c; break; case "d": s = c; break; case "h": i = c; break; case "s": o = c; break; case "m": if (i >= 0) l = c; else n = c; break; } }); if (o >= 0 && l == -1 && n >= 0) { l = n; n = -1 } var c = ("" + (a >= 0 ? a : (new Date).getFullYear())).slice(-4) + "-" + ("00" + (n >= 1 ? n : 1)).slice(-2) + "-" + ("00" + (s >= 1 ? s : 1)).slice(-2); if (c.length == 7) c = "0" + c; if (c.length == 8) c = "20" + c; var f = ("00" + (i >= 0 ? i : 0)).slice(-2) + ":" + ("00" + (l >= 0 ? l : 0)).slice(-2) + ":" + ("00" + (o >= 0 ? o : 0)).slice(-2); if (i == -1 && l == -1 && o == -1) return c; if (a == -1 && n == -1 && s == -1) return f; return c + "T" + f } var Je = { "d.m": "d\\.m" }; function Ke(e, r) { return We(Je[e] || e, r) } var Ze = function () {
        var e = {}; e.version = "1.2.0"; function r() { var e = 0, r = new Array(256); for (var t = 0; t != 256; ++t) { e = t; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; e = e & 1 ? -306674912 ^ e >>> 1 : e >>> 1; r[t] = e } return typeof Int32Array !== "undefined" ? new Int32Array(r) : r } var t = r(); function a(e) { var r = 0, t = 0, a = 0, n = typeof Int32Array !== "undefined" ? new Int32Array(4096) : new Array(4096); for (a = 0; a != 256; ++a)n[a] = e[a]; for (a = 0; a != 256; ++a) { t = e[a]; for (r = 256 + a; r < 4096; r += 256)t = n[r] = t >>> 8 ^ e[t & 255] } var s = []; for (a = 1; a != 16; ++a)s[a - 1] = typeof Int32Array !== "undefined" ? n.subarray(a * 256, a * 256 + 256) : n.slice(a * 256, a * 256 + 256); return s } var n = a(t); var s = n[0], i = n[1], l = n[2], o = n[3], c = n[4]; var f = n[5], u = n[6], h = n[7], d = n[8], m = n[9]; var p = n[10], v = n[11], g = n[12], b = n[13], w = n[14]; function k(e, r) {
            var a = r ^ -1; for (var n = 0, s = e.length; n < s;)a = a >>> 8 ^ t[(a ^ e.charCodeAt(n++)) & 255];
            return ~a
        } function y(e, r) { var a = r ^ -1, n = e.length - 15, k = 0; for (; k < n;)a = w[e[k++] ^ a & 255] ^ b[e[k++] ^ a >> 8 & 255] ^ g[e[k++] ^ a >> 16 & 255] ^ v[e[k++] ^ a >>> 24] ^ p[e[k++]] ^ m[e[k++]] ^ d[e[k++]] ^ h[e[k++]] ^ u[e[k++]] ^ f[e[k++]] ^ c[e[k++]] ^ o[e[k++]] ^ l[e[k++]] ^ i[e[k++]] ^ s[e[k++]] ^ t[e[k++]]; n += 15; while (k < n) a = a >>> 8 ^ t[(a ^ e[k++]) & 255]; return ~a } function x(e, r) { var a = r ^ -1; for (var n = 0, s = e.length, i = 0, l = 0; n < s;) { i = e.charCodeAt(n++); if (i < 128) { a = a >>> 8 ^ t[(a ^ i) & 255] } else if (i < 2048) { a = a >>> 8 ^ t[(a ^ (192 | i >> 6 & 31)) & 255]; a = a >>> 8 ^ t[(a ^ (128 | i & 63)) & 255] } else if (i >= 55296 && i < 57344) { i = (i & 1023) + 64; l = e.charCodeAt(n++) & 1023; a = a >>> 8 ^ t[(a ^ (240 | i >> 8 & 7)) & 255]; a = a >>> 8 ^ t[(a ^ (128 | i >> 2 & 63)) & 255]; a = a >>> 8 ^ t[(a ^ (128 | l >> 6 & 15 | (i & 3) << 4)) & 255]; a = a >>> 8 ^ t[(a ^ (128 | l & 63)) & 255] } else { a = a >>> 8 ^ t[(a ^ (224 | i >> 12 & 15)) & 255]; a = a >>> 8 ^ t[(a ^ (128 | i >> 6 & 63)) & 255]; a = a >>> 8 ^ t[(a ^ (128 | i & 63)) & 255] } } return ~a } e.table = t; e.bstr = k; e.buf = y; e.str = x; return e
    }(); var qe = function Fc() { var e = {}; e.version = "1.2.2"; function r(e, r) { var t = e.split("/"), a = r.split("/"); for (var n = 0, s = 0, i = Math.min(t.length, a.length); n < i; ++n) { if (s = t[n].length - a[n].length) return s; if (t[n] != a[n]) return t[n] < a[n] ? -1 : 1 } return t.length - a.length } function t(e) { if (e.charAt(e.length - 1) == "/") return e.slice(0, -1).indexOf("/") === -1 ? e : t(e.slice(0, -1)); var r = e.lastIndexOf("/"); return r === -1 ? e : e.slice(0, r + 1) } function a(e) { if (e.charAt(e.length - 1) == "/") return a(e.slice(0, -1)); var r = e.lastIndexOf("/"); return r === -1 ? e : e.slice(r + 1) } function n(e, r) { if (typeof r === "string") r = new Date(r); var t = r.getHours(); t = t << 6 | r.getMinutes(); t = t << 5 | r.getSeconds() >>> 1; e._W(2, t); var a = r.getFullYear() - 1980; a = a << 4 | r.getMonth() + 1; a = a << 5 | r.getDate(); e._W(2, a) } function s(e) { var r = e._R(2) & 65535; var t = e._R(2) & 65535; var a = new Date; var n = t & 31; t >>>= 5; var s = t & 15; t >>>= 4; a.setMilliseconds(0); a.setFullYear(t + 1980); a.setMonth(s - 1); a.setDate(n); var i = r & 31; r >>>= 5; var l = r & 63; r >>>= 6; a.setHours(r); a.setMinutes(l); a.setSeconds(i << 1); return a } function i(e) { pa(e, 0); var r = {}; var t = 0; while (e.l <= e.length - 4) { var a = e._R(2); var n = e._R(2), s = e.l + n; var i = {}; switch (a) { case 21589: { t = e._R(1); if (t & 1) i.mtime = e._R(4); if (n > 5) { if (t & 2) i.atime = e._R(4); if (t & 4) i.ctime = e._R(4) } if (i.mtime) i.mt = new Date(i.mtime * 1e3) } break; }e.l = s; r[a] = i } return r } var l; function o() { return l || (l = Qe) } function c(e, r) { if (e[0] == 80 && e[1] == 75) return Oe(e, r); if ((e[0] | 32) == 109 && (e[1] | 32) == 105) return $e(e, r); if (e.length < 512) throw new Error("CFB file size " + e.length + " < 512"); var t = 3; var a = 512; var n = 0; var s = 0; var i = 0; var l = 0; var o = 0; var c = []; var m = e.slice(0, 512); pa(m, 0); var v = f(m); t = v[0]; switch (t) { case 3: a = 512; break; case 4: a = 4096; break; case 0: if (v[1] == 0) return Oe(e, r); default: throw new Error("Major Version: Expected 3 or 4 saw " + t); }if (a !== 512) { m = e.slice(0, a); pa(m, 28) } var w = e.slice(0, a); u(m, t); var k = m._R(4, "i"); if (t === 3 && k !== 0) throw new Error("# Directory Sectors: Expected 0 saw " + k); m.l += 4; i = m._R(4, "i"); m.l += 4; m.chk("00100000", "Mini Stream Cutoff Size: "); l = m._R(4, "i"); n = m._R(4, "i"); o = m._R(4, "i"); s = m._R(4, "i"); for (var y = -1, x = 0; x < 109; ++x) { y = m._R(4, "i"); if (y < 0) break; c[x] = y } var S = h(e, a); p(o, s, S, a, c); var C = g(S, i, c, a); C[i].name = "!Directory"; if (n > 0 && l !== B) C[l].name = "!MiniFAT"; C[c[0]].name = "!FAT"; C.fat_addrs = c; C.ssz = a; var _ = {}, A = [], F = [], E = []; b(i, C, S, A, n, _, F, l); d(F, E, A); A.shift(); var T = { FileIndex: F, FullPaths: E }; if (r && r.raw) T.raw = { header: w, sectors: S }; return T } function f(e) { if (e[e.l] == 80 && e[e.l + 1] == 75) return [0, 0]; e.chk(z, "Header Signature: "); e.l += 16; var r = e._R(2, "u"); return [e._R(2, "u"), r] } function u(e, r) { var t = 9; e.l += 2; switch (t = e._R(2)) { case 9: if (r != 3) throw new Error("Sector Shift: Expected 9 saw " + t); break; case 12: if (r != 4) throw new Error("Sector Shift: Expected 12 saw " + t); break; default: throw new Error("Sector Shift: Expected 9 or 12 saw " + t); }e.chk("0600", "Mini Sector Shift: "); e.chk("000000000000", "Reserved: ") } function h(e, r) { var t = Math.ceil(e.length / r) - 1; var a = []; for (var n = 1; n < t; ++n)a[n - 1] = e.slice(n * r, (n + 1) * r); a[t - 1] = e.slice(t * r); return a } function d(e, r, t) { var a = 0, n = 0, s = 0, i = 0, l = 0, o = t.length; var c = [], f = []; for (; a < o; ++a) { c[a] = f[a] = a; r[a] = t[a] } for (; l < f.length; ++l) { a = f[l]; n = e[a].L; s = e[a].R; i = e[a].C; if (c[a] === a) { if (n !== -1 && c[n] !== n) c[a] = c[n]; if (s !== -1 && c[s] !== s) c[a] = c[s] } if (i !== -1) c[i] = a; if (n !== -1 && a != c[a]) { c[n] = c[a]; if (f.lastIndexOf(n) < l) f.push(n) } if (s !== -1 && a != c[a]) { c[s] = c[a]; if (f.lastIndexOf(s) < l) f.push(s) } } for (a = 1; a < o; ++a)if (c[a] === a) { if (s !== -1 && c[s] !== s) c[a] = c[s]; else if (n !== -1 && c[n] !== n) c[a] = c[n] } for (a = 1; a < o; ++a) { if (e[a].type === 0) continue; l = a; if (l != c[l]) do { l = c[l]; r[a] = r[l] + "/" + r[a] } while (l !== 0 && -1 !== c[l] && l != c[l]); c[a] = -1 } r[0] += "/"; for (a = 1; a < o; ++a) { if (e[a].type !== 2) r[a] += "/" } } function m(e, r, t) { var a = e.start, n = e.size; var s = []; var i = a; while (t && n > 0 && i >= 0) { s.push(r.slice(i * L, i * L + L)); n -= L; i = la(t, i * 4) } if (s.length === 0) return ga(0); return O(s).slice(0, e.size) } function p(e, r, t, a, n) { var s = B; if (e === B) { if (r !== 0) throw new Error("DIFAT chain shorter than expected") } else if (e !== -1) { var i = t[e], l = (a >>> 2) - 1; if (!i) return; for (var o = 0; o < l; ++o) { if ((s = la(i, o * 4)) === B) break; n.push(s) } if (r >= 1) p(la(i, a - 4), r - 1, t, a, n) } } function v(e, r, t, a, n) { var s = [], i = []; if (!n) n = []; var l = a - 1, o = 0, c = 0; for (o = r; o >= 0;) { n[o] = true; s[s.length] = o; i.push(e[o]); var f = t[Math.floor(o * 4 / a)]; c = o * 4 & l; if (a < 4 + c) throw new Error("FAT boundary crossed: " + o + " 4 " + a); if (!e[f]) break; o = la(e[f], c) } return { nodes: s, data: Rt([i]) } } function g(e, r, t, a) { var n = e.length, s = []; var i = [], l = [], o = []; var c = a - 1, f = 0, u = 0, h = 0, d = 0; for (f = 0; f < n; ++f) { l = []; h = f + r; if (h >= n) h -= n; if (i[h]) continue; o = []; var m = []; for (u = h; u >= 0;) { m[u] = true; i[u] = true; l[l.length] = u; o.push(e[u]); var p = t[Math.floor(u * 4 / a)]; d = u * 4 & c; if (a < 4 + d) throw new Error("FAT boundary crossed: " + u + " 4 " + a); if (!e[p]) break; u = la(e[p], d); if (m[u]) break } s[h] = { nodes: l, data: Rt([o]) } } return s } function b(e, r, t, a, n, s, i, l) { var o = 0, c = a.length ? 2 : 0; var f = r[e].data; var u = 0, h = 0, d; for (; u < f.length; u += 128) { var p = f.slice(u, u + 128); pa(p, 64); h = p._R(2); d = Bt(p, 0, h - c); a.push(d); var g = { name: d, type: p._R(1), color: p._R(1), L: p._R(4, "i"), R: p._R(4, "i"), C: p._R(4, "i"), clsid: p._R(16), state: p._R(4, "i"), start: 0, size: 0 }; var b = p._R(2) + p._R(2) + p._R(2) + p._R(2); if (b !== 0) g.ct = w(p, p.l - 8); var k = p._R(2) + p._R(2) + p._R(2) + p._R(2); if (k !== 0) g.mt = w(p, p.l - 8); g.start = p._R(4, "i"); g.size = p._R(4, "i"); if (g.size < 0 && g.start < 0) { g.size = g.type = 0; g.start = B; g.name = "" } if (g.type === 5) { o = g.start; if (n > 0 && o !== B) r[o].name = "!StreamData" } else if (g.size >= 4096) { g.storage = "fat"; if (r[g.start] === undefined) r[g.start] = v(t, g.start, r.fat_addrs, r.ssz); r[g.start].name = g.name; g.content = r[g.start].data.slice(0, g.size) } else { g.storage = "minifat"; if (g.size < 0) g.size = 0; else if (o !== B && g.start !== B && r[o]) { g.content = m(g, r[o].data, (r[l] || {}).data) } } if (g.content) pa(g.content, 0); s[d] = g; i.push(g) } } function w(e, r) { return new Date((ia(e, r + 4) / 1e7 * Math.pow(2, 32) + ia(e, r) / 1e7 - 11644473600) * 1e3) } function F(e, r) { o(); return c(l.readFileSync(e), r) } function E(e, r) { var t = r && r.type; if (!t) { if (x && Buffer.isBuffer(e)) t = "buffer" } switch (t || "base64") { case "file": return F(e, r); case "base64": return c(A(y(e)), r); case "binary": return c(A(e), r); }return c(e, r) } function T(e, r) { var t = r || {}, a = t.root || "Root Entry"; if (!e.FullPaths) e.FullPaths = []; if (!e.FileIndex) e.FileIndex = []; if (e.FullPaths.length !== e.FileIndex.length) throw new Error("inconsistent CFB structure"); if (e.FullPaths.length === 0) { e.FullPaths[0] = a + "/"; e.FileIndex[0] = { name: a, type: 5 } } if (t.CLSID) e.FileIndex[0].clsid = t.CLSID; D(e) } function D(e) { var r = "Sh33tJ5"; if (qe.find(e, "/" + r)) return; var t = ga(4); t[0] = 55; t[1] = t[3] = 50; t[2] = 54; e.FileIndex.push({ name: r, type: 2, content: t, size: 4, L: 69, R: 69, C: 69 }); e.FullPaths.push(e.FullPaths[0] + r); M(e) } function M(e, n) { T(e); var s = false, i = false; for (var l = e.FullPaths.length - 1; l >= 0; --l) { var o = e.FileIndex[l]; switch (o.type) { case 0: if (i) s = true; else { e.FileIndex.pop(); e.FullPaths.pop() } break; case 1: ; case 2: ; case 5: i = true; if (isNaN(o.R * o.L * o.C)) s = true; if (o.R > -1 && o.L > -1 && o.R == o.L) s = true; break; default: s = true; break; } } if (!s && !n) return; var c = new Date(1987, 1, 19), f = 0; var u = Object.create ? Object.create(null) : {}; var h = []; for (l = 0; l < e.FullPaths.length; ++l) { u[e.FullPaths[l]] = true; if (e.FileIndex[l].type === 0) continue; h.push([e.FullPaths[l], e.FileIndex[l]]) } for (l = 0; l < h.length; ++l) { var d = t(h[l][0]); i = u[d]; while (!i) { while (t(d) && !u[t(d)]) d = t(d); h.push([d, { name: a(d).replace("/", ""), type: 1, clsid: W, ct: c, mt: c, content: null }]); u[d] = true; d = t(h[l][0]); i = u[d] } } h.sort(function (e, t) { return r(e[0], t[0]) }); e.FullPaths = []; e.FileIndex = []; for (l = 0; l < h.length; ++l) { e.FullPaths[l] = h[l][0]; e.FileIndex[l] = h[l][1] } for (l = 0; l < h.length; ++l) { var m = e.FileIndex[l]; var p = e.FullPaths[l]; m.name = a(p).replace("/", ""); m.L = m.R = m.C = -(m.color = 1); m.size = m.content ? m.content.length : 0; m.start = 0; m.clsid = m.clsid || W; if (l === 0) { m.C = h.length > 1 ? 1 : -1; m.size = 0; m.type = 5 } else if (p.slice(-1) == "/") { for (f = l + 1; f < h.length; ++f)if (t(e.FullPaths[f]) == p) break; m.C = f >= h.length ? -1 : f; for (f = l + 1; f < h.length; ++f)if (t(e.FullPaths[f]) == t(p)) break; m.R = f >= h.length ? -1 : f; m.type = 1 } else { if (t(e.FullPaths[l + 1] || "") == t(p)) m.R = l + 1; m.type = 2 } } } function I(e, r) { var t = r || {}; if (t.fileType == "mad") return We(e, t); M(e); switch (t.fileType) { case "zip": return Ne(e, t); }var a = function (e) { var r = 0, t = 0; for (var a = 0; a < e.FileIndex.length; ++a) { var n = e.FileIndex[a]; if (!n.content) continue; var s = n.content.length; if (s > 0) { if (s < 4096) r += s + 63 >> 6; else t += s + 511 >> 9 } } var i = e.FullPaths.length + 3 >> 2; var l = r + 7 >> 3; var o = r + 127 >> 7; var c = l + t + i + o; var f = c + 127 >> 7; var u = f <= 109 ? 0 : Math.ceil((f - 109) / 127); while (c + f + u + 127 >> 7 > f) u = ++f <= 109 ? 0 : Math.ceil((f - 109) / 127); var h = [1, u, f, o, i, t, r, 0]; e.FileIndex[0].size = r << 6; h[7] = (e.FileIndex[0].start = h[0] + h[1] + h[2] + h[3] + h[4] + h[5]) + (h[6] + 7 >> 3); return h }(e); var n = ga(a[7] << 9); var s = 0, i = 0; { for (s = 0; s < 8; ++s)n._W(1, $[s]); for (s = 0; s < 8; ++s)n._W(2, 0); n._W(2, 62); n._W(2, 3); n._W(2, 65534); n._W(2, 9); n._W(2, 6); for (s = 0; s < 3; ++s)n._W(2, 0); n._W(4, 0); n._W(4, a[2]); n._W(4, a[0] + a[1] + a[2] + a[3] - 1); n._W(4, 0); n._W(4, 1 << 12); n._W(4, a[3] ? a[0] + a[1] + a[2] - 1 : B); n._W(4, a[3]); n._W(-4, a[1] ? a[0] - 1 : B); n._W(4, a[1]); for (s = 0; s < 109; ++s)n._W(-4, s < a[2] ? a[1] + s : -1) } if (a[1]) { for (i = 0; i < a[1]; ++i) { for (; s < 236 + i * 127; ++s)n._W(-4, s < a[2] ? a[1] + s : -1); n._W(-4, i === a[1] - 1 ? B : i + 1) } } var l = function (e) { for (i += e; s < i - 1; ++s)n._W(-4, s + 1); if (e) { ++s; n._W(-4, B) } }; i = s = 0; for (i += a[1]; s < i; ++s)n._W(-4, U.DIFSECT); for (i += a[2]; s < i; ++s)n._W(-4, U.FATSECT); l(a[3]); l(a[4]); var o = 0, c = 0; var f = e.FileIndex[0]; for (; o < e.FileIndex.length; ++o) { f = e.FileIndex[o]; if (!f.content) continue; c = f.content.length; if (c < 4096) continue; f.start = i; l(c + 511 >> 9) } l(a[6] + 7 >> 3); while (n.l & 511) n._W(-4, U.ENDOFCHAIN); i = s = 0; for (o = 0; o < e.FileIndex.length; ++o) { f = e.FileIndex[o]; if (!f.content) continue; c = f.content.length; if (!c || c >= 4096) continue; f.start = i; l(c + 63 >> 6) } while (n.l & 511) n._W(-4, U.ENDOFCHAIN); for (s = 0; s < a[4] << 2; ++s) { var u = e.FullPaths[s]; if (!u || u.length === 0) { for (o = 0; o < 17; ++o)n._W(4, 0); for (o = 0; o < 3; ++o)n._W(4, -1); for (o = 0; o < 12; ++o)n._W(4, 0); continue } f = e.FileIndex[s]; if (s === 0) f.start = f.size ? f.start - 1 : B; var h = s === 0 && t.root || f.name; if (h.length > 32) { console.error("Name " + h + " will be truncated to " + h.slice(0, 32)); h = h.slice(0, 32) } c = 2 * (h.length + 1); n._W(64, h, "utf16le"); n._W(2, c); n._W(1, f.type); n._W(1, f.color); n._W(-4, f.L); n._W(-4, f.R); n._W(-4, f.C); if (!f.clsid) for (o = 0; o < 4; ++o)n._W(4, 0); else n._W(16, f.clsid, "hex"); n._W(4, f.state || 0); n._W(4, 0); n._W(4, 0); n._W(4, 0); n._W(4, 0); n._W(4, f.start); n._W(4, f.size); n._W(4, 0) } for (s = 1; s < e.FileIndex.length; ++s) { f = e.FileIndex[s]; if (f.size >= 4096) { n.l = f.start + 1 << 9; if (x && Buffer.isBuffer(f.content)) { f.content.copy(n, n.l, 0, f.size); n.l += f.size + 511 & -512 } else { for (o = 0; o < f.size; ++o)n._W(1, f.content[o]); for (; o & 511; ++o)n._W(1, 0) } } } for (s = 1; s < e.FileIndex.length; ++s) { f = e.FileIndex[s]; if (f.size > 0 && f.size < 4096) { if (x && Buffer.isBuffer(f.content)) { f.content.copy(n, n.l, 0, f.size); n.l += f.size + 63 & -64 } else { for (o = 0; o < f.size; ++o)n._W(1, f.content[o]); for (; o & 63; ++o)n._W(1, 0) } } } if (x) { n.l = n.length } else { while (n.l < n.length) n._W(1, 0) } return n } function R(e, r) { var t = e.FullPaths.map(function (e) { return e.toUpperCase() }); var a = t.map(function (e) { var r = e.split("/"); return r[r.length - (e.slice(-1) == "/" ? 2 : 1)] }); var n = false; if (r.charCodeAt(0) === 47) { n = true; r = t[0].slice(0, -1) + r } else n = r.indexOf("/") !== -1; var s = r.toUpperCase(); var i = n === true ? t.indexOf(s) : a.indexOf(s); if (i !== -1) return e.FileIndex[i]; var l = !s.match(P); s = s.replace(N, ""); if (l) s = s.replace(P, "!"); for (i = 0; i < t.length; ++i) { if ((l ? t[i].replace(P, "!") : t[i]).replace(N, "") == s) return e.FileIndex[i]; if ((l ? a[i].replace(P, "!") : a[i]).replace(N, "") == s) return e.FileIndex[i] } return null } var L = 64; var B = -2; var z = "d0cf11e0a1b11ae1"; var $ = [208, 207, 17, 224, 161, 177, 26, 225]; var W = "00000000000000000000000000000000"; var U = { MAXREGSECT: -6, DIFSECT: -4, FATSECT: -3, ENDOFCHAIN: B, FREESECT: -1, HEADER_SIGNATURE: z, HEADER_MINOR_VERSION: "3e00", MAXREGSID: -6, NOSTREAM: -1, HEADER_CLSID: W, EntryTypes: ["unknown", "storage", "stream", "lockbytes", "property", "root"] }; function j(e, r, t) { o(); var a = I(e, t); l.writeFileSync(r, a) } function H(e) { var r = new Array(e.length); for (var t = 0; t < e.length; ++t)r[t] = String.fromCharCode(e[t]); return r.join("") } function V(e, r) { var t = I(e, r); switch (r && r.type || "buffer") { case "file": o(); l.writeFileSync(r.filename, t); return t; case "binary": return typeof t == "string" ? t : H(t); case "base64": return k(typeof t == "string" ? t : H(t)); case "buffer": if (x) return Buffer.isBuffer(t) ? t : S(t); case "array": return typeof t == "string" ? A(t) : t; }return t } var X; function G(e) { try { var r = e.InflateRaw; var t = new r; t._processChunk(new Uint8Array([3, 0]), t._finishFlushFlag); if (t.bytesRead) X = e; else throw new Error("zlib does not expose bytesRead") } catch (a) { console.error("cannot use native zlib: " + (a.message || a)) } } function Y(e, r) { if (!X) return Te(e, r); var t = X.InflateRaw; var a = new t; var n = a._processChunk(e.slice(e.l), a._finishFlushFlag); e.l += a.bytesRead; return n } function J(e) { return X ? X.deflateRawSync(e) : ye(e) } var K = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]; var Z = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258]; var q = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577]; function Q(e) { var r = (e << 1 | e << 11) & 139536 | (e << 5 | e << 15) & 558144; return (r >> 16 | r >> 8 | r) & 255 } var ee = typeof Uint8Array !== "undefined"; var re = ee ? new Uint8Array(1 << 8) : []; for (var te = 0; te < 1 << 8; ++te)re[te] = Q(te); function ae(e, r) { var t = re[e & 255]; if (r <= 8) return t >>> 8 - r; t = t << 8 | re[e >> 8 & 255]; if (r <= 16) return t >>> 16 - r; t = t << 8 | re[e >> 16 & 255]; return t >>> 24 - r } function ne(e, r) { var t = r & 7, a = r >>> 3; return (e[a] | (t <= 6 ? 0 : e[a + 1] << 8)) >>> t & 3 } function se(e, r) { var t = r & 7, a = r >>> 3; return (e[a] | (t <= 5 ? 0 : e[a + 1] << 8)) >>> t & 7 } function ie(e, r) { var t = r & 7, a = r >>> 3; return (e[a] | (t <= 4 ? 0 : e[a + 1] << 8)) >>> t & 15 } function le(e, r) { var t = r & 7, a = r >>> 3; return (e[a] | (t <= 3 ? 0 : e[a + 1] << 8)) >>> t & 31 } function oe(e, r) { var t = r & 7, a = r >>> 3; return (e[a] | (t <= 1 ? 0 : e[a + 1] << 8)) >>> t & 127 } function ce(e, r, t) { var a = r & 7, n = r >>> 3, s = (1 << t) - 1; var i = e[n] >>> a; if (t < 8 - a) return i & s; i |= e[n + 1] << 8 - a; if (t < 16 - a) return i & s; i |= e[n + 2] << 16 - a; if (t < 24 - a) return i & s; i |= e[n + 3] << 24 - a; return i & s } function fe(e, r, t) { var a = r & 7, n = r >>> 3; if (a <= 5) e[n] |= (t & 7) << a; else { e[n] |= t << a & 255; e[n + 1] = (t & 7) >> 8 - a } return r + 3 } function ue(e, r, t) { var a = r & 7, n = r >>> 3; t = (t & 1) << a; e[n] |= t; return r + 1 } function he(e, r, t) { var a = r & 7, n = r >>> 3; t <<= a; e[n] |= t & 255; t >>>= 8; e[n + 1] = t; return r + 8 } function de(e, r, t) { var a = r & 7, n = r >>> 3; t <<= a; e[n] |= t & 255; t >>>= 8; e[n + 1] = t & 255; e[n + 2] = t >>> 8; return r + 16 } function me(e, r) { var t = e.length, a = 2 * t > r ? 2 * t : r + 5, n = 0; if (t >= r) return e; if (x) { var s = _(a); if (e.copy) e.copy(s); else for (; n < e.length; ++n)s[n] = e[n]; return s } else if (ee) { var i = new Uint8Array(a); if (i.set) i.set(e); else for (; n < t; ++n)i[n] = e[n]; return i } e.length = a; return e } function pe(e) { var r = new Array(e); for (var t = 0; t < e; ++t)r[t] = 0; return r } function ve(e, r, t) { var a = 1, n = 0, s = 0, i = 0, l = 0, o = e.length; var c = ee ? new Uint16Array(32) : pe(32); for (s = 0; s < 32; ++s)c[s] = 0; for (s = o; s < t; ++s)e[s] = 0; o = e.length; var f = ee ? new Uint16Array(o) : pe(o); for (s = 0; s < o; ++s) { c[n = e[s]]++; if (a < n) a = n; f[s] = 0 } c[0] = 0; for (s = 1; s <= a; ++s)c[s + 16] = l = l + c[s - 1] << 1; for (s = 0; s < o; ++s) { l = e[s]; if (l != 0) f[s] = c[l + 16]++ } var u = 0; for (s = 0; s < o; ++s) { u = e[s]; if (u != 0) { l = ae(f[s], a) >> a - u; for (i = (1 << a + 4 - u) - 1; i >= 0; --i)r[l | i << u] = u & 15 | s << 4 } } return a } var ge = ee ? new Uint16Array(512) : pe(512); var be = ee ? new Uint16Array(32) : pe(32); if (!ee) { for (var we = 0; we < 512; ++we)ge[we] = 0; for (we = 0; we < 32; ++we)be[we] = 0 } (function () { var e = []; var r = 0; for (; r < 32; r++)e.push(5); ve(e, be, 32); var t = []; r = 0; for (; r <= 143; r++)t.push(8); for (; r <= 255; r++)t.push(9); for (; r <= 279; r++)t.push(7); for (; r <= 287; r++)t.push(8); ve(t, ge, 288) })(); var ke = function Ge() { var e = ee ? new Uint8Array(32768) : []; var r = 0, t = 0; for (; r < q.length - 1; ++r) { for (; t < q[r + 1]; ++t)e[t] = r } for (; t < 32768; ++t)e[t] = 29; var a = ee ? new Uint8Array(259) : []; for (r = 0, t = 0; r < Z.length - 1; ++r) { for (; t < Z[r + 1]; ++t)a[t] = r } function n(e, r) { var t = 0; while (t < e.length) { var a = Math.min(65535, e.length - t); var n = t + a == e.length; r._W(1, +n); r._W(2, a); r._W(2, ~a & 65535); while (a-- > 0) r[r.l++] = e[t++] } return r.l } function s(r, t) { var n = 0; var s = 0; var i = ee ? new Uint16Array(32768) : []; while (s < r.length) { var l = Math.min(65535, r.length - s); if (l < 10) { n = fe(t, n, +!!(s + l == r.length)); if (n & 7) n += 8 - (n & 7); t.l = n / 8 | 0; t._W(2, l); t._W(2, ~l & 65535); while (l-- > 0) t[t.l++] = r[s++]; n = t.l * 8; continue } n = fe(t, n, +!!(s + l == r.length) + 2); var o = 0; while (l-- > 0) { var c = r[s]; o = (o << 5 ^ c) & 32767; var f = -1, u = 0; if (f = i[o]) { f |= s & ~32767; if (f > s) f -= 32768; if (f < s) while (r[f + u] == r[s + u] && u < 250) ++u } if (u > 2) { c = a[u]; if (c <= 22) n = he(t, n, re[c + 1] >> 1) - 1; else { he(t, n, 3); n += 5; he(t, n, re[c - 23] >> 5); n += 3 } var h = c < 8 ? 0 : c - 4 >> 2; if (h > 0) { de(t, n, u - Z[c]); n += h } c = e[s - f]; n = he(t, n, re[c] >> 3); n -= 3; var d = c < 4 ? 0 : c - 2 >> 1; if (d > 0) { de(t, n, s - f - q[c]); n += d } for (var m = 0; m < u; ++m) { i[o] = s & 32767; o = (o << 5 ^ r[s]) & 32767; ++s } l -= u - 1 } else { if (c <= 143) c = c + 48; else n = ue(t, n, 1); n = he(t, n, re[c]); i[o] = s & 32767; ++s } } n = he(t, n, 0) - 1 } t.l = (n + 7) / 8 | 0; return t.l } return function i(e, r) { if (e.length < 8) return n(e, r); return s(e, r) } }(); function ye(e) { var r = ga(50 + Math.floor(e.length * 1.1)); var t = ke(e, r); return r.slice(0, t) } var xe = ee ? new Uint16Array(32768) : pe(32768); var Se = ee ? new Uint16Array(32768) : pe(32768); var Ce = ee ? new Uint16Array(128) : pe(128); var _e = 1, Ae = 1; function Fe(e, r) { var t = le(e, r) + 257; r += 5; var a = le(e, r) + 1; r += 5; var n = ie(e, r) + 4; r += 4; var s = 0; var i = ee ? new Uint8Array(19) : pe(19); var l = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]; var o = 1; var c = ee ? new Uint8Array(8) : pe(8); var f = ee ? new Uint8Array(8) : pe(8); var u = i.length; for (var h = 0; h < n; ++h) { i[K[h]] = s = se(e, r); if (o < s) o = s; c[s]++; r += 3 } var d = 0; c[0] = 0; for (h = 1; h <= o; ++h)f[h] = d = d + c[h - 1] << 1; for (h = 0; h < u; ++h)if ((d = i[h]) != 0) l[h] = f[d]++; var m = 0; for (h = 0; h < u; ++h) { m = i[h]; if (m != 0) { d = re[l[h]] >> 8 - m; for (var p = (1 << 7 - m) - 1; p >= 0; --p)Ce[d | p << m] = m & 7 | h << 3 } } var v = []; o = 1; for (; v.length < t + a;) { d = Ce[oe(e, r)]; r += d & 7; switch (d >>>= 3) { case 16: s = 3 + ne(e, r); r += 2; d = v[v.length - 1]; while (s-- > 0) v.push(d); break; case 17: s = 3 + se(e, r); r += 3; while (s-- > 0) v.push(0); break; case 18: s = 11 + oe(e, r); r += 7; while (s-- > 0) v.push(0); break; default: v.push(d); if (o < d) o = d; break; } } var g = v.slice(0, t), b = v.slice(t); for (h = t; h < 286; ++h)g[h] = 0; for (h = a; h < 30; ++h)b[h] = 0; _e = ve(g, xe, 286); Ae = ve(b, Se, 30); return r } function Ee(e, r) { if (e[0] == 3 && !(e[1] & 3)) { return [C(r), 2] } var t = 0; var a = 0; var n = _(r ? r : 1 << 18); var s = 0; var i = n.length >>> 0; var l = 0, o = 0; while ((a & 1) == 0) { a = se(e, t); t += 3; if (a >>> 1 == 0) { if (t & 7) t += 8 - (t & 7); var c = e[t >>> 3] | e[(t >>> 3) + 1] << 8; t += 32; if (c > 0) { if (!r && i < s + c) { n = me(n, s + c); i = n.length } while (c-- > 0) { n[s++] = e[t >>> 3]; t += 8 } } continue } else if (a >> 1 == 1) { l = 9; o = 5 } else { t = Fe(e, t); l = _e; o = Ae } for (; ;) { if (!r && i < s + 32767) { n = me(n, s + 32767); i = n.length } var f = ce(e, t, l); var u = a >>> 1 == 1 ? ge[f] : xe[f]; t += u & 15; u >>>= 4; if ((u >>> 8 & 255) === 0) n[s++] = u; else if (u == 256) break; else { u -= 257; var h = u < 8 ? 0 : u - 4 >> 2; if (h > 5) h = 0; var d = s + Z[u]; if (h > 0) { d += ce(e, t, h); t += h } f = ce(e, t, o); u = a >>> 1 == 1 ? be[f] : Se[f]; t += u & 15; u >>>= 4; var m = u < 4 ? 0 : u - 2 >> 1; var p = q[u]; if (m > 0) { p += ce(e, t, m); t += m } if (!r && i < d) { n = me(n, d + 100); i = n.length } while (s < d) { n[s] = n[s - p]; ++s } } } } if (r) return [n, t + 7 >>> 3]; return [n.slice(0, s), t + 7 >>> 3] } function Te(e, r) { var t = e.slice(e.l || 0); var a = Ee(t, r); e.l += a[1]; return a[0] } function De(e, r) { if (e) { if (typeof console !== "undefined") console.error(r) } else throw new Error(r) } function Oe(e, r) { var t = e; pa(t, 0); var a = [], n = []; var s = { FileIndex: a, FullPaths: n }; T(s, { root: r.root }); var l = t.length - 4; while ((t[l] != 80 || t[l + 1] != 75 || t[l + 2] != 5 || t[l + 3] != 6) && l >= 0) --l; t.l = l + 4; t.l += 4; var o = t._R(2); t.l += 6; var c = t._R(4); t.l = c; for (l = 0; l < o; ++l) { t.l += 20; var f = t._R(4); var u = t._R(4); var h = t._R(2); var d = t._R(2); var m = t._R(2); t.l += 8; var p = t._R(4); var v = i(t.slice(t.l + h, t.l + h + d)); t.l += h + d + m; var g = t.l; t.l = p + 4; Me(t, f, u, s, v); t.l = g } return s } function Me(e, r, t, a, n) { e.l += 2; var l = e._R(2); var o = e._R(2); var c = s(e); if (l & 8257) throw new Error("Unsupported ZIP encryption"); var f = e._R(4); var u = e._R(4); var h = e._R(4); var d = e._R(2); var m = e._R(2); var p = ""; for (var v = 0; v < d; ++v)p += String.fromCharCode(e[e.l++]); if (m) { var g = i(e.slice(e.l, e.l + m)); if ((g[21589] || {}).mt) c = g[21589].mt; if (((n || {})[21589] || {}).mt) c = n[21589].mt } e.l += m; var b = e.slice(e.l, e.l + u); switch (o) { case 8: b = Y(e, h); break; case 0: break; default: throw new Error("Unsupported ZIP Compression method " + o); }var w = false; if (l & 8) { f = e._R(4); if (f == 134695760) { f = e._R(4); w = true } u = e._R(4); h = e._R(4) } if (u != r) De(w, "Bad compressed size: " + r + " != " + u); if (h != t) De(w, "Bad uncompressed size: " + t + " != " + h); je(a, p, b, { unsafe: true, mt: c }) } function Ne(e, r) { var t = r || {}; var a = [], s = []; var i = ga(1); var l = t.compression ? 8 : 0, o = 0; var c = false; if (c) o |= 8; var f = 0, u = 0; var h = 0, d = 0; var m = e.FullPaths[0], p = m, v = e.FileIndex[0]; var g = []; var b = 0; for (f = 1; f < e.FullPaths.length; ++f) { p = e.FullPaths[f].slice(m.length); v = e.FileIndex[f]; if (!v.size || !v.content || p == "Sh33tJ5") continue; var w = h; var k = ga(p.length); for (u = 0; u < p.length; ++u)k._W(1, p.charCodeAt(u) & 127); k = k.slice(0, k.l); g[d] = Ze.buf(v.content, 0); var y = v.content; if (l == 8) y = J(y); i = ga(30); i._W(4, 67324752); i._W(2, 20); i._W(2, o); i._W(2, l); if (v.mt) n(i, v.mt); else i._W(4, 0); i._W(-4, o & 8 ? 0 : g[d]); i._W(4, o & 8 ? 0 : y.length); i._W(4, o & 8 ? 0 : v.content.length); i._W(2, k.length); i._W(2, 0); h += i.length; a.push(i); h += k.length; a.push(k); h += y.length; a.push(y); if (o & 8) { i = ga(12); i._W(-4, g[d]); i._W(4, y.length); i._W(4, v.content.length); h += i.l; a.push(i) } i = ga(46); i._W(4, 33639248); i._W(2, 0); i._W(2, 20); i._W(2, o); i._W(2, l); i._W(4, 0); i._W(-4, g[d]); i._W(4, y.length); i._W(4, v.content.length); i._W(2, k.length); i._W(2, 0); i._W(2, 0); i._W(2, 0); i._W(2, 0); i._W(4, 0); i._W(4, w); b += i.l; s.push(i); b += k.length; s.push(k); ++d } i = ga(22); i._W(4, 101010256); i._W(2, 0); i._W(2, 0); i._W(2, d); i._W(2, d); i._W(4, b); i._W(4, h); i._W(2, 0); return O([O(a), O(s), i]) } var Pe = { htm: "text/html", xml: "text/xml", gif: "image/gif", jpg: "image/jpeg", png: "image/png", mso: "application/x-mso", thmx: "application/vnd.ms-officetheme", sh33tj5: "application/octet-stream" }; function Ie(e, r) { if (e.ctype) return e.ctype; var t = e.name || "", a = t.match(/\.([^\.]+)$/); if (a && Pe[a[1]]) return Pe[a[1]]; if (r) { a = (t = r).match(/[\.\\]([^\.\\])+$/); if (a && Pe[a[1]]) return Pe[a[1]] } return "application/octet-stream" } function Re(e) { var r = k(e); var t = []; for (var a = 0; a < r.length; a += 76)t.push(r.slice(a, a + 76)); return t.join("\r\n") + "\r\n" } function Le(e) { var r = e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g, function (e) { var r = e.charCodeAt(0).toString(16).toUpperCase(); return "=" + (r.length == 1 ? "0" + r : r) }); r = r.replace(/ $/gm, "=20").replace(/\t$/gm, "=09"); if (r.charAt(0) == "\n") r = "=0D" + r.slice(1); r = r.replace(/\r(?!\n)/gm, "=0D").replace(/\n\n/gm, "\n=0A").replace(/([^\r\n])\n/gm, "$1=0A"); var t = [], a = r.split("\r\n"); for (var n = 0; n < a.length; ++n) { var s = a[n]; if (s.length == 0) { t.push(""); continue } for (var i = 0; i < s.length;) { var l = 76; var o = s.slice(i, i + l); if (o.charAt(l - 1) == "=") l--; else if (o.charAt(l - 2) == "=") l -= 2; else if (o.charAt(l - 3) == "=") l -= 3; o = s.slice(i, i + l); i += l; if (i < s.length) o += "="; t.push(o) } } return t.join("\r\n") } function Be(e) { var r = []; for (var t = 0; t < e.length; ++t) { var a = e[t]; while (t <= e.length && a.charAt(a.length - 1) == "=") a = a.slice(0, a.length - 1) + e[++t]; r.push(a) } for (var n = 0; n < r.length; ++n)r[n] = r[n].replace(/[=][0-9A-Fa-f]{2}/g, function (e) { return String.fromCharCode(parseInt(e.slice(1), 16)) }); return A(r.join("\r\n")) } function ze(e, r, t) { var a = "", n = "", s = "", i; var l = 0; for (; l < 10; ++l) { var o = r[l]; if (!o || o.match(/^\s*$/)) break; var c = o.match(/^(.*?):\s*([^\s].*)$/); if (c) switch (c[1].toLowerCase()) { case "content-location": a = c[2].trim(); break; case "content-type": s = c[2].trim(); break; case "content-transfer-encoding": n = c[2].trim(); break; } } ++l; switch (n.toLowerCase()) { case "base64": i = A(y(r.slice(l).join(""))); break; case "quoted-printable": i = Be(r.slice(l)); break; default: throw new Error("Unsupported Content-Transfer-Encoding " + n); }var f = je(e, a.slice(t.length), i, { unsafe: true }); if (s) f.ctype = s } function $e(e, r) { if (H(e.slice(0, 13)).toLowerCase() != "mime-version:") throw new Error("Unsupported MAD header"); var t = r && r.root || ""; var a = (x && Buffer.isBuffer(e) ? e.toString("binary") : H(e)).split("\r\n"); var n = 0, s = ""; for (n = 0; n < a.length; ++n) { s = a[n]; if (!/^Content-Location:/i.test(s)) continue; s = s.slice(s.indexOf("file")); if (!t) t = s.slice(0, s.lastIndexOf("/") + 1); if (s.slice(0, t.length) == t) continue; while (t.length > 0) { t = t.slice(0, t.length - 1); t = t.slice(0, t.lastIndexOf("/") + 1); if (s.slice(0, t.length) == t) break } } var i = (a[1] || "").match(/boundary="(.*?)"/); if (!i) throw new Error("MAD cannot find boundary"); var l = "--" + (i[1] || ""); var o = [], c = []; var f = { FileIndex: o, FullPaths: c }; T(f); var u, h = 0; for (n = 0; n < a.length; ++n) { var d = a[n]; if (d !== l && d !== l + "--") continue; if (h++) ze(f, a.slice(u, n), t); u = n } return f } function We(e, r) { var t = r || {}; var a = t.boundary || "SheetJS"; a = "------=" + a; var n = ["MIME-Version: 1.0", 'Content-Type: multipart/related; boundary="' + a.slice(2) + '"', "", "", ""]; var s = e.FullPaths[0], i = s, l = e.FileIndex[0]; for (var o = 1; o < e.FullPaths.length; ++o) { i = e.FullPaths[o].slice(s.length); l = e.FileIndex[o]; if (!l.size || !l.content || i == "Sh33tJ5") continue; i = i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g, function (e) { return "_x" + e.charCodeAt(0).toString(16) + "_" }).replace(/[\u0080-\uFFFF]/g, function (e) { return "_u" + e.charCodeAt(0).toString(16) + "_" }); var c = l.content; var f = x && Buffer.isBuffer(c) ? c.toString("binary") : H(c); var u = 0, h = Math.min(1024, f.length), d = 0; for (var m = 0; m <= h; ++m)if ((d = f.charCodeAt(m)) >= 32 && d < 128) ++u; var p = u >= h * 4 / 5; n.push(a); n.push("Content-Location: " + (t.root || "file:///C:/SheetJS/") + i); n.push("Content-Transfer-Encoding: " + (p ? "quoted-printable" : "base64")); n.push("Content-Type: " + Ie(l, i)); n.push(""); n.push(p ? Le(f) : Re(f)) } n.push(a + "--\r\n"); return n.join("\r\n") } function Ue(e) { var r = {}; T(r, e); return r } function je(e, r, t, n) { var s = n && n.unsafe; if (!s) T(e); var i = !s && qe.find(e, r); if (!i) { var l = e.FullPaths[0]; if (r.slice(0, l.length) == l) l = r; else { if (l.slice(-1) != "/") l += "/"; l = (l + r).replace("//", "/") } i = { name: a(r), type: 2 }; e.FileIndex.push(i); e.FullPaths.push(l); if (!s) qe.utils.cfb_gc(e) } i.content = t; i.size = t ? t.length : 0; if (n) { if (n.CLSID) i.clsid = n.CLSID; if (n.mt) i.mt = n.mt; if (n.ct) i.ct = n.ct } return i } function He(e, r) { T(e); var t = qe.find(e, r); if (t) for (var a = 0; a < e.FileIndex.length; ++a)if (e.FileIndex[a] == t) { e.FileIndex.splice(a, 1); e.FullPaths.splice(a, 1); return true } return false } function Ve(e, r, t) { T(e); var n = qe.find(e, r); if (n) for (var s = 0; s < e.FileIndex.length; ++s)if (e.FileIndex[s] == n) { e.FileIndex[s].name = a(t); e.FullPaths[s] = t; return true } return false } function Xe(e) { M(e, true) } e.find = R; e.read = E; e.parse = c; e.write = V; e.writeFile = j; e.utils = { cfb_new: Ue, cfb_add: je, cfb_del: He, cfb_mov: Ve, cfb_gc: Xe, ReadShift: ca, CheckField: ma, prep_blob: pa, bconcat: O, use_zlib: G, _deflateRaw: ye, _inflateRaw: Te, consts: U }; return e }(); var Qe; function er(e) { Qe = e } function rr(e) { if (typeof e === "string") return F(e); if (Array.isArray(e)) return T(e); return e } function tr(e, r, t) { if (typeof Qe !== "undefined" && Qe.writeFileSync) return t ? Qe.writeFileSync(e, r, t) : Qe.writeFileSync(e, r); if (typeof Deno !== "undefined") { if (t && typeof r == "string") switch (t) { case "utf8": r = new TextEncoder(t).encode(r); break; case "binary": r = F(r); break; default: throw new Error("Unsupported encoding " + t); }return Deno.writeFileSync(e, r) } var a = t == "utf8" ? pt(r) : r; if (typeof IE_SaveFile !== "undefined") return IE_SaveFile(a, e); if (typeof Blob !== "undefined") { var n = new Blob([rr(a)], { type: "application/octet-stream" }); if (typeof navigator !== "undefined" && navigator.msSaveBlob) return navigator.msSaveBlob(n, e); if (typeof saveAs !== "undefined") return saveAs(n, e); if (typeof URL !== "undefined" && typeof document !== "undefined" && document.createElement && URL.createObjectURL) { var s = URL.createObjectURL(n); if (typeof chrome === "object" && typeof (chrome.downloads || {}).download == "function") { if (URL.revokeObjectURL && typeof setTimeout !== "undefined") setTimeout(function () { URL.revokeObjectURL(s) }, 6e4); return chrome.downloads.download({ url: s, filename: e, saveAs: true }) } var i = document.createElement("a"); if (i.download != null) { i.download = e; i.href = s; document.body.appendChild(i); i.click(); document.body.removeChild(i); if (URL.revokeObjectURL && typeof setTimeout !== "undefined") setTimeout(function () { URL.revokeObjectURL(s) }, 6e4); return s } } } if (typeof $ !== "undefined" && typeof File !== "undefined" && typeof Folder !== "undefined") try { var l = File(e); l.open("w"); l.encoding = "binary"; if (Array.isArray(r)) r = E(r); l.write(r); l.close(); return r } catch (o) { if (!o.message || !o.message.match(/onstruct/)) throw o } throw new Error("cannot save file " + e) } function ar(e) { if (typeof Qe !== "undefined") return Qe.readFileSync(e); if (typeof Deno !== "undefined") return Deno.readFileSync(e); if (typeof $ !== "undefined" && typeof File !== "undefined" && typeof Folder !== "undefined") try { var r = File(e); r.open("r"); r.encoding = "binary"; var t = r.read(); r.close(); return t } catch (a) { if (!a.message || !a.message.match(/onstruct/)) throw a } throw new Error("Cannot access file " + e) } function nr(e) { var r = Object.keys(e), t = []; for (var a = 0; a < r.length; ++a)if (Object.prototype.hasOwnProperty.call(e, r[a])) t.push(r[a]); return t } function sr(e, r) { var t = [], a = nr(e); for (var n = 0; n !== a.length; ++n)if (t[e[a[n]][r]] == null) t[e[a[n]][r]] = a[n]; return t } function ir(e) { var r = [], t = nr(e); for (var a = 0; a !== t.length; ++a)r[e[t[a]]] = t[a]; return r } function lr(e) { var r = [], t = nr(e); for (var a = 0; a !== t.length; ++a)r[e[t[a]]] = parseInt(t[a], 10); return r } function or(e) { var r = [], t = nr(e); for (var a = 0; a !== t.length; ++a) { if (r[e[t[a]]] == null) r[e[t[a]]] = []; r[e[t[a]]].push(t[a]) } return r } var cr = new Date(1899, 11, 30, 0, 0, 0); function fr(e, r) { var t = e.getTime(); if (r) t -= 1462 * 24 * 60 * 60 * 1e3; var a = cr.getTime() + (e.getTimezoneOffset() - cr.getTimezoneOffset()) * 6e4; return (t - a) / (24 * 60 * 60 * 1e3) } var ur = new Date; var hr = cr.getTime() + (ur.getTimezoneOffset() - cr.getTimezoneOffset()) * 6e4; var dr = ur.getTimezoneOffset(); function mr(e) { var r = new Date; r.setTime(e * 24 * 60 * 60 * 1e3 + hr); if (r.getTimezoneOffset() !== dr) { r.setTime(r.getTime() + (r.getTimezoneOffset() - dr) * 6e4) } return r } function pr(e) { var r = 0, t = 0, a = false; var n = e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/); if (!n) throw new Error("|" + e + "| is not an ISO8601 Duration"); for (var s = 1; s != n.length; ++s) { if (!n[s]) continue; t = 1; if (s > 3) a = true; switch (n[s].slice(n[s].length - 1)) { case "Y": throw new Error("Unsupported ISO Duration Field: " + n[s].slice(n[s].length - 1)); case "D": t *= 24; case "H": t *= 60; case "M": if (!a) throw new Error("Unsupported ISO Duration Field: M"); else t *= 60; case "S": break; }r += t * parseInt(n[s], 10) } return r } var vr = new Date("2017-02-19T19:06:09.000Z"); var gr = isNaN(vr.getFullYear()) ? new Date("2/19/17") : vr; var br = gr.getFullYear() == 2017; function wr(e, r) {
        var t = new Date(e); if (br) { if (r > 0) t.setTime(t.getTime() + t.getTimezoneOffset() * 60 * 1e3); else if (r < 0) t.setTime(t.getTime() - t.getTimezoneOffset() * 60 * 1e3); return t } if (e instanceof Date) return e; if (gr.getFullYear() == 1917 && !isNaN(t.getFullYear())) {
            var a = t.getFullYear(); if (e.indexOf("" + a) > -1) return t; t.setFullYear(t.getFullYear() + 100); return t
        } var n = e.match(/\d+/g) || ["2017", "2", "19", "0", "0", "0"]; var s = new Date(+n[0], +n[1] - 1, +n[2], +n[3] || 0, +n[4] || 0, +n[5] || 0); if (e.indexOf("Z") > -1) s = new Date(s.getTime() - s.getTimezoneOffset() * 60 * 1e3); return s
    } function kr(e, r) { if (x && Buffer.isBuffer(e)) { if (r) { if (e[0] == 255 && e[1] == 254) return pt(e.slice(2).toString("utf16le")); if (e[1] == 254 && e[2] == 255) return pt(h(e.slice(2).toString("binary"))) } return e.toString("binary") } if (typeof TextDecoder !== "undefined") try { if (r) { if (e[0] == 255 && e[1] == 254) return pt(new TextDecoder("utf-16le").decode(e.slice(2))); if (e[0] == 254 && e[1] == 255) return pt(new TextDecoder("utf-16be").decode(e.slice(2))) } var t = { "€": "", "‚": "", "ƒ": "", "„": "", "…": "", "†": "", "‡": "", "ˆ": "", "‰": "", "Š": "", "‹": "", "Œ": "", "Ž": "", "‘": "", "’": "", "“": "", "”": "", "•": "", "–": "", "—": "", "˜": "", "™": "", "š": "", "›": "", "œ": "", "ž": "", "Ÿ": "" }; if (Array.isArray(e)) e = new Uint8Array(e); return new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g, function (e) { return t[e] || e }) } catch (a) { } var n = []; for (var s = 0; s != e.length; ++s)n.push(String.fromCharCode(e[s])); return n.join("") } function yr(e) { if (typeof JSON != "undefined" && !Array.isArray(e)) return JSON.parse(JSON.stringify(e)); if (typeof e != "object" || e == null) return e; if (e instanceof Date) return new Date(e.getTime()); var r = {}; for (var t in e) if (Object.prototype.hasOwnProperty.call(e, t)) r[t] = yr(e[t]); return r } function xr(e, r) { var t = ""; while (t.length < r) t += e; return t } function Sr(e) { var r = Number(e); if (!isNaN(r)) return isFinite(r) ? r : NaN; if (!/\d/.test(e)) return r; var t = 1; var a = e.replace(/([\d]),([\d])/g, "$1$2").replace(/[$]/g, "").replace(/[%]/g, function () { t *= 100; return "" }); if (!isNaN(r = Number(a))) return r / t; a = a.replace(/[(](.*)[)]/, function (e, r) { t = -t; return r }); if (!isNaN(r = Number(a))) return r / t; return r } var Cr = /^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))([ap])m?/; function _r(e) { if (!e[2]) return new Date(1900, 0, 0, +e[1] % 12 + (e[7] == "p" ? 12 : 0), 0, 0, 0); if (e[3]) { if (e[4]) return new Date(1900, 0, 0, +e[1] % 12 + (e[7] == "p" ? 12 : 0), +e[2], +e[4], parseFloat(e[3]) * 1e3); else return new Date(1900, 0, 0, e[7] == "p" ? 12 : 0, +e[1], +e[2], parseFloat(e[3]) * 1e3) } else if (e[5]) return new Date(1900, 0, 0, +e[1] % 12 + (e[7] == "p" ? 12 : 0), +e[2], +e[5], e[6] ? parseFloat(e[6]) * 1e3 : 0); else return new Date(1900, 0, 0, +e[1] % 12 + (e[7] == "p" ? 12 : 0), +e[2], 0, 0) } var Ar = ["january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december"]; function Fr(e) { var r = e.toLowerCase(); var t = r.replace(/\s+/g, ""); var a = t.match(Cr); if (a) return _r(a); var n = new Date(e), s = new Date(NaN); var i = n.getYear(), l = n.getMonth(), o = n.getDate(); if (isNaN(o)) return s; if (r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) { r = r.replace(/[^a-z]/g, "").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/, ""); if (r.length > 3 && Ar.indexOf(r) == -1) return s } else if (r.replace(/[ap]m?/, "").match(/[a-z]/)) return s; if (i < 0 || i > 8099) return s; if ((l > 0 || o > 1) && i != 101) return n; if (e.match(/[^-0-9:,\/\\]/)) return s; return n } var Er = function () { var e = "abacaba".split(/(:?b)/i).length == 5; return function r(t, a, n) { if (e || typeof a == "string") return t.split(a); var s = t.split(a), i = [s[0]]; for (var l = 1; l < s.length; ++l) { i.push(n); i.push(s[l]) } return i } }(); function Tr(e) { if (!e) return null; if (e.content && e.type) return kr(e.content, true); if (e.data) return d(e.data); if (e.asNodeBuffer && x) return d(e.asNodeBuffer().toString("binary")); if (e.asBinary) return d(e.asBinary()); if (e._data && e._data.getContent) return d(kr(Array.prototype.slice.call(e._data.getContent(), 0))); return null } function Dr(e) { if (!e) return null; if (e.data) return f(e.data); if (e.asNodeBuffer && x) return e.asNodeBuffer(); if (e._data && e._data.getContent) { var r = e._data.getContent(); if (typeof r == "string") return f(r); return Array.prototype.slice.call(r) } if (e.content && e.type) return e.content; return null } function Or(e) { return e && e.name.slice(-4) === ".bin" ? Dr(e) : Tr(e) } function Mr(e, r) { var t = e.FullPaths || nr(e.files); var a = r.toLowerCase().replace(/[\/]/g, "\\"), n = a.replace(/\\/g, "/"); for (var s = 0; s < t.length; ++s) { var i = t[s].replace(/^Root Entry[\/]/, "").toLowerCase(); if (a == i || n == i) return e.files ? e.files[t[s]] : e.FileIndex[s] } return null } function Nr(e, r) { var t = Mr(e, r); if (t == null) throw new Error("Cannot find file " + r + " in zip"); return t } function Pr(e, r, t) { if (!t) return Or(Nr(e, r)); if (!r) return null; try { return Pr(e, r) } catch (a) { return null } } function Ir(e, r, t) { if (!t) return Tr(Nr(e, r)); if (!r) return null; try { return Ir(e, r) } catch (a) { return null } } function Rr(e, r, t) { if (!t) return Dr(Nr(e, r)); if (!r) return null; try { return Rr(e, r) } catch (a) { return null } } function Lr(e) { var r = e.FullPaths || nr(e.files), t = []; for (var a = 0; a < r.length; ++a)if (r[a].slice(-1) != "/") t.push(r[a].replace(/^Root Entry[\/]/, "")); return t.sort() } function Br(e, r, t) { if (e.FullPaths) { if (typeof t == "string") { var a; if (x) a = S(t); else a = M(t); return qe.utils.cfb_add(e, r, a) } qe.utils.cfb_add(e, r, t) } else e.file(r, t) } function zr() { return qe.utils.cfb_new() } function $r(e, r) { switch (r.type) { case "base64": return qe.read(e, { type: "base64" }); case "binary": return qe.read(e, { type: "binary" }); case "buffer": ; case "array": return qe.read(e, { type: "buffer" }); }throw new Error("Unrecognized type " + r.type) } function Wr(e, r) { if (e.charAt(0) == "/") return e.slice(1); var t = r.split("/"); if (r.slice(-1) != "/") t.pop(); var a = e.split("/"); while (a.length !== 0) { var n = a.shift(); if (n === "..") t.pop(); else if (n !== ".") t.push(n) } return t.join("/") } var Ur = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n'; var jr = /([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g; var Hr = /<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm, Vr = /<[^>]*>/g; var Xr = Ur.match(Hr) ? Hr : Vr; var Gr = /<\w*:/, Yr = /<(\/?)\w+:/; function Jr(e, r, t) { var a = {}; var n = 0, s = 0; for (; n !== e.length; ++n)if ((s = e.charCodeAt(n)) === 32 || s === 10 || s === 13) break; if (!r) a[0] = e.slice(0, n); if (n === e.length) return a; var i = e.match(jr), l = 0, o = "", c = 0, f = "", u = "", h = 1; if (i) for (c = 0; c != i.length; ++c) { u = i[c]; for (s = 0; s != u.length; ++s)if (u.charCodeAt(s) === 61) break; f = u.slice(0, s).trim(); while (u.charCodeAt(s + 1) == 32) ++s; h = (n = u.charCodeAt(s + 1)) == 34 || n == 39 ? 1 : 0; o = u.slice(s + 1 + h, u.length - h); for (l = 0; l != f.length; ++l)if (f.charCodeAt(l) === 58) break; if (l === f.length) { if (f.indexOf("_") > 0) f = f.slice(0, f.indexOf("_")); a[f] = o; if (!t) a[f.toLowerCase()] = o } else { var d = (l === 5 && f.slice(0, 5) === "xmlns" ? "xmlns" : "") + f.slice(l + 1); if (a[d] && f.slice(l - 3, l) == "ext") continue; a[d] = o; if (!t) a[d.toLowerCase()] = o } } return a } function Kr(e) { return e.replace(Yr, "<$1") } var Zr = { "&quot;": '"', "&apos;": "'", "&gt;": ">", "&lt;": "<", "&amp;": "&" }; var qr = ir(Zr); var Qr = function () { var e = /&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi, r = /_x([\da-fA-F]{4})_/gi; function t(a) { var n = a + "", s = n.indexOf("<![CDATA["); if (s == -1) return n.replace(e, function (e, r) { return Zr[e] || String.fromCharCode(parseInt(r, e.indexOf("x") > -1 ? 16 : 10)) || e }).replace(r, function (e, r) { return String.fromCharCode(parseInt(r, 16)) }); var i = n.indexOf("]]>"); return t(n.slice(0, s)) + n.slice(s + 9, i) + t(n.slice(i + 3)) } return function a(e, r) { var a = t(e); return r ? a.replace(/\r\n/g, "\n") : a } }(); var et = /[&<>'"]/g, rt = /[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g; function tt(e) { var r = e + ""; return r.replace(et, function (e) { return qr[e] }).replace(rt, function (e) { return "_x" + ("000" + e.charCodeAt(0).toString(16)).slice(-4) + "_" }) } function at(e) { return tt(e).replace(/ /g, "_x0020_") } var nt = /[\u0000-\u001f]/g; function st(e) { var r = e + ""; return r.replace(et, function (e) { return qr[e] }).replace(/\n/g, "<br/>").replace(nt, function (e) { return "&#x" + ("000" + e.charCodeAt(0).toString(16)).slice(-4) + ";" }) } function it(e) { var r = e + ""; return r.replace(et, function (e) { return qr[e] }).replace(nt, function (e) { return "&#x" + e.charCodeAt(0).toString(16).toUpperCase() + ";" }) } var lt = function () { var e = /&#(\d+);/g; function r(e, r) { return String.fromCharCode(parseInt(r, 10)) } return function t(a) { return a.replace(e, r) } }(); function ot(e) { return e.replace(/(\r\n|[\r\n])/g, "&#10;") } function ct(e) { switch (e) { case 1: ; case true: ; case "1": ; case "true": return true; case 0: ; case false: ; case "0": ; case "false": return false; }return false } function ft(e) { var r = "", t = 0, a = 0, n = 0, s = 0, i = 0, l = 0; while (t < e.length) { a = e.charCodeAt(t++); if (a < 128) { r += String.fromCharCode(a); continue } n = e.charCodeAt(t++); if (a > 191 && a < 224) { i = (a & 31) << 6; i |= n & 63; r += String.fromCharCode(i); continue } s = e.charCodeAt(t++); if (a < 240) { r += String.fromCharCode((a & 15) << 12 | (n & 63) << 6 | s & 63); continue } i = e.charCodeAt(t++); l = ((a & 7) << 18 | (n & 63) << 12 | (s & 63) << 6 | i & 63) - 65536; r += String.fromCharCode(55296 + (l >>> 10 & 1023)); r += String.fromCharCode(56320 + (l & 1023)) } return r } function ut(e) { var r = C(2 * e.length), t, a, n = 1, s = 0, i = 0, l; for (a = 0; a < e.length; a += n) { n = 1; if ((l = e.charCodeAt(a)) < 128) t = l; else if (l < 224) { t = (l & 31) * 64 + (e.charCodeAt(a + 1) & 63); n = 2 } else if (l < 240) { t = (l & 15) * 4096 + (e.charCodeAt(a + 1) & 63) * 64 + (e.charCodeAt(a + 2) & 63); n = 3 } else { n = 4; t = (l & 7) * 262144 + (e.charCodeAt(a + 1) & 63) * 4096 + (e.charCodeAt(a + 2) & 63) * 64 + (e.charCodeAt(a + 3) & 63); t -= 65536; i = 55296 + (t >>> 10 & 1023); t = 56320 + (t & 1023) } if (i !== 0) { r[s++] = i & 255; r[s++] = i >>> 8; i = 0 } r[s++] = t % 256; r[s++] = t >>> 8 } return r.slice(0, s).toString("ucs2") } function ht(e) { return S(e, "binary").toString("utf8") } var dt = "foo bar bazâð£"; var mt = x && (ht(dt) == ft(dt) && ht || ut(dt) == ft(dt) && ut) || ft; var pt = x ? function (e) { return S(e, "utf8").toString("binary") } : function (e) { var r = [], t = 0, a = 0, n = 0; while (t < e.length) { a = e.charCodeAt(t++); switch (true) { case a < 128: r.push(String.fromCharCode(a)); break; case a < 2048: r.push(String.fromCharCode(192 + (a >> 6))); r.push(String.fromCharCode(128 + (a & 63))); break; case a >= 55296 && a < 57344: a -= 55296; n = e.charCodeAt(t++) - 56320 + (a << 10); r.push(String.fromCharCode(240 + (n >> 18 & 7))); r.push(String.fromCharCode(144 + (n >> 12 & 63))); r.push(String.fromCharCode(128 + (n >> 6 & 63))); r.push(String.fromCharCode(128 + (n & 63))); break; default: r.push(String.fromCharCode(224 + (a >> 12))); r.push(String.fromCharCode(128 + (a >> 6 & 63))); r.push(String.fromCharCode(128 + (a & 63))); } } return r.join("") }; var vt = function () { var e = {}; return function r(t, a) { var n = t + "|" + (a || ""); if (e[n]) return e[n]; return e[n] = new RegExp("<(?:\\w+:)?" + t + '(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?' + t + ">", a || "") } }(); var gt = function () { var e = [["nbsp", " "], ["middot", "·"], ["quot", '"'], ["apos", "'"], ["gt", ">"], ["lt", "<"], ["amp", "&"]].map(function (e) { return [new RegExp("&" + e[0] + ";", "ig"), e[1]] }); return function r(t) { var a = t.replace(/^[\t\n\r ]+/, "").replace(/[\t\n\r ]+$/, "").replace(/>\s+/g, ">").replace(/\s+</g, "<").replace(/[\t\n\r ]+/g, " ").replace(/<\s*[bB][rR]\s*\/?>/g, "\n").replace(/<[^>]*>/g, ""); for (var n = 0; n < e.length; ++n)a = a.replace(e[n][0], e[n][1]); return a } }(); var bt = function () { var e = {}; return function r(t) { if (e[t] !== undefined) return e[t]; return e[t] = new RegExp("<(?:vt:)?" + t + ">([\\s\\S]*?)</(?:vt:)?" + t + ">", "g") } }(); var wt = /<\/?(?:vt:)?variant>/g, kt = /<(?:vt:)([^>]*)>([\s\S]*)</; function yt(e, r) { var t = Jr(e); var a = e.match(bt(t.baseType)) || []; var n = []; if (a.length != t.size) { if (r.WTF) throw new Error("unexpected vector length " + a.length + " != " + t.size); return n } a.forEach(function (e) { var r = e.replace(wt, "").match(kt); if (r) n.push({ v: mt(r[2]), t: r[1] }) }); return n } var xt = /(^\s|\s$|\n)/; function St(e, r) { return "<" + e + (r.match(xt) ? ' xml:space="preserve"' : "") + ">" + r + "</" + e + ">" } function Ct(e) { return nr(e).map(function (r) { return " " + r + '="' + e[r] + '"' }).join("") } function _t(e, r, t) { return "<" + e + (t != null ? Ct(t) : "") + (r != null ? (r.match(xt) ? ' xml:space="preserve"' : "") + ">" + r + "</" + e : "/") + ">" } function At(e, r) { try { return e.toISOString().replace(/\.\d*/, "") } catch (t) { if (r) throw t } return "" } function Ft(e, r) { switch (typeof e) { case "string": var t = _t("vt:lpwstr", tt(e)); if (r) t = t.replace(/&quot;/g, "_x0022_"); return t; case "number": return _t((e | 0) == e ? "vt:i4" : "vt:r8", tt(String(e))); case "boolean": return _t("vt:bool", e ? "true" : "false"); }if (e instanceof Date) return _t("vt:filetime", At(e)); throw new Error("Unable to serialize " + e) } function Et(e) { if (x && Buffer.isBuffer(e)) return e.toString("utf8"); if (typeof e === "string") return e; if (typeof Uint8Array !== "undefined" && e instanceof Uint8Array) return mt(E(D(e))); throw new Error("Bad input format: expected Buffer or string") } var Tt = /<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm; var Dt = { CORE_PROPS: "http://schemas.openxmlformats.org/package/2006/metadata/core-properties", CUST_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/custom-properties", EXT_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/extended-properties", CT: "http://schemas.openxmlformats.org/package/2006/content-types", RELS: "http://schemas.openxmlformats.org/package/2006/relationships", TCMNT: "http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments", dc: "http://purl.org/dc/elements/1.1/", dcterms: "http://purl.org/dc/terms/", dcmitype: "http://purl.org/dc/dcmitype/", mx: "http://schemas.microsoft.com/office/mac/excel/2008/main", r: "http://schemas.openxmlformats.org/officeDocument/2006/relationships", sjs: "http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties", vt: "http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes", xsi: "http://www.w3.org/2001/XMLSchema-instance", xsd: "http://www.w3.org/2001/XMLSchema" }; var Ot = ["http://schemas.openxmlformats.org/spreadsheetml/2006/main", "http://purl.oclc.org/ooxml/spreadsheetml/main", "http://schemas.microsoft.com/office/excel/2006/main", "http://schemas.microsoft.com/office/excel/2006/2"]; var Mt = { o: "urn:schemas-microsoft-com:office:office", x: "urn:schemas-microsoft-com:office:excel", ss: "urn:schemas-microsoft-com:office:spreadsheet", dt: "uuid:C2F41010-65B3-11d1-A29F-00AA00C14882", mv: "http://macVmlSchemaUri", v: "urn:schemas-microsoft-com:vml", html: "http://www.w3.org/TR/REC-html40" }; function Nt(e, r) { var t = 1 - 2 * (e[r + 7] >>> 7); var a = ((e[r + 7] & 127) << 4) + (e[r + 6] >>> 4 & 15); var n = e[r + 6] & 15; for (var s = 5; s >= 0; --s)n = n * 256 + e[r + s]; if (a == 2047) return n == 0 ? t * Infinity : NaN; if (a == 0) a = -1022; else { a -= 1023; n += Math.pow(2, 52) } return t * Math.pow(2, a - 52) * n } function Pt(e, r, t) { var a = (r < 0 || 1 / r == -Infinity ? 1 : 0) << 7, n = 0, s = 0; var i = a ? -r : r; if (!isFinite(i)) { n = 2047; s = isNaN(r) ? 26985 : 0 } else if (i == 0) n = s = 0; else { n = Math.floor(Math.log(i) / Math.LN2); s = i * Math.pow(2, 52 - n); if (n <= -1023 && (!isFinite(s) || s < Math.pow(2, 52))) { n = -1022 } else { s -= Math.pow(2, 52); n += 1023 } } for (var l = 0; l <= 5; ++l, s /= 256)e[t + l] = s & 255; e[t + 6] = (n & 15) << 4 | s & 15; e[t + 7] = n >> 4 | a } var It = function (e) { var r = [], t = 10240; for (var a = 0; a < e[0].length; ++a)if (e[0][a]) for (var n = 0, s = e[0][a].length; n < s; n += t)r.push.apply(r, e[0][a].slice(n, n + t)); return r }; var Rt = x ? function (e) { return e[0].length > 0 && Buffer.isBuffer(e[0][0]) ? Buffer.concat(e[0].map(function (e) { return Buffer.isBuffer(e) ? e : S(e) })) : It(e) } : It; var Lt = function (e, r, t) { var a = []; for (var n = r; n < t; n += 2)a.push(String.fromCharCode(na(e, n))); return a.join("").replace(N, "") }; var Bt = x ? function (e, r, t) { if (!Buffer.isBuffer(e)) return Lt(e, r, t); return e.toString("utf16le", r, t).replace(N, "") } : Lt; var zt = function (e, r, t) { var a = []; for (var n = r; n < r + t; ++n)a.push(("0" + e[n].toString(16)).slice(-2)); return a.join("") }; var $t = x ? function (e, r, t) { return Buffer.isBuffer(e) ? e.toString("hex", r, r + t) : zt(e, r, t) } : zt; var Wt = function (e, r, t) { var a = []; for (var n = r; n < t; n++)a.push(String.fromCharCode(aa(e, n))); return a.join("") }; var Ut = x ? function Ec(e, r, t) { return Buffer.isBuffer(e) ? e.toString("utf8", r, t) : Wt(e, r, t) } : Wt; var jt = function (e, r) { var t = ia(e, r); return t > 0 ? Ut(e, r + 4, r + 4 + t - 1) : "" }; var Ht = jt; var Vt = function (e, r) { var t = ia(e, r); return t > 0 ? Ut(e, r + 4, r + 4 + t - 1) : "" }; var Xt = Vt; var Gt = function (e, r) { var t = 2 * ia(e, r); return t > 0 ? Ut(e, r + 4, r + 4 + t - 1) : "" }; var Yt = Gt; var Jt = function Tc(e, r) { var t = ia(e, r); return t > 0 ? Bt(e, r + 4, r + 4 + t) : "" }; var Kt = Jt; var Zt = function (e, r) { var t = ia(e, r); return t > 0 ? Ut(e, r + 4, r + 4 + t) : "" }; var qt = Zt; var Qt = function (e, r) { return Nt(e, r) }; var ea = Qt; var ra = function Dc(e) { return Array.isArray(e) || typeof Uint8Array !== "undefined" && e instanceof Uint8Array }; if (x) { Ht = function Oc(e, r) { if (!Buffer.isBuffer(e)) return jt(e, r); var t = e.readUInt32LE(r); return t > 0 ? e.toString("utf8", r + 4, r + 4 + t - 1) : "" }; Xt = function Mc(e, r) { if (!Buffer.isBuffer(e)) return Vt(e, r); var t = e.readUInt32LE(r); return t > 0 ? e.toString("utf8", r + 4, r + 4 + t - 1) : "" }; Yt = function Nc(e, r) { if (!Buffer.isBuffer(e)) return Gt(e, r); var t = 2 * e.readUInt32LE(r); return e.toString("utf16le", r + 4, r + 4 + t - 1) }; Kt = function Pc(e, r) { if (!Buffer.isBuffer(e)) return Jt(e, r); var t = e.readUInt32LE(r); return e.toString("utf16le", r + 4, r + 4 + t) }; qt = function Ic(e, r) { if (!Buffer.isBuffer(e)) return Zt(e, r); var t = e.readUInt32LE(r); return e.toString("utf8", r + 4, r + 4 + t) }; ea = function Rc(e, r) { if (Buffer.isBuffer(e)) return e.readDoubleLE(r); return Qt(e, r) }; ra = function Lc(e) { return Buffer.isBuffer(e) || Array.isArray(e) || typeof Uint8Array !== "undefined" && e instanceof Uint8Array } } function ta() { Bt = function (e, r, t) { return a.utils.decode(1200, e.slice(r, t)).replace(N, "") }; Ut = function (e, r, t) { return a.utils.decode(65001, e.slice(r, t)) }; Ht = function (e, r) { var n = ia(e, r); return n > 0 ? a.utils.decode(t, e.slice(r + 4, r + 4 + n - 1)) : "" }; Xt = function (e, t) { var n = ia(e, t); return n > 0 ? a.utils.decode(r, e.slice(t + 4, t + 4 + n - 1)) : "" }; Yt = function (e, r) { var t = 2 * ia(e, r); return t > 0 ? a.utils.decode(1200, e.slice(r + 4, r + 4 + t - 1)) : "" }; Kt = function (e, r) { var t = ia(e, r); return t > 0 ? a.utils.decode(1200, e.slice(r + 4, r + 4 + t)) : "" }; qt = function (e, r) { var t = ia(e, r); return t > 0 ? a.utils.decode(65001, e.slice(r + 4, r + 4 + t)) : "" } } if (typeof a !== "undefined") ta(); var aa = function (e, r) { return e[r] }; var na = function (e, r) { return e[r + 1] * (1 << 8) + e[r] }; var sa = function (e, r) { var t = e[r + 1] * (1 << 8) + e[r]; return t < 32768 ? t : (65535 - t + 1) * -1 }; var ia = function (e, r) { return e[r + 3] * (1 << 24) + (e[r + 2] << 16) + (e[r + 1] << 8) + e[r] }; var la = function (e, r) { return e[r + 3] << 24 | e[r + 2] << 16 | e[r + 1] << 8 | e[r] }; var oa = function (e, r) { return e[r] << 24 | e[r + 1] << 16 | e[r + 2] << 8 | e[r + 3] }; function ca(e, t) { var n = "", s, i, l = [], o, c, f, u; switch (t) { case "dbcs": u = this.l; if (x && Buffer.isBuffer(this)) n = this.slice(this.l, this.l + 2 * e).toString("utf16le"); else for (f = 0; f < e; ++f) { n += String.fromCharCode(na(this, u)); u += 2 } e *= 2; break; case "utf8": n = Ut(this, this.l, this.l + e); break; case "utf16le": e *= 2; n = Bt(this, this.l, this.l + e); break; case "wstr": if (typeof a !== "undefined") n = a.utils.decode(r, this.slice(this.l, this.l + 2 * e)); else return ca.call(this, e, "dbcs"); e = 2 * e; break; case "lpstr-ansi": n = Ht(this, this.l); e = 4 + ia(this, this.l); break; case "lpstr-cp": n = Xt(this, this.l); e = 4 + ia(this, this.l); break; case "lpwstr": n = Yt(this, this.l); e = 4 + 2 * ia(this, this.l); break; case "lpp4": e = 4 + ia(this, this.l); n = Kt(this, this.l); if (e & 2) e += 2; break; case "8lpp4": e = 4 + ia(this, this.l); n = qt(this, this.l); if (e & 3) e += 4 - (e & 3); break; case "cstr": e = 0; n = ""; while ((o = aa(this, this.l + e++)) !== 0) l.push(m(o)); n = l.join(""); break; case "_wstr": e = 0; n = ""; while ((o = na(this, this.l + e)) !== 0) { l.push(m(o)); e += 2 } e += 2; n = l.join(""); break; case "dbcs-cont": n = ""; u = this.l; for (f = 0; f < e; ++f) { if (this.lens && this.lens.indexOf(u) !== -1) { o = aa(this, u); this.l = u + 1; c = ca.call(this, e - f, o ? "dbcs-cont" : "sbcs-cont"); return l.join("") + c } l.push(m(na(this, u))); u += 2 } n = l.join(""); e *= 2; break; case "cpstr": if (typeof a !== "undefined") { n = a.utils.decode(r, this.slice(this.l, this.l + e)); break }; case "sbcs-cont": n = ""; u = this.l; for (f = 0; f != e; ++f) { if (this.lens && this.lens.indexOf(u) !== -1) { o = aa(this, u); this.l = u + 1; c = ca.call(this, e - f, o ? "dbcs-cont" : "sbcs-cont"); return l.join("") + c } l.push(m(aa(this, u))); u += 1 } n = l.join(""); break; default: switch (e) { case 1: s = aa(this, this.l); this.l++; return s; case 2: s = (t === "i" ? sa : na)(this, this.l); this.l += 2; return s; case 4: ; case -4: if (t === "i" || (this[this.l + 3] & 128) === 0) { s = (e > 0 ? la : oa)(this, this.l); this.l += 4; return s } else { i = ia(this, this.l); this.l += 4 } return i; case 8: ; case -8: if (t === "f") { if (e == 8) i = ea(this, this.l); else i = ea([this[this.l + 7], this[this.l + 6], this[this.l + 5], this[this.l + 4], this[this.l + 3], this[this.l + 2], this[this.l + 1], this[this.l + 0]], 0); this.l += 8; return i } else e = 8; case 16: n = $t(this, this.l, e); break; }; }this.l += e; return n } var fa = function (e, r, t) { e[t] = r & 255; e[t + 1] = r >>> 8 & 255; e[t + 2] = r >>> 16 & 255; e[t + 3] = r >>> 24 & 255 }; var ua = function (e, r, t) { e[t] = r & 255; e[t + 1] = r >> 8 & 255; e[t + 2] = r >> 16 & 255; e[t + 3] = r >> 24 & 255 }; var ha = function (e, r, t) { e[t] = r & 255; e[t + 1] = r >>> 8 & 255 }; function da(e, r, n) { var s = 0, i = 0; if (n === "dbcs") { for (i = 0; i != r.length; ++i)ha(this, r.charCodeAt(i), this.l + 2 * i); s = 2 * r.length } else if (n === "sbcs") { if (typeof a !== "undefined" && t == 874) { for (i = 0; i != r.length; ++i) { var l = a.utils.encode(t, r.charAt(i)); this[this.l + i] = l[0] } } else { r = r.replace(/[^\x00-\x7F]/g, "_"); for (i = 0; i != r.length; ++i)this[this.l + i] = r.charCodeAt(i) & 255 } s = r.length } else if (n === "hex") { for (; i < e; ++i) { this[this.l++] = parseInt(r.slice(2 * i, 2 * i + 2), 16) || 0 } return this } else if (n === "utf16le") { var o = Math.min(this.l + e, this.length); for (i = 0; i < Math.min(r.length, e); ++i) { var c = r.charCodeAt(i); this[this.l++] = c & 255; this[this.l++] = c >> 8 } while (this.l < o) this[this.l++] = 0; return this } else switch (e) { case 1: s = 1; this[this.l] = r & 255; break; case 2: s = 2; this[this.l] = r & 255; r >>>= 8; this[this.l + 1] = r & 255; break; case 3: s = 3; this[this.l] = r & 255; r >>>= 8; this[this.l + 1] = r & 255; r >>>= 8; this[this.l + 2] = r & 255; break; case 4: s = 4; fa(this, r, this.l); break; case 8: s = 8; if (n === "f") { Pt(this, r, this.l); break }; case 16: break; case -4: s = 4; ua(this, r, this.l); break; }this.l += s; return this } function ma(e, r) { var t = $t(this, this.l, e.length >> 1); if (t !== e) throw new Error(r + "Expected " + e + " saw " + t); this.l += e.length >> 1 } function pa(e, r) { e.l = r; e._R = ca; e.chk = ma; e._W = da } function va(e, r) { e.l += r } function ga(e) { var r = C(e); pa(r, 0); return r } function ba(e, r, t) { if (!e) return; var a, n, s; pa(e, e.l || 0); var i = e.length, l = 0, o = 0; while (e.l < i) { l = e._R(1); if (l & 128) l = (l & 127) + ((e._R(1) & 127) << 7); var c = XLSBRecordEnum[l] || XLSBRecordEnum[65535]; a = e._R(1); s = a & 127; for (n = 1; n < 4 && a & 128; ++n)s += ((a = e._R(1)) & 127) << 7 * n; o = e.l + s; var f = c.f && c.f(e, s, t); e.l = o; if (r(f, c, l)) return } } function wa() { var e = [], r = x ? 256 : 2048; var t = function o(e) { var r = ga(e); pa(r, 0); return r }; var a = t(r); var n = function c() { if (!a) return; if (a.length > a.l) { a = a.slice(0, a.l); a.l = a.length } if (a.length > 0) e.push(a); a = null }; var s = function f(e) { if (a && e < a.length - a.l) return a; n(); return a = t(Math.max(e + 1, r)) }; var i = function u() { n(); return O(e) }; var l = function h(e) { n(); a = e; if (a.l == null) a.l = a.length; s(r) }; return { next: s, push: l, end: i, _bufs: e } } function ka(e, r, t, a) { var n = +r, s; if (isNaN(n)) return; if (!a) a = XLSBRecordEnum[n].p || (t || []).length || 0; s = 1 + (n >= 128 ? 1 : 0) + 1; if (a >= 128) ++s; if (a >= 16384) ++s; if (a >= 2097152) ++s; var i = e.next(s); if (n <= 127) i._W(1, n); else { i._W(1, (n & 127) + 128); i._W(1, n >> 7) } for (var l = 0; l != 4; ++l) { if (a >= 128) { i._W(1, (a & 127) + 128); a >>= 7 } else { i._W(1, a); break } } if (a > 0 && ra(t)) e.push(t) } function ya(e, r, t) { var a = yr(e); if (r.s) { if (a.cRel) a.c += r.s.c; if (a.rRel) a.r += r.s.r } else { if (a.cRel) a.c += r.c; if (a.rRel) a.r += r.r } if (!t || t.biff < 12) { while (a.c >= 256) a.c -= 256; while (a.r >= 65536) a.r -= 65536 } return a } function xa(e, r, t) { var a = yr(e); a.s = ya(a.s, r.s, t); a.e = ya(a.e, r.s, t); return a } function Sa(e, r) { if (e.cRel && e.c < 0) { e = yr(e); while (e.c < 0) e.c += r > 8 ? 16384 : 256 } if (e.rRel && e.r < 0) { e = yr(e); while (e.r < 0) e.r += r > 8 ? 1048576 : r > 5 ? 65536 : 16384 } var t = Ia(e); if (!e.cRel && e.cRel != null) t = Oa(t); if (!e.rRel && e.rRel != null) t = Fa(t); return t } function Ca(e, r) { if (e.s.r == 0 && !e.s.rRel) { if (e.e.r == (r.biff >= 12 ? 1048575 : r.biff >= 8 ? 65536 : 16384) && !e.e.rRel) { return (e.s.cRel ? "" : "$") + Da(e.s.c) + ":" + (e.e.cRel ? "" : "$") + Da(e.e.c) } } if (e.s.c == 0 && !e.s.cRel) { if (e.e.c == (r.biff >= 12 ? 16383 : 255) && !e.e.cRel) { return (e.s.rRel ? "" : "$") + Aa(e.s.r) + ":" + (e.e.rRel ? "" : "$") + Aa(e.e.r) } } return Sa(e.s, r.biff) + ":" + Sa(e.e, r.biff) } function _a(e) { return parseInt(Ea(e), 10) - 1 } function Aa(e) { return "" + (e + 1) } function Fa(e) { return e.replace(/([A-Z]|^)(\d+)$/, "$1$$$2") } function Ea(e) { return e.replace(/\$(\d+)$/, "$1") } function Ta(e) { var r = Ma(e), t = 0, a = 0; for (; a !== r.length; ++a)t = 26 * t + r.charCodeAt(a) - 64; return t - 1 } function Da(e) { if (e < 0) throw new Error("invalid column " + e); var r = ""; for (++e; e; e = Math.floor((e - 1) / 26))r = String.fromCharCode((e - 1) % 26 + 65) + r; return r } function Oa(e) { return e.replace(/^([A-Z])/, "$$$1") } function Ma(e) { return e.replace(/^\$([A-Z])/, "$1") } function Na(e) { return e.replace(/(\$?[A-Z]*)(\$?\d*)/, "$1,$2").split(",") } function Pa(e) { var r = 0, t = 0; for (var a = 0; a < e.length; ++a) { var n = e.charCodeAt(a); if (n >= 48 && n <= 57) r = 10 * r + (n - 48); else if (n >= 65 && n <= 90) t = 26 * t + (n - 64) } return { c: t - 1, r: r - 1 } } function Ia(e) { var r = e.c + 1; var t = ""; for (; r; r = (r - 1) / 26 | 0)t = String.fromCharCode((r - 1) % 26 + 65) + t; return t + (e.r + 1) } function Ra(e) { var r = e.indexOf(":"); if (r == -1) return { s: Pa(e), e: Pa(e) }; return { s: Pa(e.slice(0, r)), e: Pa(e.slice(r + 1)) } } function La(e, r) { if (typeof r === "undefined" || typeof r === "number") { return La(e.s, e.e) } if (typeof e !== "string") e = Ia(e); if (typeof r !== "string") r = Ia(r); return e == r ? e : e + ":" + r } function Ba(e) { var r = Ra(e); return "$" + Da(r.s.c) + "$" + Aa(r.s.r) + ":$" + Da(r.e.c) + "$" + Aa(r.e.r) } function za(e, r) { if (!e && !(r && r.biff <= 5 && r.biff >= 2)) throw new Error("empty sheet name"); if (/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)) return "'" + e.replace(/'/g, "''") + "'"; return e } function $a(e) { var r = { s: { c: 0, r: 0 }, e: { c: 0, r: 0 } }; var t = 0, a = 0, n = 0; var s = e.length; for (t = 0; a < s; ++a) { if ((n = e.charCodeAt(a) - 64) < 1 || n > 26) break; t = 26 * t + n } r.s.c = --t; for (t = 0; a < s; ++a) { if ((n = e.charCodeAt(a) - 48) < 0 || n > 9) break; t = 10 * t + n } r.s.r = --t; if (a === s || n != 10) { r.e.c = r.s.c; r.e.r = r.s.r; return r } ++a; for (t = 0; a != s; ++a) { if ((n = e.charCodeAt(a) - 64) < 1 || n > 26) break; t = 26 * t + n } r.e.c = --t; for (t = 0; a != s; ++a) { if ((n = e.charCodeAt(a) - 48) < 0 || n > 9) break; t = 10 * t + n } r.e.r = --t; return r } function Wa(e, r) { var t = e.t == "d" && r instanceof Date; if (e.z != null) try { return e.w = $e(e.z, t ? fr(r) : r) } catch (a) { } try { return e.w = $e((e.XF || {}).numFmtId || (t ? 14 : 0), t ? fr(r) : r) } catch (a) { return "" + r } } function Ua(e, r, t) { if (e == null || e.t == null || e.t == "z") return ""; if (e.w !== undefined) return e.w; if (e.t == "d" && !e.z && t && t.dateNF) e.z = t.dateNF; if (e.t == "e") return dn[e.v] || e.v; if (r == undefined) return Wa(e, e.v); return Wa(e, r) } function ja(e, r) { var t = r && r.sheet ? r.sheet : "Sheet1"; var a = {}; a[t] = e; return { SheetNames: [t], Sheets: a } } function Ha(e, r, t) { var a = t || {}; var n = e ? Array.isArray(e) : a.dense; if (g != null && n == null) n = g; var s = e || (n ? [] : {}); var i = 0, l = 0; if (s && a.origin != null) { if (typeof a.origin == "number") i = a.origin; else { var o = typeof a.origin == "string" ? Pa(a.origin) : a.origin; i = o.r; l = o.c } if (!s["!ref"]) s["!ref"] = "A1:A1" } var c = { s: { c: 1e7, r: 1e7 }, e: { c: 0, r: 0 } }; if (s["!ref"]) { var f = $a(s["!ref"]); c.s.c = f.s.c; c.s.r = f.s.r; c.e.c = Math.max(c.e.c, f.e.c); c.e.r = Math.max(c.e.r, f.e.r); if (i == -1) c.e.r = i = f.e.r + 1 } for (var u = 0; u != r.length; ++u) { if (!r[u]) continue; if (!Array.isArray(r[u])) throw new Error("aoa_to_sheet expects an array of arrays"); for (var h = 0; h != r[u].length; ++h) { if (typeof r[u][h] === "undefined") continue; var d = { v: r[u][h] }; var m = i + u, p = l + h; if (c.s.r > m) c.s.r = m; if (c.s.c > p) c.s.c = p; if (c.e.r < m) c.e.r = m; if (c.e.c < p) c.e.c = p; if (r[u][h] && typeof r[u][h] === "object" && !Array.isArray(r[u][h]) && !(r[u][h] instanceof Date)) d = r[u][h]; else { if (Array.isArray(d.v)) { d.f = r[u][h][1]; d.v = d.v[0] } if (d.v === null) { if (d.f) d.t = "n"; else if (a.nullError) { d.t = "e"; d.v = 0 } else if (!a.sheetStubs) continue; else d.t = "z" } else if (typeof d.v === "number") d.t = "n"; else if (typeof d.v === "boolean") d.t = "b"; else if (d.v instanceof Date) { d.z = a.dateNF || Y[14]; if (a.cellDates) { d.t = "d"; d.w = $e(d.z, fr(d.v, a.date1904)) } else { d.t = "n"; d.v = fr(d.v, a.date1904); d.w = $e(d.z, d.v) } } else d.t = "s" } if (n) { if (!s[m]) s[m] = []; if (s[m][p] && s[m][p].z) d.z = s[m][p].z; s[m][p] = d } else { var v = Ia({ c: p, r: m }); if (s[v] && s[v].z) d.z = s[v].z; s[v] = d } } } if (c.s.c < 1e7) s["!ref"] = La(c); return s } function Va(e, r) { return Ha(null, e, r) } var Xa = 2; var Ga = 3; var Ya = 11; var Ja = 12; var Ka = 19; var Za = 64; var qa = 65; var Qa = 71; var en = 4108; var rn = 4126; var tn = 80; var an = 81; var nn = [tn, an]; var sn = { 1: { n: "CodePage", t: Xa }, 2: { n: "Category", t: tn }, 3: { n: "PresentationFormat", t: tn }, 4: { n: "ByteCount", t: Ga }, 5: { n: "LineCount", t: Ga }, 6: { n: "ParagraphCount", t: Ga }, 7: { n: "SlideCount", t: Ga }, 8: { n: "NoteCount", t: Ga }, 9: { n: "HiddenCount", t: Ga }, 10: { n: "MultimediaClipCount", t: Ga }, 11: { n: "ScaleCrop", t: Ya }, 12: { n: "HeadingPairs", t: en }, 13: { n: "TitlesOfParts", t: rn }, 14: { n: "Manager", t: tn }, 15: { n: "Company", t: tn }, 16: { n: "LinksUpToDate", t: Ya }, 17: { n: "CharacterCount", t: Ga }, 19: { n: "SharedDoc", t: Ya }, 22: { n: "HyperlinksChanged", t: Ya }, 23: { n: "AppVersion", t: Ga, p: "version" }, 24: { n: "DigSig", t: qa }, 26: { n: "ContentType", t: tn }, 27: { n: "ContentStatus", t: tn }, 28: { n: "Language", t: tn }, 29: { n: "Version", t: tn }, 255: {}, 2147483648: { n: "Locale", t: Ka }, 2147483651: { n: "Behavior", t: Ka }, 1919054434: {} }; var ln = { 1: { n: "CodePage", t: Xa }, 2: { n: "Title", t: tn }, 3: { n: "Subject", t: tn }, 4: { n: "Author", t: tn }, 5: { n: "Keywords", t: tn }, 6: { n: "Comments", t: tn }, 7: { n: "Template", t: tn }, 8: { n: "LastAuthor", t: tn }, 9: { n: "RevNumber", t: tn }, 10: { n: "EditTime", t: Za }, 11: { n: "LastPrinted", t: Za }, 12: { n: "CreatedDate", t: Za }, 13: { n: "ModifiedDate", t: Za }, 14: { n: "PageCount", t: Ga }, 15: { n: "WordCount", t: Ga }, 16: { n: "CharCount", t: Ga }, 17: { n: "Thumbnail", t: Qa }, 18: { n: "Application", t: tn }, 19: { n: "DocSecurity", t: Ga }, 255: {}, 2147483648: { n: "Locale", t: Ka }, 2147483651: { n: "Behavior", t: Ka }, 1919054434: {} }; var on = { 1: "US", 2: "CA", 3: "", 7: "RU", 20: "EG", 30: "GR", 31: "NL", 32: "BE", 33: "FR", 34: "ES", 36: "HU", 39: "IT", 41: "CH", 43: "AT", 44: "GB", 45: "DK", 46: "SE", 47: "NO", 48: "PL", 49: "DE", 52: "MX", 55: "BR", 61: "AU", 64: "NZ", 66: "TH", 81: "JP", 82: "KR", 84: "VN", 86: "CN", 90: "TR", 105: "JS", 213: "DZ", 216: "MA", 218: "LY", 351: "PT", 354: "IS", 358: "FI", 420: "CZ", 886: "TW", 961: "LB", 962: "JO", 963: "SY", 964: "IQ", 965: "KW", 966: "SA", 971: "AE", 972: "IL", 974: "QA", 981: "IR", 65535: "US" }; var cn = [null, "solid", "mediumGray", "darkGray", "lightGray", "darkHorizontal", "darkVertical", "darkDown", "darkUp", "darkGrid", "darkTrellis", "lightHorizontal", "lightVertical", "lightDown", "lightUp", "lightGrid", "lightTrellis", "gray125", "gray0625"]; function fn(e) { return e.map(function (e) { return [e >> 16 & 255, e >> 8 & 255, e & 255] }) } var un = fn([0, 16777215, 16711680, 65280, 255, 16776960, 16711935, 65535, 0, 16777215, 16711680, 65280, 255, 16776960, 16711935, 65535, 8388608, 32768, 128, 8421376, 8388736, 32896, 12632256, 8421504, 10066431, 10040166, 16777164, 13434879, 6684774, 16744576, 26316, 13421823, 128, 16711935, 16776960, 65535, 8388736, 8388608, 32896, 255, 52479, 13434879, 13434828, 16777113, 10079487, 16751052, 13408767, 16764057, 3368703, 3394764, 10079232, 16763904, 16750848, 16737792, 6710937, 9868950, 13158, 3381606, 13056, 3355392, 10040064, 10040166, 3355545, 3355443, 0, 16777215, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]); var hn = yr(un); var dn = { 0: "#NULL!", 7: "#DIV/0!", 15: "#VALUE!", 23: "#REF!", 29: "#NAME?", 36: "#NUM!", 42: "#N/A", 43: "#GETTING_DATA", 255: "#WTF?" }; var mn = { "#NULL!": 0, "#DIV/0!": 7, "#VALUE!": 15, "#REF!": 23, "#NAME?": 29, "#NUM!": 36, "#N/A": 42, "#GETTING_DATA": 43, "#WTF?": 255 }; var pn = ["_xlnm.Consolidate_Area", "_xlnm.Auto_Open", "_xlnm.Auto_Close", "_xlnm.Extract", "_xlnm.Database", "_xlnm.Criteria", "_xlnm.Print_Area", "_xlnm.Print_Titles", "_xlnm.Recorder", "_xlnm.Data_Form", "_xlnm.Auto_Activate", "_xlnm.Auto_Deactivate", "_xlnm.Sheet_Title", "_xlnm._FilterDatabase"]; var vn = {
        "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml": "workbooks", "application/vnd.ms-excel.sheet.macroEnabled.main+xml": "workbooks", "application/vnd.ms-excel.sheet.binary.macroEnabled.main": "workbooks", "application/vnd.ms-excel.addin.macroEnabled.main+xml": "workbooks", "application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml": "workbooks", "application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml": "sheets", "application/vnd.ms-excel.worksheet": "sheets", "application/vnd.ms-excel.binIndexWs": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml": "charts", "application/vnd.ms-excel.chartsheet": "charts", "application/vnd.ms-excel.macrosheet+xml": "macros", "application/vnd.ms-excel.macrosheet": "macros", "application/vnd.ms-excel.intlmacrosheet": "TODO", "application/vnd.ms-excel.binIndexMs": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml": "dialogs", "application/vnd.ms-excel.dialogsheet": "dialogs", "application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml": "strs", "application/vnd.ms-excel.sharedStrings": "strs", "application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml": "styles", "application/vnd.ms-excel.styles": "styles", "application/vnd.openxmlformats-package.core-properties+xml": "coreprops", "application/vnd.openxmlformats-officedocument.custom-properties+xml": "custprops", "application/vnd.openxmlformats-officedocument.extended-properties+xml": "extprops", "application/vnd.openxmlformats-officedocument.customXmlProperties+xml": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml": "comments", "application/vnd.ms-excel.comments": "comments", "application/vnd.ms-excel.threadedcomments+xml": "threadedcomments", "application/vnd.ms-excel.person+xml": "people",
        "application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml": "metadata", "application/vnd.ms-excel.sheetMetadata": "metadata", "application/vnd.ms-excel.pivotTable": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml": "TODO", "application/vnd.openxmlformats-officedocument.drawingml.chart+xml": "TODO", "application/vnd.ms-office.chartcolorstyle+xml": "TODO", "application/vnd.ms-office.chartstyle+xml": "TODO", "application/vnd.ms-office.chartex+xml": "TODO", "application/vnd.ms-excel.calcChain": "calcchains", "application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml": "calcchains", "application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings": "TODO", "application/vnd.ms-office.activeX": "TODO", "application/vnd.ms-office.activeX+xml": "TODO", "application/vnd.ms-excel.attachedToolbars": "TODO", "application/vnd.ms-excel.connections": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml": "TODO", "application/vnd.ms-excel.externalLink": "links", "application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml": "links", "application/vnd.ms-excel.pivotCacheDefinition": "TODO", "application/vnd.ms-excel.pivotCacheRecords": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml": "TODO", "application/vnd.ms-excel.queryTable": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml": "TODO", "application/vnd.ms-excel.userNames": "TODO", "application/vnd.ms-excel.revisionHeaders": "TODO", "application/vnd.ms-excel.revisionLog": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml": "TODO", "application/vnd.ms-excel.tableSingleCells": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml": "TODO", "application/vnd.ms-excel.slicer": "TODO", "application/vnd.ms-excel.slicerCache": "TODO", "application/vnd.ms-excel.slicer+xml": "TODO", "application/vnd.ms-excel.slicerCache+xml": "TODO", "application/vnd.ms-excel.wsSortMap": "TODO", "application/vnd.ms-excel.table": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml": "TODO", "application/vnd.openxmlformats-officedocument.theme+xml": "themes", "application/vnd.openxmlformats-officedocument.themeOverride+xml": "TODO", "application/vnd.ms-excel.Timeline+xml": "TODO", "application/vnd.ms-excel.TimelineCache+xml": "TODO", "application/vnd.ms-office.vbaProject": "vba", "application/vnd.ms-office.vbaProjectSignature": "TODO", "application/vnd.ms-office.volatileDependencies": "TODO", "application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml": "TODO", "application/vnd.ms-excel.controlproperties+xml": "TODO", "application/vnd.openxmlformats-officedocument.model+data": "TODO", "application/vnd.ms-excel.Survey+xml": "TODO", "application/vnd.openxmlformats-officedocument.drawing+xml": "drawings", "application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml": "TODO", "application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml": "TODO", "application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml": "TODO", "application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml": "TODO", "application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml": "TODO", "application/vnd.openxmlformats-officedocument.vmlDrawing": "TODO", "application/vnd.openxmlformats-package.relationships+xml": "rels", "application/vnd.openxmlformats-officedocument.oleObject": "TODO", "image/png": "TODO", sheet: "js"
    }; var gn = { workbooks: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml", xlsm: "application/vnd.ms-excel.sheet.macroEnabled.main+xml", xlsb: "application/vnd.ms-excel.sheet.binary.macroEnabled.main", xlam: "application/vnd.ms-excel.addin.macroEnabled.main+xml", xltx: "application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml" }, strs: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml", xlsb: "application/vnd.ms-excel.sharedStrings" }, comments: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml", xlsb: "application/vnd.ms-excel.comments" }, sheets: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml", xlsb: "application/vnd.ms-excel.worksheet" }, charts: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml", xlsb: "application/vnd.ms-excel.chartsheet" }, dialogs: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml", xlsb: "application/vnd.ms-excel.dialogsheet" }, macros: { xlsx: "application/vnd.ms-excel.macrosheet+xml", xlsb: "application/vnd.ms-excel.macrosheet" }, metadata: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml", xlsb: "application/vnd.ms-excel.sheetMetadata" }, styles: { xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml", xlsb: "application/vnd.ms-excel.styles" } }; function bn() { return { workbooks: [], sheets: [], charts: [], dialogs: [], macros: [], rels: [], strs: [], comments: [], threadedcomments: [], links: [], coreprops: [], extprops: [], custprops: [], themes: [], styles: [], calcchains: [], vba: [], drawings: [], metadata: [], people: [], TODO: [], xmlns: "" } } function wn(e) { var r = bn(); if (!e || !e.match) return r; var t = {}; (e.match(Xr) || []).forEach(function (e) { var a = Jr(e); switch (a[0].replace(Gr, "<")) { case "<?xml": break; case "<Types": r.xmlns = a["xmlns" + (a[0].match(/<(\w+):/) || ["", ""])[1]]; break; case "<Default": t[a.Extension.toLowerCase()] = a.ContentType; break; case "<Override": if (r[vn[a.ContentType]] !== undefined) r[vn[a.ContentType]].push(a.PartName); break; } }); if (r.xmlns !== Dt.CT) throw new Error("Unknown Namespace: " + r.xmlns); r.calcchain = r.calcchains.length > 0 ? r.calcchains[0] : ""; r.sst = r.strs.length > 0 ? r.strs[0] : ""; r.style = r.styles.length > 0 ? r.styles[0] : ""; r.defaults = t; delete r.calcchains; return r } function kn(e, r, t) { var a = or(vn); var n = [], s; if (!t) { n[n.length] = Ur; n[n.length] = _t("Types", null, { xmlns: Dt.CT, "xmlns:xsd": Dt.xsd, "xmlns:xsi": Dt.xsi }); n = n.concat([["xml", "application/xml"], ["bin", "application/vnd.ms-excel.sheet.binary.macroEnabled.main"], ["vml", "application/vnd.openxmlformats-officedocument.vmlDrawing"], ["data", "application/vnd.openxmlformats-officedocument.model+data"], ["bmp", "image/bmp"], ["png", "image/png"], ["gif", "image/gif"], ["emf", "image/x-emf"], ["wmf", "image/x-wmf"], ["jpg", "image/jpeg"], ["jpeg", "image/jpeg"], ["tif", "image/tiff"], ["tiff", "image/tiff"], ["pdf", "application/pdf"], ["rels", "application/vnd.openxmlformats-package.relationships+xml"]].map(function (e) { return _t("Default", null, { Extension: e[0], ContentType: e[1] }) })) } var i = function (t) { if (e[t] && e[t].length > 0) { s = e[t][0]; n[n.length] = _t("Override", null, { PartName: (s[0] == "/" ? "" : "/") + s, ContentType: gn[t][r.bookType] || gn[t]["xlsx"] }) } }; var l = function (t) { (e[t] || []).forEach(function (e) { n[n.length] = _t("Override", null, { PartName: (e[0] == "/" ? "" : "/") + e, ContentType: gn[t][r.bookType] || gn[t]["xlsx"] }) }) }; var o = function (r) { (e[r] || []).forEach(function (e) { n[n.length] = _t("Override", null, { PartName: (e[0] == "/" ? "" : "/") + e, ContentType: a[r][0] }) }) }; i("workbooks"); l("sheets"); l("charts"); o("themes");["strs", "styles"].forEach(i);["coreprops", "extprops", "custprops"].forEach(o); o("vba"); o("comments"); o("threadedcomments"); o("drawings"); l("metadata"); o("people"); if (!t && n.length > 2) { n[n.length] = "</Types>"; n[1] = n[1].replace("/>", ">") } return n.join("") } var yn = { WB: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument", SHEET: "http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument", HLINK: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink", VML: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing", XPATH: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath", XMISS: "http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing", XLINK: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink", CXML: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml", CXMLP: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps", CMNT: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments", CORE_PROPS: "http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties", EXT_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties", CUST_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties", SST: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings", STY: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles", THEME: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme", CHART: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart", CHARTEX: "http://schemas.microsoft.com/office/2014/relationships/chartEx", CS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet", WS: ["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet", "http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"], DS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet", MS: "http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet", IMG: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/image", DRAW: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing", XLMETA: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata", TCMNT: "http://schemas.microsoft.com/office/2017/10/relationships/threadedComment", PEOPLE: "http://schemas.microsoft.com/office/2017/10/relationships/person", CONN: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections", VBA: "http://schemas.microsoft.com/office/2006/relationships/vbaProject" }; function xn(e) { var r = e.lastIndexOf("/"); return e.slice(0, r + 1) + "_rels/" + e.slice(r + 1) + ".rels" } function Sn(e, r) { var t = { "!id": {} }; if (!e) return t; if (r.charAt(0) !== "/") { r = "/" + r } var a = {}; (e.match(Xr) || []).forEach(function (e) { var n = Jr(e); if (n[0] === "<Relationship") { var s = {}; s.Type = n.Type; s.Target = n.Target; s.Id = n.Id; if (n.TargetMode) s.TargetMode = n.TargetMode; var i = n.TargetMode === "External" ? n.Target : Wr(n.Target, r); t[i] = s; a[n.Id] = s } }); t["!id"] = a; return t } function Cn(e) { var r = [Ur, _t("Relationships", null, { xmlns: Dt.RELS })]; nr(e["!id"]).forEach(function (t) { r[r.length] = _t("Relationship", null, e["!id"][t]) }); if (r.length > 2) { r[r.length] = "</Relationships>"; r[1] = r[1].replace("/>", ">") } return r.join("") } function _n(e, r, t, a, n, s) { if (!n) n = {}; if (!e["!id"]) e["!id"] = {}; if (!e["!idx"]) e["!idx"] = 1; if (r < 0) for (r = e["!idx"]; e["!id"]["rId" + r]; ++r) { } e["!idx"] = r + 1; n.Id = "rId" + r; n.Type = a; n.Target = t; if (s) n.TargetMode = s; else if ([yn.HLINK, yn.XPATH, yn.XMISS].indexOf(n.Type) > -1) n.TargetMode = "External"; if (e["!id"][n.Id]) throw new Error("Cannot rewrite rId " + r); e["!id"][n.Id] = n; e[("/" + n.Target).replace("//", "/")] = n; return r } var An = "application/vnd.oasis.opendocument.spreadsheet"; function Fn(e, r) { var t = Et(e); var a; var n; while (a = Tt.exec(t)) switch (a[3]) { case "manifest": break; case "file-entry": n = Jr(a[0], false); if (n.path == "/" && n.type !== An) throw new Error("This OpenDocument is not a spreadsheet"); break; case "encryption-data": ; case "algorithm": ; case "start-key-generation": ; case "key-derivation": throw new Error("Unsupported ODS Encryption"); default: if (r && r.WTF) throw a; } } function En(e) { var r = [Ur]; r.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'); r.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n'); for (var t = 0; t < e.length; ++t)r.push('  <manifest:file-entry manifest:full-path="' + e[t][0] + '" manifest:media-type="' + e[t][1] + '"/>\n'); r.push("</manifest:manifest>"); return r.join("") } function Tn(e, r, t) { return ['  <rdf:Description rdf:about="' + e + '">\n', '    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/' + (t || "odf") + "#" + r + '"/>\n', "  </rdf:Description>\n"].join("") } function Dn(e, r) { return ['  <rdf:Description rdf:about="' + e + '">\n', '    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="' + r + '"/>\n', "  </rdf:Description>\n"].join("") } function On(e) { var r = [Ur]; r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n'); for (var t = 0; t != e.length; ++t) { r.push(Tn(e[t][0], e[t][1])); r.push(Dn("", e[t][0])) } r.push(Tn("", "Document", "pkg")); r.push("</rdf:RDF>"); return r.join("") } function Mn() { return '<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>Sheet' + "JS " + e.version + "</meta:generator></office:meta></office:document-meta>" } var Nn = [["cp:category", "Category"], ["cp:contentStatus", "ContentStatus"], ["cp:keywords", "Keywords"], ["cp:lastModifiedBy", "LastAuthor"], ["cp:lastPrinted", "LastPrinted"], ["cp:revision", "RevNumber"], ["cp:version", "Version"], ["dc:creator", "Author"], ["dc:description", "Comments"], ["dc:identifier", "Identifier"], ["dc:language", "Language"], ["dc:subject", "Subject"], ["dc:title", "Title"], ["dcterms:created", "CreatedDate", "date"], ["dcterms:modified", "ModifiedDate", "date"]]; var Pn = function () { var e = new Array(Nn.length); for (var r = 0; r < Nn.length; ++r) { var t = Nn[r]; var a = "(?:" + t[0].slice(0, t[0].indexOf(":")) + ":)" + t[0].slice(t[0].indexOf(":") + 1); e[r] = new RegExp("<" + a + "[^>]*>([\\s\\S]*?)</" + a + ">") } return e }(); function In(e) { var r = {}; e = mt(e); for (var t = 0; t < Nn.length; ++t) { var a = Nn[t], n = e.match(Pn[t]); if (n != null && n.length > 0) r[a[1]] = Qr(n[1]); if (a[2] === "date" && r[a[1]]) r[a[1]] = wr(r[a[1]]) } return r } function Rn(e, r, t, a, n) { if (n[e] != null || r == null || r === "") return; n[e] = r; r = tt(r); a[a.length] = t ? _t(e, r, t) : St(e, r) } function Ln(e, r) { var t = r || {}; var a = [Ur, _t("cp:coreProperties", null, { "xmlns:cp": Dt.CORE_PROPS, "xmlns:dc": Dt.dc, "xmlns:dcterms": Dt.dcterms, "xmlns:dcmitype": Dt.dcmitype, "xmlns:xsi": Dt.xsi })], n = {}; if (!e && !t.Props) return a.join(""); if (e) { if (e.CreatedDate != null) Rn("dcterms:created", typeof e.CreatedDate === "string" ? e.CreatedDate : At(e.CreatedDate, t.WTF), { "xsi:type": "dcterms:W3CDTF" }, a, n); if (e.ModifiedDate != null) Rn("dcterms:modified", typeof e.ModifiedDate === "string" ? e.ModifiedDate : At(e.ModifiedDate, t.WTF), { "xsi:type": "dcterms:W3CDTF" }, a, n) } for (var s = 0; s != Nn.length; ++s) { var i = Nn[s]; var l = t.Props && t.Props[i[1]] != null ? t.Props[i[1]] : e ? e[i[1]] : null; if (l === true) l = "1"; else if (l === false) l = "0"; else if (typeof l == "number") l = String(l); if (l != null) Rn(i[0], l, null, a, n) } if (a.length > 2) { a[a.length] = "</cp:coreProperties>"; a[1] = a[1].replace("/>", ">") } return a.join("") } var Bn = [["Application", "Application", "string"], ["AppVersion", "AppVersion", "string"], ["Company", "Company", "string"], ["DocSecurity", "DocSecurity", "string"], ["Manager", "Manager", "string"], ["HyperlinksChanged", "HyperlinksChanged", "bool"], ["SharedDoc", "SharedDoc", "bool"], ["LinksUpToDate", "LinksUpToDate", "bool"], ["ScaleCrop", "ScaleCrop", "bool"], ["HeadingPairs", "HeadingPairs", "raw"], ["TitlesOfParts", "TitlesOfParts", "raw"]]; var zn = ["Worksheets", "SheetNames", "NamedRanges", "DefinedNames", "Chartsheets", "ChartNames"]; function $n(e, r, t, a) { var n = []; if (typeof e == "string") n = yt(e, a); else for (var s = 0; s < e.length; ++s)n = n.concat(e[s].map(function (e) { return { v: e } })); var i = typeof r == "string" ? yt(r, a).map(function (e) { return e.v }) : r; var l = 0, o = 0; if (i.length > 0) for (var c = 0; c !== n.length; c += 2) { o = +n[c + 1].v; switch (n[c].v) { case "Worksheets": ; case "工作表": ; case "Листы": ; case "أوراق العمل": ; case "ワークシート": ; case "גליונות עבודה": ; case "Arbeitsblätter": ; case "Çalışma Sayfaları": ; case "Feuilles de calcul": ; case "Fogli di lavoro": ; case "Folhas de cálculo": ; case "Planilhas": ; case "Regneark": ; case "Hojas de cálculo": ; case "Werkbladen": t.Worksheets = o; t.SheetNames = i.slice(l, l + o); break; case "Named Ranges": ; case "Rangos con nombre": ; case "名前付き一覧": ; case "Benannte Bereiche": ; case "Navngivne områder": t.NamedRanges = o; t.DefinedNames = i.slice(l, l + o); break; case "Charts": ; case "Diagramme": t.Chartsheets = o; t.ChartNames = i.slice(l, l + o); break; }l += o } } function Wn(e, r, t) { var a = {}; if (!r) r = {}; e = mt(e); Bn.forEach(function (t) { var n = (e.match(vt(t[0])) || [])[1]; switch (t[2]) { case "string": if (n) r[t[1]] = Qr(n); break; case "bool": r[t[1]] = n === "true"; break; case "raw": var s = e.match(new RegExp("<" + t[0] + "[^>]*>([\\s\\S]*?)</" + t[0] + ">")); if (s && s.length > 0) a[t[1]] = s[1]; break; } }); if (a.HeadingPairs && a.TitlesOfParts) $n(a.HeadingPairs, a.TitlesOfParts, r, t); return r } function Un(e) { var r = [], t = _t; if (!e) e = {}; e.Application = "SheetJS"; r[r.length] = Ur; r[r.length] = _t("Properties", null, { xmlns: Dt.EXT_PROPS, "xmlns:vt": Dt.vt }); Bn.forEach(function (a) { if (e[a[1]] === undefined) return; var n; switch (a[2]) { case "string": n = tt(String(e[a[1]])); break; case "bool": n = e[a[1]] ? "true" : "false"; break; }if (n !== undefined) r[r.length] = t(a[0], n) }); r[r.length] = t("HeadingPairs", t("vt:vector", t("vt:variant", "<vt:lpstr>Worksheets</vt:lpstr>") + t("vt:variant", t("vt:i4", String(e.Worksheets))), { size: 2, baseType: "variant" })); r[r.length] = t("TitlesOfParts", t("vt:vector", e.SheetNames.map(function (e) { return "<vt:lpstr>" + tt(e) + "</vt:lpstr>" }).join(""), { size: e.Worksheets, baseType: "lpstr" })); if (r.length > 2) { r[r.length] = "</Properties>"; r[1] = r[1].replace("/>", ">") } return r.join("") } var jn = /<[^>]+>[^<]*/g; function Hn(e, r) { var t = {}, a = ""; var n = e.match(jn); if (n) for (var s = 0; s != n.length; ++s) { var i = n[s], l = Jr(i); switch (l[0]) { case "<?xml": break; case "<Properties": break; case "<property": a = Qr(l.name); break; case "</property>": a = null; break; default: if (i.indexOf("<vt:") === 0) { var o = i.split(">"); var c = o[0].slice(4), f = o[1]; switch (c) { case "lpstr": ; case "bstr": ; case "lpwstr": t[a] = Qr(f); break; case "bool": t[a] = ct(f); break; case "i1": ; case "i2": ; case "i4": ; case "i8": ; case "int": ; case "uint": t[a] = parseInt(f, 10); break; case "r4": ; case "r8": ; case "decimal": t[a] = parseFloat(f); break; case "filetime": ; case "date": t[a] = wr(f); break; case "cy": ; case "error": t[a] = Qr(f); break; default: if (c.slice(-1) == "/") break; if (r.WTF && typeof console !== "undefined") console.warn("Unexpected", i, c, o); } } else if (i.slice(0, 2) === "</") { } else if (r.WTF) throw new Error(i); } } return t } function Vn(e) { var r = [Ur, _t("Properties", null, { xmlns: Dt.CUST_PROPS, "xmlns:vt": Dt.vt })]; if (!e) return r.join(""); var t = 1; nr(e).forEach(function a(n) { ++t; r[r.length] = _t("property", Ft(e[n], true), { fmtid: "{D5CDD505-2E9C-101B-9397-08002B2CF9AE}", pid: t, name: tt(n) }) }); if (r.length > 2) { r[r.length] = "</Properties>"; r[1] = r[1].replace("/>", ">") } return r.join("") } var Xn = [2, 3, 48, 49, 131, 139, 140, 245]; var Gn = function () { var e = { 1: 437, 2: 850, 3: 1252, 4: 1e4, 100: 852, 101: 866, 102: 865, 103: 861, 104: 895, 105: 620, 106: 737, 107: 857, 120: 950, 121: 949, 122: 936, 123: 932, 124: 874, 125: 1255, 126: 1256, 150: 10007, 151: 10029, 152: 10006, 200: 1250, 201: 1251, 202: 1254, 203: 1253, 0: 20127, 8: 865, 9: 437, 10: 850, 11: 437, 13: 437, 14: 850, 15: 437, 16: 850, 17: 437, 18: 850, 19: 932, 20: 850, 21: 437, 22: 850, 23: 865, 24: 437, 25: 437, 26: 850, 27: 437, 28: 863, 29: 850, 31: 852, 34: 852, 35: 852, 36: 860, 37: 850, 38: 866, 55: 850, 64: 852, 77: 936, 78: 949, 79: 950, 80: 874, 87: 1252, 88: 1252, 89: 1252, 108: 863, 134: 737, 135: 852, 136: 857, 204: 1257, 255: 16969 }; var r = ir({ 1: 437, 2: 850, 3: 1252, 4: 1e4, 100: 852, 101: 866, 102: 865, 103: 861, 104: 895, 105: 620, 106: 737, 107: 857, 120: 950, 121: 949, 122: 936, 123: 932, 124: 874, 125: 1255, 126: 1256, 150: 10007, 151: 10029, 152: 10006, 200: 1250, 201: 1251, 202: 1254, 203: 1253, 0: 20127 }); function n(r, t) { var n = []; var s = C(1); switch (t.type) { case "base64": s = A(y(r)); break; case "binary": s = A(r); break; case "buffer": ; case "array": s = r; break; }pa(s, 0); var i = s._R(1); var l = !!(i & 136); var o = false, c = false; switch (i) { case 2: break; case 3: break; case 48: o = true; l = true; break; case 49: o = true; l = true; break; case 131: break; case 139: break; case 140: c = true; break; case 245: break; default: throw new Error("DBF Unsupported Version: " + i.toString(16)); }var f = 0, u = 521; if (i == 2) f = s._R(2); s.l += 3; if (i != 2) f = s._R(4); if (f > 1048576) f = 1e6; if (i != 2) u = s._R(2); var h = s._R(2); var d = t.codepage || 1252; if (i != 2) { s.l += 16; s._R(1); if (s[s.l] !== 0) d = e[s[s.l]]; s.l += 1; s.l += 2 } if (c) s.l += 36; var m = [], p = {}; var v = Math.min(s.length, i == 2 ? 521 : u - 10 - (o ? 264 : 0)); var g = c ? 32 : 11; while (s.l < v && s[s.l] != 13) { p = {}; p.name = a.utils.decode(d, s.slice(s.l, s.l + g)).replace(/[\u0000\r\n].*$/g, ""); s.l += g; p.type = String.fromCharCode(s._R(1)); if (i != 2 && !c) p.offset = s._R(4); p.len = s._R(1); if (i == 2) p.offset = s._R(2); p.dec = s._R(1); if (p.name.length) m.push(p); if (i != 2) s.l += c ? 13 : 14; switch (p.type) { case "B": if ((!o || p.len != 8) && t.WTF) console.log("Skipping " + p.name + ":" + p.type); break; case "G": ; case "P": if (t.WTF) console.log("Skipping " + p.name + ":" + p.type); break; case "+": ; case "0": ; case "@": ; case "C": ; case "D": ; case "F": ; case "I": ; case "L": ; case "M": ; case "N": ; case "O": ; case "T": ; case "Y": break; default: throw new Error("Unknown Field Type: " + p.type); } } if (s[s.l] !== 13) s.l = u - 1; if (s._R(1) !== 13) throw new Error("DBF Terminator not found " + s.l + " " + s[s.l]); s.l = u; var b = 0, w = 0; n[0] = []; for (w = 0; w != m.length; ++w)n[0][w] = m[w].name; while (f-- > 0) { if (s[s.l] === 42) { s.l += h; continue } ++s.l; n[++b] = []; w = 0; for (w = 0; w != m.length; ++w) { var k = s.slice(s.l, s.l + m[w].len); s.l += m[w].len; pa(k, 0); var x = a.utils.decode(d, k); switch (m[w].type) { case "C": if (x.trim().length) n[b][w] = x.replace(/\s+$/, ""); break; case "D": if (x.length === 8) n[b][w] = new Date(+x.slice(0, 4), +x.slice(4, 6) - 1, +x.slice(6, 8)); else n[b][w] = x; break; case "F": n[b][w] = parseFloat(x.trim()); break; case "+": ; case "I": n[b][w] = c ? k._R(-4, "i") ^ 2147483648 : k._R(4, "i"); break; case "L": switch (x.trim().toUpperCase()) { case "Y": ; case "T": n[b][w] = true; break; case "N": ; case "F": n[b][w] = false; break; case "": ; case "?": break; default: throw new Error("DBF Unrecognized L:|" + x + "|"); }break; case "M": if (!l) throw new Error("DBF Unexpected MEMO for type " + i.toString(16)); n[b][w] = "##MEMO##" + (c ? parseInt(x.trim(), 10) : k._R(4)); break; case "N": x = x.replace(/\u0000/g, "").trim(); if (x && x != ".") n[b][w] = +x || 0; break; case "@": n[b][w] = new Date(k._R(-8, "f") - 621356832e5); break; case "T": n[b][w] = new Date((k._R(4) - 2440588) * 864e5 + k._R(4)); break; case "Y": n[b][w] = k._R(4, "i") / 1e4 + k._R(4, "i") / 1e4 * Math.pow(2, 32); break; case "O": n[b][w] = -k._R(-8, "f"); break; case "B": if (o && m[w].len == 8) { n[b][w] = k._R(8, "f"); break }; case "G": ; case "P": k.l += m[w].len; break; case "0": if (m[w].name === "_NullFlags") break; default: throw new Error("DBF Unsupported data type " + m[w].type); } } } if (i != 2) if (s.l < s.length && s[s.l++] != 26) throw new Error("DBF EOF Marker missing " + (s.l - 1) + " of " + s.length + " " + s[s.l - 1].toString(16)); if (t && t.sheetRows) n = n.slice(0, t.sheetRows); t.DBF = m; return n } function s(e, r) { var t = r || {}; if (!t.dateNF) t.dateNF = "yyyymmdd"; var a = Va(n(e, t), t); a["!cols"] = t.DBF.map(function (e) { return { wch: e.len, DBF: e } }); delete t.DBF; return a } function i(e, r) { try { return ja(s(e, r), r) } catch (t) { if (r && r.WTF) throw t } return { SheetNames: [], Sheets: {} } } var l = { B: 8, C: 250, L: 1, D: 8, "?": 0, "": 0 }; function c(e, a) { var n = a || {}; if (+n.codepage >= 0) o(+n.codepage); if (n.type == "string") throw new Error("Cannot write DBF to JS string"); var s = wa(); var i = tc(e, { header: 1, raw: true, cellDates: true }); var c = i[0], f = i.slice(1), u = e["!cols"] || []; var h = 0, d = 0, m = 0, p = 1; for (h = 0; h < c.length; ++h) { if (((u[h] || {}).DBF || {}).name) { c[h] = u[h].DBF.name; ++m; continue } if (c[h] == null) continue; ++m; if (typeof c[h] === "number") c[h] = c[h].toString(10); if (typeof c[h] !== "string") throw new Error("DBF Invalid column name " + c[h] + " |" + typeof c[h] + "|"); if (c.indexOf(c[h]) !== h) for (d = 0; d < 1024; ++d)if (c.indexOf(c[h] + "_" + d) == -1) { c[h] += "_" + d; break } } var v = $a(e["!ref"]); var g = []; var b = []; var w = []; for (h = 0; h <= v.e.c - v.s.c; ++h) { var k = "", y = "", x = 0; var S = []; for (d = 0; d < f.length; ++d) { if (f[d][h] != null) S.push(f[d][h]) } if (S.length == 0 || c[h] == null) { g[h] = "?"; continue } for (d = 0; d < S.length; ++d) { switch (typeof S[d]) { case "number": y = "B"; break; case "string": y = "C"; break; case "boolean": y = "L"; break; case "object": y = S[d] instanceof Date ? "D" : "C"; break; default: y = "C"; }x = Math.max(x, String(S[d]).length); k = k && k != y ? "C" : y } if (x > 250) x = 250; y = ((u[h] || {}).DBF || {}).type; if (y == "C") { if (u[h].DBF.len > x) x = u[h].DBF.len } if (k == "B" && y == "N") { k = "N"; w[h] = u[h].DBF.dec; x = u[h].DBF.len } b[h] = k == "C" || y == "N" ? x : l[k] || 0; p += b[h]; g[h] = k } var C = s.next(32); C._W(4, 318902576); C._W(4, f.length); C._W(2, 296 + 32 * m); C._W(2, p); for (h = 0; h < 4; ++h)C._W(4, 0); C._W(4, 0 | (+r[t] || 3) << 8); for (h = 0, d = 0; h < c.length; ++h) { if (c[h] == null) continue; var _ = s.next(32); var A = (c[h].slice(-10) + "\0\0\0\0\0\0\0\0\0\0\0").slice(0, 11); _._W(1, A, "sbcs"); _._W(1, g[h] == "?" ? "C" : g[h], "sbcs"); _._W(4, d); _._W(1, b[h] || l[g[h]] || 0); _._W(1, w[h] || 0); _._W(1, 2); _._W(4, 0); _._W(1, 0); _._W(4, 0); _._W(4, 0); d += b[h] || l[g[h]] || 0 } var F = s.next(264); F._W(4, 13); for (h = 0; h < 65; ++h)F._W(4, 0); for (h = 0; h < f.length; ++h) { var E = s.next(p); E._W(1, 0); for (d = 0; d < c.length; ++d) { if (c[d] == null) continue; switch (g[d]) { case "L": E._W(1, f[h][d] == null ? 63 : f[h][d] ? 84 : 70); break; case "B": E._W(8, f[h][d] || 0, "f"); break; case "N": var T = "0"; if (typeof f[h][d] == "number") T = f[h][d].toFixed(w[d] || 0); for (m = 0; m < b[d] - T.length; ++m)E._W(1, 32); E._W(1, T, "sbcs"); break; case "D": if (!f[h][d]) E._W(8, "00000000", "sbcs"); else { E._W(4, ("0000" + f[h][d].getFullYear()).slice(-4), "sbcs"); E._W(2, ("00" + (f[h][d].getMonth() + 1)).slice(-2), "sbcs"); E._W(2, ("00" + f[h][d].getDate()).slice(-2), "sbcs") } break; case "C": var D = String(f[h][d] != null ? f[h][d] : "").slice(0, b[d]); E._W(1, D, "sbcs"); for (m = 0; m < b[d] - D.length; ++m)E._W(1, 32); break; } } } s.next(1)._W(1, 26); return s.end() } return { to_workbook: i, to_sheet: s, from_sheet: c } }(); var Yn = function () { var e = { AA: "À", BA: "Á", CA: "Â", DA: 195, HA: "Ä", JA: 197, AE: "È", BE: "É", CE: "Ê", HE: "Ë", AI: "Ì", BI: "Í", CI: "Î", HI: "Ï", AO: "Ò", BO: "Ó", CO: "Ô", DO: 213, HO: "Ö", AU: "Ù", BU: "Ú", CU: "Û", HU: "Ü", Aa: "à", Ba: "á", Ca: "â", Da: 227, Ha: "ä", Ja: 229, Ae: "è", Be: "é", Ce: "ê", He: "ë", Ai: "ì", Bi: "í", Ci: "î", Hi: "ï", Ao: "ò", Bo: "ó", Co: "ô", Do: 245, Ho: "ö", Au: "ù", Bu: "ú", Cu: "û", Hu: "ü", KC: "Ç", Kc: "ç", q: "æ", z: "œ", a: "Æ", j: "Œ", DN: 209, Dn: 241, Hy: 255, S: 169, c: 170, R: 174, "B ": 180, 0: 176, 1: 177, 2: 178, 3: 179, 5: 181, 6: 182, 7: 183, Q: 185, k: 186, b: 208, i: 216, l: 222, s: 240, y: 248, "!": 161, '"': 162, "#": 163, "(": 164, "%": 165, "'": 167, "H ": 168, "+": 171, ";": 187, "<": 188, "=": 189, ">": 190, "?": 191, "{": 223 }; var r = new RegExp("N(" + nr(e).join("|").replace(/\|\|\|/, "|\\||").replace(/([?()+])/g, "\\$1") + "|\\|)", "gm"); var t = function (r, t) { var a = e[t]; return typeof a == "number" ? p(a) : a }; var n = function (e, r, t) { var a = r.charCodeAt(0) - 32 << 4 | t.charCodeAt(0) - 48; return a == 59 ? e : p(a) }; e["|"] = 254; function s(e, r) { switch (r.type) { case "base64": return i(y(e), r); case "binary": return i(e, r); case "buffer": return i(x && Buffer.isBuffer(e) ? e.toString("binary") : E(e), r); case "array": return i(kr(e), r); }throw new Error("Unrecognized type " + r.type) } function i(e, s) { var i = e.split(/[\n\r]+/), l = -1, c = -1, f = 0, u = 0, h = []; var d = []; var m = null; var p = {}, v = [], g = [], b = []; var w = 0, k; var y = { Workbook: { WBProps: {}, Names: [] } }; if (+s.codepage >= 0) o(+s.codepage); for (; f !== i.length; ++f) { w = 0; var x = i[f].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g, n).replace(r, t); var S = x.replace(/;;/g, "\0").split(";").map(function (e) { return e.replace(/\u0000/g, ";") }); var C = S[0], _; if (x.length > 0) switch (C) { case "ID": break; case "E": break; case "B": break; case "O": for (u = 1; u < S.length; ++u)switch (S[u].charAt(0)) { case "V": { var A = parseInt(S[u].slice(1), 10); if (A >= 1 && A <= 4) y.Workbook.WBProps.date1904 = true } break; }break; case "W": break; case "P": switch (S[1].charAt(0)) { case "P": d.push(x.slice(3).replace(/;;/g, ";")); break; }break; case "NN": { var F = { Sheet: 0 }; for (u = 1; u < S.length; ++u)switch (S[u].charAt(0)) { case "N": F.Name = S[u].slice(1); break; case "E": F.Ref = (s && s.sheet || "Sheet1") + "!" + xi(S[u].slice(1)); break; }y.Workbook.Names.push(F) } break; case "C": var E = false, T = false, D = false, O = false, M = -1, N = -1, P = "", I = "z"; for (u = 1; u < S.length; ++u)switch (S[u].charAt(0)) { case "A": break; case "X": c = parseInt(S[u].slice(1), 10) - 1; T = true; break; case "Y": l = parseInt(S[u].slice(1), 10) - 1; if (!T) c = 0; for (k = h.length; k <= l; ++k)h[k] = []; break; case "K": _ = S[u].slice(1); if (_.charAt(0) === '"') { _ = _.slice(1, _.length - 1); I = "s" } else if (_ === "TRUE" || _ === "FALSE") { _ = _ === "TRUE"; I = "b" } else if (!isNaN(Sr(_))) { _ = Sr(_); I = "n"; if (m !== null && Ie(m) && s.cellDates) { _ = mr(y.Workbook.WBProps.date1904 ? _ + 1462 : _); I = "d" } } else if (!isNaN(Fr(_).getDate())) { _ = wr(_); I = "d"; if (!s.cellDates) { I = "n"; _ = fr(_, y.Workbook.WBProps.date1904) } } if (typeof a !== "undefined" && typeof _ == "string" && (s || {}).type != "string" && (s || {}).codepage) _ = a.utils.decode(s.codepage, _); E = true; break; case "E": O = true; P = xi(S[u].slice(1), { r: l, c: c }); break; case "S": D = true; break; case "G": break; case "R": M = parseInt(S[u].slice(1), 10) - 1; break; case "C": N = parseInt(S[u].slice(1), 10) - 1; break; default: if (s && s.WTF) throw new Error("SYLK bad record " + x); }if (E) { if (!h[l][c]) h[l][c] = { t: I, v: _ }; else { h[l][c].t = I; h[l][c].v = _ } if (m) h[l][c].z = m; if (s.cellText !== false && m) h[l][c].w = $e(h[l][c].z, h[l][c].v, { date1904: y.Workbook.WBProps.date1904 }); m = null } if (D) { if (O) throw new Error("SYLK shared formula cannot have own formula"); var R = M > -1 && h[M][N]; if (!R || !R[1]) throw new Error("SYLK shared formula cannot find base"); P = _i(R[1], { r: l - M, c: c - N }) } if (P) { if (!h[l][c]) h[l][c] = { t: "n", f: P }; else h[l][c].f = P } break; case "F": var L = 0; for (u = 1; u < S.length; ++u)switch (S[u].charAt(0)) { case "X": c = parseInt(S[u].slice(1), 10) - 1; ++L; break; case "Y": l = parseInt(S[u].slice(1), 10) - 1; for (k = h.length; k <= l; ++k)h[k] = []; break; case "M": w = parseInt(S[u].slice(1), 10) / 20; break; case "F": break; case "G": break; case "P": m = d[parseInt(S[u].slice(1), 10)]; break; case "S": break; case "D": break; case "N": break; case "W": b = S[u].slice(1).split(" "); for (k = parseInt(b[0], 10); k <= parseInt(b[1], 10); ++k) { w = parseInt(b[2], 10); g[k - 1] = w === 0 ? { hidden: true } : { wch: w } } break; case "C": c = parseInt(S[u].slice(1), 10) - 1; if (!g[c]) g[c] = {}; break; case "R": l = parseInt(S[u].slice(1), 10) - 1; if (!v[l]) v[l] = {}; if (w > 0) { v[l].hpt = w; v[l].hpx = Ds(w) } else if (w === 0) v[l].hidden = true; break; default: if (s && s.WTF) throw new Error("SYLK bad record " + x); }if (L < 1) m = null; break; default: if (s && s.WTF) throw new Error("SYLK bad record " + x); } } if (v.length > 0) p["!rows"] = v; if (g.length > 0) p["!cols"] = g; g.forEach(function (e) { As(e) }); if (s && s.sheetRows) h = h.slice(0, s.sheetRows); return [h, p, y] } function l(e, r) { var t = s(e, r); var a = t[0], n = t[1], i = t[2]; var l = yr(r); l.date1904 = (((i || {}).Workbook || {}).WBProps || {}).date1904; var o = Va(a, l); nr(n).forEach(function (e) { o[e] = n[e] }); var c = ja(o, r); nr(i).forEach(function (e) { c[e] = i[e] }); return c } function c(e, r, t, a) { var n = "C;Y" + (t + 1) + ";X" + (a + 1) + ";K"; switch (e.t) { case "n": n += e.v || 0; if (e.f && !e.F) n += ";E" + Ci(e.f, { r: t, c: a }); break; case "b": n += e.v ? "TRUE" : "FALSE"; break; case "e": n += e.w || e.v; break; case "d": n += '"' + (e.w || e.v) + '"'; break; case "s": n += '"' + e.v.replace(/"/g, "").replace(/;/g, ";;") + '"'; break; }return n } function f(e, r) { r.forEach(function (r, t) { var a = "F;W" + (t + 1) + " " + (t + 1) + " "; if (r.hidden) a += "0"; else { if (typeof r.width == "number" && !r.wpx) r.wpx = ys(r.width); if (typeof r.wpx == "number" && !r.wch) r.wch = xs(r.wpx); if (typeof r.wch == "number") a += Math.round(r.wch) } if (a.charAt(a.length - 1) != " ") e.push(a) }) } function u(e, r) { r.forEach(function (r, t) { var a = "F;"; if (r.hidden) a += "M0;"; else if (r.hpt) a += "M" + 20 * r.hpt + ";"; else if (r.hpx) a += "M" + 20 * Ts(r.hpx) + ";"; if (a.length > 2) e.push(a + "R" + (t + 1)) }) } function h(e, r, t) { var a = ["ID;PSheetJS;N;E"], n = []; var s = $a(e["!ref"]), i; var l = Array.isArray(e); var o = "\r\n"; var h = (((t || {}).Workbook || {}).WBProps || {}).date1904; a.push("P;PGeneral"); a.push("F;P0;DG0G8;M255"); if (e["!cols"]) f(a, e["!cols"]); if (e["!rows"]) u(a, e["!rows"]); a.push("B;Y" + (s.e.r - s.s.r + 1) + ";X" + (s.e.c - s.s.c + 1) + ";D" + [s.s.c, s.s.r, s.e.c, s.e.r].join(" ")); a.push("O;L;D;B" + (h ? ";V4" : "") + ";K47;G100 0.001"); for (var d = s.s.r; d <= s.e.r; ++d) { for (var m = s.s.c; m <= s.e.c; ++m) { var p = Ia({ r: d, c: m }); i = l ? (e[d] || [])[m] : e[p]; if (!i || i.v == null && (!i.f || i.F)) continue; n.push(c(i, e, d, m, r)) } } return a.join(o) + o + n.join(o) + o + "E" + o } return { to_workbook: l, from_sheet: h } }(); var Jn = function () {
        function e(e, t) {
            switch (t.type) {
                case "base64": return r(y(e), t); case "binary": return r(e, t); case "buffer": return r(x && Buffer.isBuffer(e) ? e.toString("binary") : E(e), t); case "array": return r(kr(e), t);
            }throw new Error("Unrecognized type " + t.type)
        } function r(e, r) { var t = e.split("\n"), a = -1, n = -1, s = 0, i = []; for (; s !== t.length; ++s) { if (t[s].trim() === "BOT") { i[++a] = []; n = 0; continue } if (a < 0) continue; var l = t[s].trim().split(","); var o = l[0], c = l[1]; ++s; var f = t[s] || ""; while ((f.match(/["]/g) || []).length & 1 && s < t.length - 1) f += "\n" + t[++s]; f = f.trim(); switch (+o) { case -1: if (f === "BOT") { i[++a] = []; n = 0; continue } else if (f !== "EOD") throw new Error("Unrecognized DIF special command " + f); break; case 0: if (f === "TRUE") i[a][n] = true; else if (f === "FALSE") i[a][n] = false; else if (!isNaN(Sr(c))) i[a][n] = Sr(c); else if (!isNaN(Fr(c).getDate())) i[a][n] = wr(c); else i[a][n] = c; ++n; break; case 1: f = f.slice(1, f.length - 1); f = f.replace(/""/g, '"'); if (b && f && f.match(/^=".*"$/)) f = f.slice(2, -1); i[a][n++] = f !== "" ? f : null; break; }if (f === "EOD") break } if (r && r.sheetRows) i = i.slice(0, r.sheetRows); return i } function t(r, t) { return Va(e(r, t), t) } function a(e, r) { return ja(t(e, r), r) } var n = function () { var e = function t(e, r, a, n, s) { e.push(r); e.push(a + "," + n); e.push('"' + s.replace(/"/g, '""') + '"') }; var r = function a(e, r, t, n) { e.push(r + "," + t); e.push(r == 1 ? '"' + n.replace(/"/g, '""') + '"' : n) }; return function n(t) { var a = []; var n = $a(t["!ref"]), s; var i = Array.isArray(t); e(a, "TABLE", 0, 1, "sheetjs"); e(a, "VECTORS", 0, n.e.r - n.s.r + 1, ""); e(a, "TUPLES", 0, n.e.c - n.s.c + 1, ""); e(a, "DATA", 0, 0, ""); for (var l = n.s.r; l <= n.e.r; ++l) { r(a, -1, 0, "BOT"); for (var o = n.s.c; o <= n.e.c; ++o) { var c = Ia({ r: l, c: o }); s = i ? (t[l] || [])[o] : t[c]; if (!s) { r(a, 1, 0, ""); continue } switch (s.t) { case "n": var f = b ? s.w : s.v; if (!f && s.v != null) f = s.v; if (f == null) { if (b && s.f && !s.F) r(a, 1, 0, "=" + s.f); else r(a, 1, 0, "") } else r(a, 0, f, "V"); break; case "b": r(a, 0, s.v ? 1 : 0, s.v ? "TRUE" : "FALSE"); break; case "s": r(a, 1, 0, !b || isNaN(s.v) ? s.v : '="' + s.v + '"'); break; case "d": if (!s.w) s.w = $e(s.z || Y[14], fr(wr(s.v))); if (b) r(a, 0, s.w, "V"); else r(a, 1, 0, s.w); break; default: r(a, 1, 0, ""); } } } r(a, -1, 0, "EOD"); var u = "\r\n"; var h = a.join(u); return h } }(); return { to_workbook: a, to_sheet: t, from_sheet: n }
    }(); var Kn = function () { function e(e) { return e.replace(/\\b/g, "\\").replace(/\\c/g, ":").replace(/\\n/g, "\n") } function r(e) { return e.replace(/\\/g, "\\b").replace(/:/g, "\\c").replace(/\n/g, "\\n") } function t(r, t) { var a = r.split("\n"), n = -1, s = -1, i = 0, l = []; for (; i !== a.length; ++i) { var o = a[i].trim().split(":"); if (o[0] !== "cell") continue; var c = Pa(o[1]); if (l.length <= c.r) for (n = l.length; n <= c.r; ++n)if (!l[n]) l[n] = []; n = c.r; s = c.c; switch (o[2]) { case "t": l[n][s] = e(o[3]); break; case "v": l[n][s] = +o[3]; break; case "vtf": var f = o[o.length - 1]; case "vtc": switch (o[3]) { case "nl": l[n][s] = +o[4] ? true : false; break; default: l[n][s] = +o[4]; break; }if (o[2] == "vtf") l[n][s] = [l[n][s], f]; } } if (t && t.sheetRows) l = l.slice(0, t.sheetRows); return l } function a(e, r) { return Va(t(e, r), r) } function n(e, r) { return ja(a(e, r), r) } var s = ["socialcalc:version:1.5", "MIME-Version: 1.0", "Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"); var i = ["--SocialCalcSpreadsheetControlSave", "Content-type: text/plain; charset=UTF-8"].join("\n") + "\n"; var l = ["# SocialCalc Spreadsheet Control Save", "part:sheet"].join("\n"); var o = "--SocialCalcSpreadsheetControlSave--"; function c(e) { if (!e || !e["!ref"]) return ""; var t = [], a = [], n, s = ""; var i = Ra(e["!ref"]); var l = Array.isArray(e); for (var o = i.s.r; o <= i.e.r; ++o) { for (var c = i.s.c; c <= i.e.c; ++c) { s = Ia({ r: o, c: c }); n = l ? (e[o] || [])[c] : e[s]; if (!n || n.v == null || n.t === "z") continue; a = ["cell", s, "t"]; switch (n.t) { case "s": ; case "str": a.push(r(n.v)); break; case "n": if (!n.f) { a[2] = "v"; a[3] = n.v } else { a[2] = "vtf"; a[3] = "n"; a[4] = n.v; a[5] = r(n.f) } break; case "b": a[2] = "vt" + (n.f ? "f" : "c"); a[3] = "nl"; a[4] = n.v ? "1" : "0"; a[5] = r(n.f || (n.v ? "TRUE" : "FALSE")); break; case "d": var f = fr(wr(n.v)); a[2] = "vtc"; a[3] = "nd"; a[4] = "" + f; a[5] = n.w || $e(n.z || Y[14], f); break; case "e": continue; }t.push(a.join(":")) } } t.push("sheet:c:" + (i.e.c - i.s.c + 1) + ":r:" + (i.e.r - i.s.r + 1) + ":tvf:1"); t.push("valueformat:1:text-wiki"); return t.join("\n") } function f(e) { return [s, i, l, i, c(e), o].join("\n") } return { to_workbook: n, to_sheet: a, from_sheet: f } }(); var Zn = function () { function e(e, r, t, a, n) { if (n.raw) r[t][a] = e; else if (e === "") { } else if (e === "TRUE") r[t][a] = true; else if (e === "FALSE") r[t][a] = false; else if (!isNaN(Sr(e))) r[t][a] = Sr(e); else if (!isNaN(Fr(e).getDate())) r[t][a] = wr(e); else r[t][a] = e } function r(r, t) { var a = t || {}; var n = []; if (!r || r.length === 0) return n; var s = r.split(/[\r\n]/); var i = s.length - 1; while (i >= 0 && s[i].length === 0) --i; var l = 10, o = 0; var c = 0; for (; c <= i; ++c) { o = s[c].indexOf(" "); if (o == -1) o = s[c].length; else o++; l = Math.max(l, o) } for (c = 0; c <= i; ++c) { n[c] = []; var f = 0; e(s[c].slice(0, l).trim(), n, c, f, a); for (f = 1; f <= (s[c].length - l) / 10 + 1; ++f)e(s[c].slice(l + (f - 1) * 10, l + f * 10).trim(), n, c, f, a) } if (a.sheetRows) n = n.slice(0, a.sheetRows); return n } var t = { 44: ",", 9: "\t", 59: ";", 124: "|" }; var n = { 44: 3, 9: 2, 59: 1, 124: 0 }; function s(e) { var r = {}, a = false, s = 0, i = 0; for (; s < e.length; ++s) { if ((i = e.charCodeAt(s)) == 34) a = !a; else if (!a && i in t) r[i] = (r[i] || 0) + 1 } i = []; for (s in r) if (Object.prototype.hasOwnProperty.call(r, s)) { i.push([r[s], s]) } if (!i.length) { r = n; for (s in r) if (Object.prototype.hasOwnProperty.call(r, s)) { i.push([r[s], s]) } } i.sort(function (e, r) { return e[0] - r[0] || n[e[1]] - n[r[1]] }); return t[i.pop()[1]] || 44 } function i(e, r) { var t = r || {}; var a = ""; if (g != null && t.dense == null) t.dense = g; var n = t.dense ? [] : {}; var i = { s: { c: 0, r: 0 }, e: { c: 0, r: 0 } }; if (e.slice(0, 4) == "sep=") { if (e.charCodeAt(5) == 13 && e.charCodeAt(6) == 10) { a = e.charAt(4); e = e.slice(7) } else if (e.charCodeAt(5) == 13 || e.charCodeAt(5) == 10) { a = e.charAt(4); e = e.slice(6) } else a = s(e.slice(0, 1024)) } else if (t && t.FS) a = t.FS; else a = s(e.slice(0, 1024)); var l = 0, o = 0, c = 0; var f = 0, u = 0, h = a.charCodeAt(0), d = false, m = 0, p = e.charCodeAt(0); var v = t.dateNF != null ? Ge(t.dateNF) : null; function b() { var r = e.slice(f, u); if (r.slice(-1) == "\r") r = r.slice(0, -1); var a = {}; if (r.charAt(0) == '"' && r.charAt(r.length - 1) == '"') r = r.slice(1, -1).replace(/""/g, '"'); if (r.length === 0) a.t = "z"; else if (t.raw) { a.t = "s"; a.v = r } else if (r.trim().length === 0) { a.t = "s"; a.v = r } else if (r.charCodeAt(0) == 61) { if (r.charCodeAt(1) == 34 && r.charCodeAt(r.length - 1) == 34) { a.t = "s"; a.v = r.slice(2, -1).replace(/""/g, '"') } else if (Fi(r)) { a.t = "n"; a.f = r.slice(1) } else { a.t = "s"; a.v = r } } else if (r == "TRUE") { a.t = "b"; a.v = true } else if (r == "FALSE") { a.t = "b"; a.v = false } else if (!isNaN(c = Sr(r))) { a.t = "n"; if (t.cellText !== false) a.w = r; a.v = c } else if (!isNaN(Fr(r).getDate()) || v && r.match(v)) { a.z = t.dateNF || Y[14]; var s = 0; if (v && r.match(v)) { r = Ye(r, t.dateNF, r.match(v) || []); s = 1 } if (t.cellDates) { a.t = "d"; a.v = wr(r, s) } else { a.t = "n"; a.v = fr(wr(r, s)) } if (t.cellText !== false) a.w = $e(a.z, a.v instanceof Date ? fr(a.v) : a.v); if (!t.cellNF) delete a.z } else { a.t = "s"; a.v = r } if (a.t == "z") { } else if (t.dense) { if (!n[l]) n[l] = []; n[l][o] = a } else n[Ia({ c: o, r: l })] = a; f = u + 1; p = e.charCodeAt(f); if (i.e.c < o) i.e.c = o; if (i.e.r < l) i.e.r = l; if (m == h) ++o; else { o = 0; ++l; if (t.sheetRows && t.sheetRows <= l) return true } } e: for (; u < e.length; ++u)switch (m = e.charCodeAt(u)) { case 34: if (p === 34) d = !d; break; case 13: if (d) break; if (e.charCodeAt(u + 1) == 10) ++u; case h: ; case 10: if (!d && b()) break e; break; default: break; }if (u - f > 0) b(); n["!ref"] = La(i); return n } function l(e, t) { if (!(t && t.PRN)) return i(e, t); if (t.FS) return i(e, t); if (e.slice(0, 4) == "sep=") return i(e, t); if (e.indexOf("\t") >= 0 || e.indexOf(",") >= 0 || e.indexOf(";") >= 0) return i(e, t); return Va(r(e, t), t) } function o(e, r) { var t = "", n = r.type == "string" ? [0, 0, 0, 0] : Do(e, r); switch (r.type) { case "base64": t = y(e); break; case "binary": t = e; break; case "buffer": if (r.codepage == 65001) t = e.toString("utf8"); else if (r.codepage && typeof a !== "undefined") t = a.utils.decode(r.codepage, e); else t = x && Buffer.isBuffer(e) ? e.toString("binary") : E(e); break; case "array": t = kr(e); break; case "string": t = e; break; default: throw new Error("Unrecognized type " + r.type); }if (n[0] == 239 && n[1] == 187 && n[2] == 191) t = mt(t.slice(3)); else if (r.type != "string" && r.type != "buffer" && r.codepage == 65001) t = mt(t); else if (r.type == "binary" && typeof a !== "undefined" && r.codepage) t = a.utils.decode(r.codepage, a.utils.encode(28591, t)); if (t.slice(0, 19) == "socialcalc:version:") return Kn.to_sheet(r.type == "string" ? t : mt(t), r); return l(t, r) } function c(e, r) { return ja(o(e, r), r) } function f(e) { var r = []; var t = $a(e["!ref"]), a; var n = Array.isArray(e); for (var s = t.s.r; s <= t.e.r; ++s) { var i = []; for (var l = t.s.c; l <= t.e.c; ++l) { var o = Ia({ r: s, c: l }); a = n ? (e[s] || [])[l] : e[o]; if (!a || a.v == null) { i.push("          "); continue } var c = (a.w || (Ua(a), a.w) || "").slice(0, 10); while (c.length < 10) c += " "; i.push(c + (l === 0 ? " " : "")) } r.push(i.join("")) } return r.join("\n") } return { to_workbook: c, to_sheet: o, from_sheet: f } }(); function qn(e, r) { var t = r || {}, a = !!t.WTF; t.WTF = true; try { var n = Yn.to_workbook(e, t); t.WTF = a; return n } catch (s) { t.WTF = a; if (!s.message.match(/SYLK bad record ID/) && a) throw s; return Zn.to_workbook(e, r) } } function Qn(e) { var r = {}, t = e.match(Xr), a = 0; var n = false; if (t) for (; a != t.length; ++a) { var i = Jr(t[a]); switch (i[0].replace(/\w*:/g, "")) { case "<condense": break; case "<extend": break; case "<shadow": if (!i.val) break; case "<shadow>": ; case "<shadow/>": r.shadow = 1; break; case "</shadow>": break; case "<charset": if (i.val == "1") break; r.cp = s[parseInt(i.val, 10)]; break; case "<outline": if (!i.val) break; case "<outline>": ; case "<outline/>": r.outline = 1; break; case "</outline>": break; case "<rFont": r.name = i.val; break; case "<sz": r.sz = i.val; break; case "<strike": if (!i.val) break; case "<strike>": ; case "<strike/>": r.strike = 1; break; case "</strike>": break; case "<u": if (!i.val) break; switch (i.val) { case "double": r.uval = "double"; break; case "singleAccounting": r.uval = "single-accounting"; break; case "doubleAccounting": r.uval = "double-accounting"; break; }; case "<u>": ; case "<u/>": r.u = 1; break; case "</u>": break; case "<b": if (i.val == "0") break; case "<b>": ; case "<b/>": r.b = 1; break; case "</b>": break; case "<i": if (i.val == "0") break; case "<i>": ; case "<i/>": r.i = 1; break; case "</i>": break; case "<color": if (i.rgb) r.color = i.rgb.slice(2, 8); break; case "<color>": ; case "<color/>": ; case "</color>": break; case "<family": r.family = i.val; break; case "<family>": ; case "<family/>": ; case "</family>": break; case "<vertAlign": r.valign = i.val; break; case "<vertAlign>": ; case "<vertAlign/>": ; case "</vertAlign>": break; case "<scheme": break; case "<scheme>": ; case "<scheme/>": ; case "</scheme>": break; case "<extLst": ; case "<extLst>": ; case "</extLst>": break; case "<ext": n = true; break; case "</ext>": n = false; break; default: if (i[0].charCodeAt(1) !== 47 && !n) throw new Error("Unrecognized rich format " + i[0]); } } return r } var es = function () { var e = vt("t"), r = vt("rPr"); function t(t) { var a = t.match(e); if (!a) return { t: "s", v: "" }; var n = { t: "s", v: Qr(a[1]) }; var s = t.match(r); if (s) n.s = Qn(s[1]); return n } var a = /<(?:\w+:)?r>/g, n = /<\/(?:\w+:)?r>/; return function s(e) { return e.replace(a, "").split(n).map(t).filter(function (e) { return e.v }) } }(); var rs = function Bc() { var e = /(\r\n|\n)/g; function r(e, r, t) { var a = []; if (e.u) a.push("text-decoration: underline;"); if (e.uval) a.push("text-underline-style:" + e.uval + ";"); if (e.sz) a.push("font-size:" + e.sz + "pt;"); if (e.outline) a.push("text-effect: outline;"); if (e.shadow) a.push("text-shadow: auto;"); r.push('<span style="' + a.join("") + '">'); if (e.b) { r.push("<b>"); t.push("</b>") } if (e.i) { r.push("<i>"); t.push("</i>") } if (e.strike) { r.push("<s>"); t.push("</s>") } var n = e.valign || ""; if (n == "superscript" || n == "super") n = "sup"; else if (n == "subscript") n = "sub"; if (n != "") { r.push("<" + n + ">"); t.push("</" + n + ">") } t.push("</span>"); return e } function t(t) { var a = [[], t.v, []]; if (!t.v) return ""; if (t.s) r(t.s, a[0], a[2]); return a[0].join("") + a[1].replace(e, "<br/>") + a[2].join("") } return function a(e) { return e.map(t).join("") } }(); var ts = /<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g, as = /<(?:\w+:)?r>/; var ns = /<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g; function ss(e, r) { var t = r ? r.cellHTML : true; var a = {}; if (!e) return { t: "" }; if (e.match(/^\s*<(?:\w+:)?t[^>]*>/)) { a.t = Qr(mt(e.slice(e.indexOf(">") + 1).split(/<\/(?:\w+:)?t>/)[0] || ""), true); a.r = mt(e); if (t) a.h = st(a.t) } else if (e.match(as)) { a.r = mt(e); a.t = Qr(mt((e.replace(ns, "").match(ts) || []).join("").replace(Xr, "")), true); if (t) a.h = rs(es(a.r)) } return a } var is = /<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/; var ls = /<(?:\w+:)?(?:si|sstItem)>/g; var os = /<\/(?:\w+:)?(?:si|sstItem)>/; function cs(e, r) { var t = [], a = ""; if (!e) return t; var n = e.match(is); if (n) { a = n[2].replace(ls, "").split(os); for (var s = 0; s != a.length; ++s) { var i = ss(a[s].trim(), r); if (i != null) t[t.length] = i } n = Jr(n[1]); t.Count = n.count; t.Unique = n.uniqueCount } return t } var fs = /^\s|\s$|[\t\n\r]/; function us(e, r) { if (!r.bookSST) return ""; var t = [Ur]; t[t.length] = _t("sst", null, { xmlns: Ot[0], count: e.Count, uniqueCount: e.Unique }); for (var a = 0; a != e.length; ++a) { if (e[a] == null) continue; var n = e[a]; var s = "<si>"; if (n.r) s += n.r; else { s += "<t"; if (!n.t) n.t = ""; if (n.t.match(fs)) s += ' xml:space="preserve"'; s += ">" + tt(n.t) + "</t>" } s += "</si>"; t[t.length] = s } if (t.length > 2) { t[t.length] = "</sst>"; t[1] = t[1].replace("/>", ">") } return t.join("") } function hs(e) { var r = e.slice(e[0] === "#" ? 1 : 0).slice(0, 6); return [parseInt(r.slice(0, 2), 16), parseInt(r.slice(2, 4), 16), parseInt(r.slice(4, 6), 16)] } function ds(e) { for (var r = 0, t = 1; r != 3; ++r)t = t * 256 + (e[r] > 255 ? 255 : e[r] < 0 ? 0 : e[r]); return t.toString(16).toUpperCase().slice(1) } function ms(e) { var r = e[0] / 255, t = e[1] / 255, a = e[2] / 255; var n = Math.max(r, t, a), s = Math.min(r, t, a), i = n - s; if (i === 0) return [0, 0, r]; var l = 0, o = 0, c = n + s; o = i / (c > 1 ? 2 - c : c); switch (n) { case r: l = ((t - a) / i + 6) % 6; break; case t: l = (a - r) / i + 2; break; case a: l = (r - t) / i + 4; break; }return [l / 6, o, c / 2] } function ps(e) { var r = e[0], t = e[1], a = e[2]; var n = t * 2 * (a < .5 ? a : 1 - a), s = a - n / 2; var i = [s, s, s], l = 6 * r; var o; if (t !== 0) switch (l | 0) { case 0: ; case 6: o = n * l; i[0] += n; i[1] += o; break; case 1: o = n * (2 - l); i[0] += o; i[1] += n; break; case 2: o = n * (l - 2); i[1] += n; i[2] += o; break; case 3: o = n * (4 - l); i[1] += o; i[2] += n; break; case 4: o = n * (l - 4); i[2] += n; i[0] += o; break; case 5: o = n * (6 - l); i[2] += o; i[0] += n; break; }for (var c = 0; c != 3; ++c)i[c] = Math.round(i[c] * 255); return i } function vs(e, r) { if (r === 0) return e; var t = ms(hs(e)); if (r < 0) t[2] = t[2] * (1 + r); else t[2] = 1 - (1 - t[2]) * (1 - r); return ds(ps(t)) } var gs = 6, bs = 15, ws = 1, ks = gs; function ys(e) { return Math.floor((e + Math.round(128 / ks) / 256) * ks) } function xs(e) { return Math.floor((e - 5) / ks * 100 + .5) / 100 } function Ss(e) { return Math.round((e * ks + 5) / ks * 256) / 256 } function Cs(e) { return Ss(xs(ys(e))) } function _s(e) { var r = Math.abs(e - Cs(e)), t = ks; if (r > .005) for (ks = ws; ks < bs; ++ks)if (Math.abs(e - Cs(e)) <= r) { r = Math.abs(e - Cs(e)); t = ks } ks = t } function As(e) { if (e.width) { e.wpx = ys(e.width); e.wch = xs(e.wpx); e.MDW = ks } else if (e.wpx) { e.wch = xs(e.wpx); e.width = Ss(e.wch); e.MDW = ks } else if (typeof e.wch == "number") { e.width = Ss(e.wch); e.wpx = ys(e.width); e.MDW = ks } if (e.customWidth) delete e.customWidth } var Fs = 96, Es = Fs; function Ts(e) { return e * 96 / Es } function Ds(e) { return e * Es / 96 } var Os = { None: "none", Solid: "solid", Gray50: "mediumGray", Gray75: "darkGray", Gray25: "lightGray", HorzStripe: "darkHorizontal", VertStripe: "darkVertical", ReverseDiagStripe: "darkDown", DiagStripe: "darkUp", DiagCross: "darkGrid", ThickDiagCross: "darkTrellis", ThinHorzStripe: "lightHorizontal", ThinVertStripe: "lightVertical", ThinReverseDiagStripe: "lightDown", ThinHorzCross: "lightGrid" }; function Ms(e, r, t, a) { r.Borders = []; var n = {}; var s = false; (e[0].match(Xr) || []).forEach(function (e) { var t = Jr(e); switch (Kr(t[0])) { case "<borders": ; case "<borders>": ; case "</borders>": break; case "<border": ; case "<border>": ; case "<border/>": n = {}; if (t.diagonalUp) n.diagonalUp = ct(t.diagonalUp); if (t.diagonalDown) n.diagonalDown = ct(t.diagonalDown); r.Borders.push(n); break; case "</border>": break; case "<left/>": break; case "<left": ; case "<left>": break; case "</left>": break; case "<right/>": break; case "<right": ; case "<right>": break; case "</right>": break; case "<top/>": break; case "<top": ; case "<top>": break; case "</top>": break; case "<bottom/>": break; case "<bottom": ; case "<bottom>": break; case "</bottom>": break; case "<diagonal": ; case "<diagonal>": ; case "<diagonal/>": break; case "</diagonal>": break; case "<horizontal": ; case "<horizontal>": ; case "<horizontal/>": break; case "</horizontal>": break; case "<vertical": ; case "<vertical>": ; case "<vertical/>": break; case "</vertical>": break; case "<start": ; case "<start>": ; case "<start/>": break; case "</start>": break; case "<end": ; case "<end>": ; case "<end/>": break; case "</end>": break; case "<color": ; case "<color>": break; case "<color/>": ; case "</color>": break; case "<extLst": ; case "<extLst>": ; case "</extLst>": break; case "<ext": s = true; break; case "</ext>": s = false; break; default: if (a && a.WTF) { if (!s) throw new Error("unrecognized " + t[0] + " in borders") }; } }) } function Ns(e, r, t, a) { r.Fills = []; var n = {}; var s = false; (e[0].match(Xr) || []).forEach(function (e) { var t = Jr(e); switch (Kr(t[0])) { case "<fills": ; case "<fills>": ; case "</fills>": break; case "<fill>": ; case "<fill": ; case "<fill/>": n = {}; r.Fills.push(n); break; case "</fill>": break; case "<gradientFill>": break; case "<gradientFill": ; case "</gradientFill>": r.Fills.push(n); n = {}; break; case "<patternFill": ; case "<patternFill>": if (t.patternType) n.patternType = t.patternType; break; case "<patternFill/>": ; case "</patternFill>": break; case "<bgColor": if (!n.bgColor) n.bgColor = {}; if (t.indexed) n.bgColor.indexed = parseInt(t.indexed, 10); if (t.theme) n.bgColor.theme = parseInt(t.theme, 10); if (t.tint) n.bgColor.tint = parseFloat(t.tint); if (t.rgb) n.bgColor.rgb = t.rgb.slice(-6); break; case "<bgColor/>": ; case "</bgColor>": break; case "<fgColor": if (!n.fgColor) n.fgColor = {}; if (t.theme) n.fgColor.theme = parseInt(t.theme, 10); if (t.tint) n.fgColor.tint = parseFloat(t.tint); if (t.rgb != null) n.fgColor.rgb = t.rgb.slice(-6); break; case "<fgColor/>": ; case "</fgColor>": break; case "<stop": ; case "<stop/>": break; case "</stop>": break; case "<color": ; case "<color/>": break; case "</color>": break; case "<extLst": ; case "<extLst>": ; case "</extLst>": break; case "<ext": s = true; break; case "</ext>": s = false; break; default: if (a && a.WTF) { if (!s) throw new Error("unrecognized " + t[0] + " in fills") }; } }) } function Ps(e, r, t, a) { r.Fonts = []; var n = {}; var i = false; (e[0].match(Xr) || []).forEach(function (e) { var l = Jr(e); switch (Kr(l[0])) { case "<fonts": ; case "<fonts>": ; case "</fonts>": break; case "<font": ; case "<font>": break; case "</font>": ; case "<font/>": r.Fonts.push(n); n = {}; break; case "<name": if (l.val) n.name = mt(l.val); break; case "<name/>": ; case "</name>": break; case "<b": n.bold = l.val ? ct(l.val) : 1; break; case "<b/>": n.bold = 1; break; case "<i": n.italic = l.val ? ct(l.val) : 1; break; case "<i/>": n.italic = 1; break; case "<u": switch (l.val) { case "none": n.underline = 0; break; case "single": n.underline = 1; break; case "double": n.underline = 2; break; case "singleAccounting": n.underline = 33; break; case "doubleAccounting": n.underline = 34; break; }break; case "<u/>": n.underline = 1; break; case "<strike": n.strike = l.val ? ct(l.val) : 1; break; case "<strike/>": n.strike = 1; break; case "<outline": n.outline = l.val ? ct(l.val) : 1; break; case "<outline/>": n.outline = 1; break; case "<shadow": n.shadow = l.val ? ct(l.val) : 1; break; case "<shadow/>": n.shadow = 1; break; case "<condense": n.condense = l.val ? ct(l.val) : 1; break; case "<condense/>": n.condense = 1; break; case "<extend": n.extend = l.val ? ct(l.val) : 1; break; case "<extend/>": n.extend = 1; break; case "<sz": if (l.val) n.sz = +l.val; break; case "<sz/>": ; case "</sz>": break; case "<vertAlign": if (l.val) n.vertAlign = l.val; break; case "<vertAlign/>": ; case "</vertAlign>": break; case "<family": if (l.val) n.family = parseInt(l.val, 10); break; case "<family/>": ; case "</family>": break; case "<scheme": if (l.val) n.scheme = l.val; break; case "<scheme/>": ; case "</scheme>": break; case "<charset": if (l.val == "1") break; l.codepage = s[parseInt(l.val, 10)]; break; case "<color": if (!n.color) n.color = {}; if (l.auto) n.color.auto = ct(l.auto); if (l.rgb) n.color.rgb = l.rgb.slice(-6); else if (l.indexed) { n.color.index = parseInt(l.indexed, 10); var o = hn[n.color.index]; if (n.color.index == 81) o = hn[1]; if (!o) o = hn[1]; n.color.rgb = o[0].toString(16) + o[1].toString(16) + o[2].toString(16) } else if (l.theme) { n.color.theme = parseInt(l.theme, 10); if (l.tint) n.color.tint = parseFloat(l.tint); if (l.theme && t.themeElements && t.themeElements.clrScheme) { n.color.rgb = vs(t.themeElements.clrScheme[n.color.theme].rgb, n.color.tint || 0) } } break; case "<color/>": ; case "</color>": break; case "<AlternateContent": i = true; break; case "</AlternateContent>": i = false; break; case "<extLst": ; case "<extLst>": ; case "</extLst>": break; case "<ext": i = true; break; case "</ext>": i = false; break; default: if (a && a.WTF) { if (!i) throw new Error("unrecognized " + l[0] + " in fonts") }; } }) } function Is(e, r, t) { r.NumberFmt = []; var a = nr(Y); for (var n = 0; n < a.length; ++n)r.NumberFmt[a[n]] = Y[a[n]]; var s = e[0].match(Xr); if (!s) return; for (n = 0; n < s.length; ++n) { var i = Jr(s[n]); switch (Kr(i[0])) { case "<numFmts": ; case "</numFmts>": ; case "<numFmts/>": ; case "<numFmts>": break; case "<numFmt": { var l = Qr(mt(i.formatCode)), o = parseInt(i.numFmtId, 10); r.NumberFmt[o] = l; if (o > 0) { if (o > 392) { for (o = 392; o > 60; --o)if (r.NumberFmt[o] == null) break; r.NumberFmt[o] = l } Ke(l, o) } } break; case "</numFmt>": break; default: if (t.WTF) throw new Error("unrecognized " + i[0] + " in numFmts"); } } } function Rs(e) { var r = ["<numFmts>"];[[5, 8], [23, 26], [41, 44], [50, 392]].forEach(function (t) { for (var a = t[0]; a <= t[1]; ++a)if (e[a] != null) r[r.length] = _t("numFmt", null, { numFmtId: a, formatCode: tt(e[a]) }) }); if (r.length === 1) return ""; r[r.length] = "</numFmts>"; r[0] = _t("numFmts", null, { count: r.length - 2 }).replace("/>", ">"); return r.join("") } var Ls = ["numFmtId", "fillId", "fontId", "borderId", "xfId"]; var Bs = ["applyAlignment", "applyBorder", "applyFill", "applyFont", "applyNumberFormat", "applyProtection", "pivotButton", "quotePrefix"]; function zs(e, r, t) { r.CellXf = []; var a; var n = false; (e[0].match(Xr) || []).forEach(function (e) { var s = Jr(e), i = 0; switch (Kr(s[0])) { case "<cellXfs": ; case "<cellXfs>": ; case "<cellXfs/>": ; case "</cellXfs>": break; case "<xf": ; case "<xf/>": a = s; delete a[0]; for (i = 0; i < Ls.length; ++i)if (a[Ls[i]]) a[Ls[i]] = parseInt(a[Ls[i]], 10); for (i = 0; i < Bs.length; ++i)if (a[Bs[i]]) a[Bs[i]] = ct(a[Bs[i]]); if (r.NumberFmt && a.numFmtId > 392) { for (i = 392; i > 60; --i)if (r.NumberFmt[a.numFmtId] == r.NumberFmt[i]) { a.numFmtId = i; break } } r.CellXf.push(a); break; case "</xf>": break; case "<alignment": ; case "<alignment/>": var l = {}; if (s.vertical) l.vertical = s.vertical; if (s.horizontal) l.horizontal = s.horizontal; if (s.textRotation != null) l.textRotation = s.textRotation; if (s.indent) l.indent = s.indent; if (s.wrapText) l.wrapText = ct(s.wrapText); a.alignment = l; break; case "</alignment>": break; case "<protection": break; case "</protection>": ; case "<protection/>": break; case "<AlternateContent": n = true; break; case "</AlternateContent>": n = false; break; case "<extLst": ; case "<extLst>": ; case "</extLst>": break; case "<ext": n = true; break; case "</ext>": n = false; break; default: if (t && t.WTF) { if (!n) throw new Error("unrecognized " + s[0] + " in cellXfs") }; } }) } function $s(e) { var r = []; r[r.length] = _t("cellXfs", null); e.forEach(function (e) { r[r.length] = _t("xf", null, e) }); r[r.length] = "</cellXfs>"; if (r.length === 2) return ""; r[0] = _t("cellXfs", null, { count: r.length - 2 }).replace("/>", ">"); return r.join("") } var Ws = function zc() { var e = /<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/; var r = /<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/; var t = /<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/; var a = /<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/; var n = /<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/; return function s(i, l, o) { var c = {}; if (!i) return c; i = i.replace(/<!--([\s\S]*?)-->/gm, "").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm, ""); var f; if (f = i.match(e)) Is(f, c, o); if (f = i.match(a)) Ps(f, c, l, o); if (f = i.match(t)) Ns(f, c, l, o); if (f = i.match(n)) Ms(f, c, l, o); if (f = i.match(r)) zs(f, c, o); return c } }(); function Us(e, r) { var t = [Ur, _t("styleSheet", null, { xmlns: Ot[0], "xmlns:vt": Dt.vt })], a; if (e.SSF && (a = Rs(e.SSF)) != null) t[t.length] = a; t[t.length] = '<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>'; t[t.length] = '<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>'; t[t.length] = '<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>'; t[t.length] = '<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>'; if (a = $s(r.cellXfs)) t[t.length] = a; t[t.length] = '<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>'; t[t.length] = '<dxfs count="0"/>'; t[t.length] = '<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>'; if (t.length > 2) { t[t.length] = "</styleSheet>"; t[1] = t[1].replace("/>", ">") } return t.join("") } var js = ["</a:lt1>", "</a:dk1>", "</a:lt2>", "</a:dk2>", "</a:accent1>", "</a:accent2>", "</a:accent3>", "</a:accent4>", "</a:accent5>", "</a:accent6>", "</a:hlink>", "</a:folHlink>"]; function Hs(e, r, t) { r.themeElements.clrScheme = []; var a = {}; (e[0].match(Xr) || []).forEach(function (e) { var n = Jr(e); switch (n[0]) { case "<a:clrScheme": ; case "</a:clrScheme>": break; case "<a:srgbClr": a.rgb = n.val; break; case "<a:sysClr": a.rgb = n.lastClr; break; case "<a:dk1>": ; case "</a:dk1>": ; case "<a:lt1>": ; case "</a:lt1>": ; case "<a:dk2>": ; case "</a:dk2>": ; case "<a:lt2>": ; case "</a:lt2>": ; case "<a:accent1>": ; case "</a:accent1>": ; case "<a:accent2>": ; case "</a:accent2>": ; case "<a:accent3>": ; case "</a:accent3>": ; case "<a:accent4>": ; case "</a:accent4>": ; case "<a:accent5>": ; case "</a:accent5>": ; case "<a:accent6>": ; case "</a:accent6>": ; case "<a:hlink>": ; case "</a:hlink>": ; case "<a:folHlink>": ; case "</a:folHlink>": if (n[0].charAt(1) === "/") { r.themeElements.clrScheme[js.indexOf(n[0])] = a; a = {} } else { a.name = n[0].slice(3, n[0].length - 1) } break; default: if (t && t.WTF) throw new Error("Unrecognized " + n[0] + " in clrScheme"); } }) } function Vs() { } function Xs() { } var Gs = /<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/; var Ys = /<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/; var Js = /<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/; function Ks(e, r, t) { r.themeElements = {}; var a;[["clrScheme", Gs, Hs], ["fontScheme", Ys, Vs], ["fmtScheme", Js, Xs]].forEach(function (n) { if (!(a = e.match(n[1]))) throw new Error(n[0] + " not found in themeElements"); n[2](a, r, t) }) } var Zs = /<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/; function qs(e, r) { if (!e || e.length === 0) e = Qs(); var t; var a = {}; if (!(t = e.match(Zs))) throw new Error("themeElements not found in theme"); Ks(t[0], a, r); a.raw = e; return a } function Qs(e, r) {
        if (r && r.themeXLSX) return r.themeXLSX; if (e && typeof e.raw == "string") return e.raw; var t = [Ur]; t[t.length] = '<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">'; t[t.length] = "<a:themeElements>"; t[t.length] = '<a:clrScheme name="Office">'; t[t.length] = '<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>'; t[t.length] = '<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>'; t[t.length] = '<a:dk2><a:srgbClr val="1F497D"/></a:dk2>'; t[t.length] = '<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>'; t[t.length] = '<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>'; t[t.length] = '<a:accent2><a:srgbClr val="C0504D"/></a:accent2>'; t[t.length] = '<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>'; t[t.length] = '<a:accent4><a:srgbClr val="8064A2"/></a:accent4>'; t[t.length] = '<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>'; t[t.length] = '<a:accent6><a:srgbClr val="F79646"/></a:accent6>'; t[t.length] = '<a:hlink><a:srgbClr val="0000FF"/></a:hlink>'; t[t.length] = '<a:folHlink><a:srgbClr val="800080"/></a:folHlink>'; t[t.length] = "</a:clrScheme>"; t[t.length] = '<a:fontScheme name="Office">'; t[t.length] = "<a:majorFont>"; t[t.length] = '<a:latin typeface="Cambria"/>'; t[t.length] = '<a:ea typeface=""/>'; t[t.length] = '<a:cs typeface=""/>'; t[t.length] = '<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>'; t[t.length] = '<a:font script="Hang" typeface="맑은 고딕"/>'; t[t.length] = '<a:font script="Hans" typeface="宋体"/>'; t[t.length] = '<a:font script="Hant" typeface="新細明體"/>'; t[t.length] = '<a:font script="Arab" typeface="Times New Roman"/>'; t[t.length] = '<a:font script="Hebr" typeface="Times New Roman"/>'; t[t.length] = '<a:font script="Thai" typeface="Tahoma"/>'; t[t.length] = '<a:font script="Ethi" typeface="Nyala"/>'; t[t.length] = '<a:font script="Beng" typeface="Vrinda"/>'; t[t.length] = '<a:font script="Gujr" typeface="Shruti"/>'; t[t.length] = '<a:font script="Khmr" typeface="MoolBoran"/>'; t[t.length] = '<a:font script="Knda" typeface="Tunga"/>'; t[t.length] = '<a:font script="Guru" typeface="Raavi"/>'; t[t.length] = '<a:font script="Cans" typeface="Euphemia"/>'; t[t.length] = '<a:font script="Cher" typeface="Plantagenet Cherokee"/>'; t[t.length] = '<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>'; t[t.length] = '<a:font script="Tibt" typeface="Microsoft Himalaya"/>'; t[t.length] = '<a:font script="Thaa" typeface="MV Boli"/>'; t[t.length] = '<a:font script="Deva" typeface="Mangal"/>'; t[t.length] = '<a:font script="Telu" typeface="Gautami"/>'; t[t.length] = '<a:font script="Taml" typeface="Latha"/>'; t[t.length] = '<a:font script="Syrc" typeface="Estrangelo Edessa"/>'; t[t.length] = '<a:font script="Orya" typeface="Kalinga"/>'; t[t.length] = '<a:font script="Mlym" typeface="Kartika"/>'; t[t.length] = '<a:font script="Laoo" typeface="DokChampa"/>'; t[t.length] = '<a:font script="Sinh" typeface="Iskoola Pota"/>'; t[t.length] = '<a:font script="Mong" typeface="Mongolian Baiti"/>'; t[t.length] = '<a:font script="Viet" typeface="Times New Roman"/>'; t[t.length] = '<a:font script="Uigh" typeface="Microsoft Uighur"/>'; t[t.length] = '<a:font script="Geor" typeface="Sylfaen"/>'; t[t.length] = "</a:majorFont>"; t[t.length] = "<a:minorFont>"; t[t.length] = '<a:latin typeface="Calibri"/>'; t[t.length] = '<a:ea typeface=""/>'; t[t.length] = '<a:cs typeface=""/>'; t[t.length] = '<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>'; t[t.length] = '<a:font script="Hang" typeface="맑은 고딕"/>'; t[t.length] = '<a:font script="Hans" typeface="宋体"/>'; t[t.length] = '<a:font script="Hant" typeface="新細明體"/>'; t[t.length] = '<a:font script="Arab" typeface="Arial"/>'; t[t.length] = '<a:font script="Hebr" typeface="Arial"/>'; t[t.length] = '<a:font script="Thai" typeface="Tahoma"/>'; t[t.length] = '<a:font script="Ethi" typeface="Nyala"/>'; t[t.length] = '<a:font script="Beng" typeface="Vrinda"/>'; t[t.length] = '<a:font script="Gujr" typeface="Shruti"/>'; t[t.length] = '<a:font script="Khmr" typeface="DaunPenh"/>'; t[t.length] = '<a:font script="Knda" typeface="Tunga"/>'; t[t.length] = '<a:font script="Guru" typeface="Raavi"/>'; t[t.length] = '<a:font script="Cans" typeface="Euphemia"/>'; t[t.length] = '<a:font script="Cher" typeface="Plantagenet Cherokee"/>'; t[t.length] = '<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>'; t[t.length] = '<a:font script="Tibt" typeface="Microsoft Himalaya"/>'; t[t.length] = '<a:font script="Thaa" typeface="MV Boli"/>'; t[t.length] = '<a:font script="Deva" typeface="Mangal"/>'; t[t.length] = '<a:font script="Telu" typeface="Gautami"/>'; t[t.length] = '<a:font script="Taml" typeface="Latha"/>'; t[t.length] = '<a:font script="Syrc" typeface="Estrangelo Edessa"/>'; t[t.length] = '<a:font script="Orya" typeface="Kalinga"/>'; t[t.length] = '<a:font script="Mlym" typeface="Kartika"/>'; t[t.length] = '<a:font script="Laoo" typeface="DokChampa"/>'; t[t.length] = '<a:font script="Sinh" typeface="Iskoola Pota"/>'; t[t.length] = '<a:font script="Mong" typeface="Mongolian Baiti"/>'; t[t.length] = '<a:font script="Viet" typeface="Arial"/>'; t[t.length] = '<a:font script="Uigh" typeface="Microsoft Uighur"/>'; t[t.length] = '<a:font script="Geor" typeface="Sylfaen"/>'; t[t.length] = "</a:minorFont>"; t[t.length] = "</a:fontScheme>"; t[t.length] = '<a:fmtScheme name="Office">'; t[t.length] = "<a:fillStyleLst>"; t[t.length] = '<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>'; t[t.length] = '<a:gradFill rotWithShape="1">'; t[t.length] = "<a:gsLst>"; t[t.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>'; t[t.length] = '<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>'; t[t.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>'; t[t.length] = "</a:gsLst>"; t[t.length] = '<a:lin ang="16200000" scaled="1"/>'; t[t.length] = "</a:gradFill>"; t[t.length] = '<a:gradFill rotWithShape="1">'; t[t.length] = "<a:gsLst>"; t[t.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>'; t[t.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>'; t[t.length] = "</a:gsLst>"; t[t.length] = '<a:lin ang="16200000" scaled="0"/>'; t[t.length] = "</a:gradFill>"; t[t.length] = "</a:fillStyleLst>"; t[t.length] = "<a:lnStyleLst>"; t[t.length] = '<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>'; t[t.length] = '<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>'; t[t.length] = '<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>';
        t[t.length] = "</a:lnStyleLst>"; t[t.length] = "<a:effectStyleLst>"; t[t.length] = "<a:effectStyle>"; t[t.length] = "<a:effectLst>"; t[t.length] = '<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>'; t[t.length] = "</a:effectLst>"; t[t.length] = "</a:effectStyle>"; t[t.length] = "<a:effectStyle>"; t[t.length] = "<a:effectLst>"; t[t.length] = '<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>'; t[t.length] = "</a:effectLst>"; t[t.length] = "</a:effectStyle>"; t[t.length] = "<a:effectStyle>"; t[t.length] = "<a:effectLst>"; t[t.length] = '<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>'; t[t.length] = "</a:effectLst>"; t[t.length] = '<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>'; t[t.length] = '<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>'; t[t.length] = "</a:effectStyle>"; t[t.length] = "</a:effectStyleLst>"; t[t.length] = "<a:bgFillStyleLst>"; t[t.length] = '<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>'; t[t.length] = '<a:gradFill rotWithShape="1">'; t[t.length] = "<a:gsLst>"; t[t.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>'; t[t.length] = '<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>'; t[t.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>'; t[t.length] = "</a:gsLst>"; t[t.length] = '<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>'; t[t.length] = "</a:gradFill>"; t[t.length] = '<a:gradFill rotWithShape="1">'; t[t.length] = "<a:gsLst>"; t[t.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>'; t[t.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>'; t[t.length] = "</a:gsLst>"; t[t.length] = '<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>'; t[t.length] = "</a:gradFill>"; t[t.length] = "</a:bgFillStyleLst>"; t[t.length] = "</a:fmtScheme>"; t[t.length] = "</a:themeElements>"; t[t.length] = "<a:objectDefaults>"; t[t.length] = "<a:spDef>"; t[t.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>'; t[t.length] = "</a:spDef>"; t[t.length] = "<a:lnDef>"; t[t.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>'; t[t.length] = "</a:lnDef>"; t[t.length] = "</a:objectDefaults>"; t[t.length] = "<a:extraClrSchemeLst/>"; t[t.length] = "</a:theme>"; return t.join("")
    } function ei(e, r, t) { var a = { Types: [], Cell: [], Value: [] }; if (!e) return a; var n = false; var s = 2; var i; e.replace(Xr, function (e) { var r = Jr(e); switch (Kr(r[0])) { case "<?xml": break; case "<metadata": ; case "</metadata>": break; case "<metadataTypes": ; case "</metadataTypes>": break; case "<metadataType": a.Types.push({ name: r.name }); break; case "</metadataType>": break; case "<futureMetadata": for (var l = 0; l < a.Types.length; ++l)if (a.Types[l].name == r.name) i = a.Types[l]; break; case "</futureMetadata>": break; case "<bk>": break; case "</bk>": break; case "<rc": if (s == 1) a.Cell.push({ type: a.Types[r.t - 1].name, index: +r.v }); else if (s == 0) a.Value.push({ type: a.Types[r.t - 1].name, index: +r.v }); break; case "</rc>": break; case "<cellMetadata": s = 1; break; case "</cellMetadata>": s = 2; break; case "<valueMetadata": s = 0; break; case "</valueMetadata>": s = 2; break; case "<extLst": ; case "<extLst>": ; case "</extLst>": ; case "<extLst/>": break; case "<ext": n = true; break; case "</ext>": n = false; break; case "<rvb": if (!i) break; if (!i.offsets) i.offsets = []; i.offsets.push(+r.i); break; default: if (!n && t.WTF) throw new Error("unrecognized " + r[0] + " in metadata"); }return e }); return a } function ri() { var e = [Ur]; e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'); return e.join("") } function ti() { } function ai(e, r, t, a) { if (!e) return e; var n = a || {}; var s = false, i = false; ba(e, function l(e, r, t) { if (i) return; switch (t) { case 359: ; case 363: ; case 364: ; case 366: ; case 367: ; case 368: ; case 369: ; case 370: ; case 371: ; case 472: ; case 577: ; case 578: ; case 579: ; case 580: ; case 581: ; case 582: ; case 583: ; case 584: ; case 585: ; case 586: ; case 587: break; case 35: s = true; break; case 36: s = false; break; default: if (r.T) { } else if (!s || n.WTF) throw new Error("Unexpected record 0x" + t.toString(16)); } }, n) } function ni(e, r) { if (!e) return "??"; var t = (e.match(/<c:chart [^>]*r:id="([^"]*)"/) || ["", ""])[1]; return r["!id"][t].Target } function si(e, r) { var t = [21600, 21600]; var a = ["m0,0l0", t[1], t[0], t[1], t[0], "0xe"].join(","); var n = [_t("xml", null, { "xmlns:v": Mt.v, "xmlns:o": Mt.o, "xmlns:x": Mt.x, "xmlns:mv": Mt.mv }).replace(/\/>/, ">"), _t("o:shapelayout", _t("o:idmap", null, { "v:ext": "edit", data: e }), { "v:ext": "edit" })]; var s = 65536 * e; var i = r || []; if (i.length > 0) n.push(_t("v:shapetype", [_t("v:stroke", null, { joinstyle: "miter" }), _t("v:path", null, { gradientshapeok: "t", "o:connecttype": "rect" })].join(""), { id: "_x0000_t202", coordsize: t.join(","), "o:spt": 202, path: a })); i.forEach(function (e) { ++s; n.push(ii(e, s)) }); n.push("</xml>"); return n.join("") } function ii(e, r) { var t = Pa(e[0]); var a = { color2: "#BEFF82", type: "gradient" }; if (a.type == "gradient") a.angle = "-180"; var n = a.type == "gradient" ? _t("o:fill", null, { type: "gradientUnscaled", "v:ext": "view" }) : null; var s = _t("v:fill", n, a); var i = { on: "t", obscured: "t" }; return ["<v:shape" + Ct({ id: "_x0000_s" + r, type: "#_x0000_t202", style: "position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10" + (e[1].hidden ? ";visibility:hidden" : ""), fillcolor: "#ECFAD4", strokecolor: "#edeaa1" }) + ">", s, _t("v:shadow", null, i), _t("v:path", null, { "o:connecttype": "none" }), '<v:textbox><div style="text-align:left"></div></v:textbox>', '<x:ClientData ObjectType="Note">', "<x:MoveWithCells/>", "<x:SizeWithCells/>", St("x:Anchor", [t.c + 1, 0, t.r + 1, 0, t.c + 3, 20, t.r + 5, 20].join(",")), St("x:AutoFill", "False"), St("x:Row", String(t.r)), St("x:Column", String(t.c)), e[1].hidden ? "" : "<x:Visible/>", "</x:ClientData>", "</v:shape>"].join("") } function li(e, r, t, a) { var n = Array.isArray(e); var s; r.forEach(function (r) { var i = Pa(r.ref); if (n) { if (!e[i.r]) e[i.r] = []; s = e[i.r][i.c] } else s = e[r.ref]; if (!s) { s = { t: "z" }; if (n) e[i.r][i.c] = s; else e[r.ref] = s; var l = $a(e["!ref"] || "BDWGO1000001:A1"); if (l.s.r > i.r) l.s.r = i.r; if (l.e.r < i.r) l.e.r = i.r; if (l.s.c > i.c) l.s.c = i.c; if (l.e.c < i.c) l.e.c = i.c; var o = La(l); if (o !== e["!ref"]) e["!ref"] = o } if (!s.c) s.c = []; var c = { a: r.author, t: r.t, r: r.r, T: t }; if (r.h) c.h = r.h; for (var f = s.c.length - 1; f >= 0; --f) { if (!t && s.c[f].T) return; if (t && !s.c[f].T) s.c.splice(f, 1) } if (t && a) for (f = 0; f < a.length; ++f) { if (c.a == a[f].id) { c.a = a[f].name || c.a; break } } s.c.push(c) }) } function oi(e, r) { if (e.match(/<(?:\w+:)?comments *\/>/)) return []; var t = []; var a = []; var n = e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/); if (n && n[1]) n[1].split(/<\/\w*:?author>/).forEach(function (e) { if (e === "" || e.trim() === "") return; var r = e.match(/<(?:\w+:)?author[^>]*>(.*)/); if (r) t.push(r[1]) }); var s = e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/); if (s && s[1]) s[1].split(/<\/\w*:?comment>/).forEach(function (e) { if (e === "" || e.trim() === "") return; var n = e.match(/<(?:\w+:)?comment[^>]*>/); if (!n) return; var s = Jr(n[0]); var i = { author: s.authorId && t[s.authorId] || "sheetjsghost", ref: s.ref, guid: s.guid }; var l = Pa(s.ref); if (r.sheetRows && r.sheetRows <= l.r) return; var o = e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/); var c = !!o && !!o[1] && ss(o[1]) || { r: "", t: "", h: "" }; i.r = c.r; if (c.r == "<t></t>") c.t = c.h = ""; i.t = (c.t || "").replace(/\r\n/g, "\n").replace(/\r/g, "\n"); if (r.cellHTML) i.h = c.h; a.push(i) }); return a } function ci(e) { var r = [Ur, _t("comments", null, { xmlns: Ot[0] })]; var t = []; r.push("<authors>"); e.forEach(function (e) { e[1].forEach(function (e) { var a = tt(e.a); if (t.indexOf(a) == -1) { t.push(a); r.push("<author>" + a + "</author>") } if (e.T && e.ID && t.indexOf("tc=" + e.ID) == -1) { t.push("tc=" + e.ID); r.push("<author>" + "tc=" + e.ID + "</author>") } }) }); if (t.length == 0) { t.push("SheetJ5"); r.push("<author>SheetJ5</author>") } r.push("</authors>"); r.push("<commentList>"); e.forEach(function (e) { var a = 0, n = []; if (e[1][0] && e[1][0].T && e[1][0].ID) a = t.indexOf("tc=" + e[1][0].ID); else e[1].forEach(function (e) { if (e.a) a = t.indexOf(tt(e.a)); n.push(e.t || "") }); r.push('<comment ref="' + e[0] + '" authorId="' + a + '"><text>'); if (n.length <= 1) r.push(St("t", tt(n[0] || ""))); else { var s = "Comment:\n    " + n[0] + "\n"; for (var i = 1; i < n.length; ++i)s += "Reply:\n    " + n[i] + "\n"; r.push(St("t", tt(s))) } r.push("</text></comment>") }); r.push("</commentList>"); if (r.length > 2) { r[r.length] = "</comments>"; r[1] = r[1].replace("/>", ">") } return r.join("") } function fi(e, r) { var t = []; var a = false, n = {}, s = 0; e.replace(Xr, function i(l, o) { var c = Jr(l); switch (Kr(c[0])) { case "<?xml": break; case "<ThreadedComments": break; case "</ThreadedComments>": break; case "<threadedComment": n = { author: c.personId, guid: c.id, ref: c.ref, T: 1 }; break; case "</threadedComment>": if (n.t != null) t.push(n); break; case "<text>": ; case "<text": s = o + l.length; break; case "</text>": n.t = e.slice(s, o).replace(/\r\n/g, "\n").replace(/\r/g, "\n"); break; case "<mentions": ; case "<mentions>": a = true; break; case "</mentions>": a = false; break; case "<extLst": ; case "<extLst>": ; case "</extLst>": ; case "<extLst/>": break; case "<ext": a = true; break; case "</ext>": a = false; break; default: if (!a && r.WTF) throw new Error("unrecognized " + c[0] + " in threaded comments"); }return l }); return t } function ui(e, r, t) { var a = [Ur, _t("ThreadedComments", null, { xmlns: Dt.TCMNT }).replace(/[\/]>/, ">")]; e.forEach(function (e) { var n = ""; (e[1] || []).forEach(function (s, i) { if (!s.T) { delete s.ID; return } if (s.a && r.indexOf(s.a) == -1) r.push(s.a); var l = { ref: e[0], id: "{54EE7951-7262-4200-6969-" + ("000000000000" + t.tcid++).slice(-12) + "}" }; if (i == 0) n = l.id; else l.parentId = n; s.ID = l.id; if (s.a) l.personId = "{54EE7950-7262-4200-6969-" + ("000000000000" + r.indexOf(s.a)).slice(-12) + "}"; a.push(_t("threadedComment", St("text", s.t || ""), l)) }) }); a.push("</ThreadedComments>"); return a.join("") } function hi(e, r) { var t = []; var a = false; e.replace(Xr, function n(e) { var n = Jr(e); switch (Kr(n[0])) { case "<?xml": break; case "<personList": break; case "</personList>": break; case "<person": t.push({ name: n.displayname, id: n.id }); break; case "</person>": break; case "<extLst": ; case "<extLst>": ; case "</extLst>": ; case "<extLst/>": break; case "<ext": a = true; break; case "</ext>": a = false; break; default: if (!a && r.WTF) throw new Error("unrecognized " + n[0] + " in threaded comments"); }return e }); return t } function di(e) { var r = [Ur, _t("personList", null, { xmlns: Dt.TCMNT, "xmlns:x": Ot[0] }).replace(/[\/]>/, ">")]; e.forEach(function (e, t) { r.push(_t("person", null, { displayName: e, id: "{54EE7950-7262-4200-6969-" + ("000000000000" + t).slice(-12) + "}", userId: e, providerId: "None" })) }); r.push("</personList>"); return r.join("") } var mi = "application/vnd.ms-office.vbaProject"; function pi(e) { var r = qe.utils.cfb_new({ root: "R" }); e.FullPaths.forEach(function (t, a) { if (t.slice(-1) === "/" || !t.match(/_VBA_PROJECT_CUR/)) return; var n = t.replace(/^[^\/]*/, "R").replace(/\/_VBA_PROJECT_CUR\u0000*/, ""); qe.utils.cfb_add(r, n, e.FileIndex[a].content) }); return qe.write(r) } function vi(e, r) { r.FullPaths.forEach(function (t, a) { if (a == 0) return; var n = t.replace(/[^\/]*[\/]/, "/_VBA_PROJECT_CUR/"); if (n.slice(-1) !== "/") qe.utils.cfb_add(e, n, r.FileIndex[a].content) }) } var gi = ["xlsb", "xlsm", "xlam", "biff8", "xla"]; function bi() { return { "!type": "dialog" } } function wi() { return { "!type": "dialog" } } function ki() { return { "!type": "macro" } } function yi() { return { "!type": "macro" } } var xi = function () { var e = /(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g; var r = { r: 0, c: 0 }; function t(e, t, a, n) { var s = false, i = false; if (a.length == 0) i = true; else if (a.charAt(0) == "[") { i = true; a = a.slice(1, -1) } if (n.length == 0) s = true; else if (n.charAt(0) == "[") { s = true; n = n.slice(1, -1) } var l = a.length > 0 ? parseInt(a, 10) | 0 : 0, o = n.length > 0 ? parseInt(n, 10) | 0 : 0; if (s) o += r.c; else --o; if (i) l += r.r; else --l; return t + (s ? "" : "$") + Da(o) + (i ? "" : "$") + Aa(l) } return function a(n, s) { r = s; return n.replace(e, t) } }(); var Si = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g; var Ci = function () { return function e(r, t) { return r.replace(Si, function (e, r, a, n, s, i) { var l = Ta(n) - (a ? 0 : t.c); var o = _a(i) - (s ? 0 : t.r); var c = s == "$" ? o + 1 : o == 0 ? "" : "[" + o + "]"; var f = a == "$" ? l + 1 : l == 0 ? "" : "[" + l + "]"; return r + "R" + c + "C" + f }) } }(); function _i(e, r) { return e.replace(Si, function (e, t, a, n, s, i) { return t + (a == "$" ? a + n : Da(Ta(n) + r.c)) + (s == "$" ? s + i : Aa(_a(i) + r.r)) }) } function Ai(e, r, t) { var a = Ra(r), n = a.s, s = Pa(t); var i = { r: s.r - n.r, c: s.c - n.c }; return _i(e, i) } function Fi(e) { if (e.length == 1) return false; return true } function Ei(e) { return e.replace(/_xlfn\./g, "") } function Ti(e) { if (e.slice(0, 3) == "of:") e = e.slice(3); if (e.charCodeAt(0) == 61) { e = e.slice(1); if (e.charCodeAt(0) == 61) e = e.slice(1) } e = e.replace(/COM\.MICROSOFT\./g, ""); e = e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g, function (e, r) { return r.replace(/\./g, "") }); e = e.replace(/\$'([^']|'')+'/g, function (e) { return e.slice(1) }); e = e.replace(/\$([^\]\. #$]+)/g, function (e, r) { return r.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/) ? e : r }); e = e.replace(/\[.(#[A-Z]*[?!])\]/g, "$1"); return e.replace(/[;~]/g, ",").replace(/\|/g, ";") } function Di(e) { var r = "of:=" + e.replace(Si, "$1[.$2$3$4$5]").replace(/\]:\[/g, ":"); return r.replace(/;/g, "|").replace(/,/g, ";") } function Oi(e) { e = e.replace(/\$'([^']|'')+'/g, function (e) { return e.slice(1) }); e = e.replace(/\$([^\]\. #$]+)/g, function (e, r) { return r.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/) ? e : r }); var r = e.split(":"); var t = r[0].split(".")[0]; return [t, r[0].split(".")[1] + (r.length > 1 ? ":" + (r[1].split(".")[1] || r[1].split(".")[0]) : "")] } function Mi(e) { return e.replace(/!/, ".") } var Ni = {}; var Pi = {}; var Ii = typeof Map !== "undefined"; function Ri(e, r, t) { var a = 0, n = e.length; if (t) { if (Ii ? t.has(r) : Object.prototype.hasOwnProperty.call(t, r)) { var s = Ii ? t.get(r) : t[r]; for (; a < s.length; ++a) { if (e[s[a]].t === r) { e.Count++; return s[a] } } } } else for (; a < n; ++a) { if (e[a].t === r) { e.Count++; return a } } e[n] = { t: r }; e.Count++; e.Unique++; if (t) { if (Ii) { if (!t.has(r)) t.set(r, []); t.get(r).push(n) } else { if (!Object.prototype.hasOwnProperty.call(t, r)) t[r] = []; t[r].push(n) } } return n } function Li(e, r) { var t = { min: e + 1, max: e + 1 }; var a = -1; if (r.MDW) ks = r.MDW; if (r.width != null) t.customWidth = 1; else if (r.wpx != null) a = xs(r.wpx); else if (r.wch != null) a = r.wch; if (a > -1) { t.width = Ss(a); t.customWidth = 1 } else if (r.width != null) t.width = r.width; if (r.hidden) t.hidden = true; if (r.level != null) { t.outlineLevel = t.level = r.level } return t } function Bi(e, r) { if (!e) return; var t = [.7, .7, .75, .75, .3, .3]; if (r == "xlml") t = [1, 1, 1, 1, .5, .5]; if (e.left == null) e.left = t[0]; if (e.right == null) e.right = t[1]; if (e.top == null) e.top = t[2]; if (e.bottom == null) e.bottom = t[3]; if (e.header == null) e.header = t[4]; if (e.footer == null) e.footer = t[5] } function zi(e, r, t) { var a = t.revssf[r.z != null ? r.z : "General"]; var n = 60, s = e.length; if (a == null && t.ssf) { for (; n < 392; ++n)if (t.ssf[n] == null) { Ke(r.z, n); t.ssf[n] = r.z; t.revssf[r.z] = a = n; break } } for (n = 0; n != s; ++n)if (e[n].numFmtId === a) return n; e[s] = { numFmtId: a, fontId: 0, fillId: 0, borderId: 0, xfId: 0, applyNumberFormat: 1 }; return s } function $i(e, r, t, a, n, s) { try { if (a.cellNF) e.z = Y[r] } catch (i) { if (a.WTF) throw i } if (e.t === "z" && !a.cellStyles) return; if (e.t === "d" && typeof e.v === "string") e.v = wr(e.v); if ((!a || a.cellText !== false) && e.t !== "z") try { if (Y[r] == null) Ke(Ve[r] || "General", r); if (e.t === "e") e.w = e.w || dn[e.v]; else if (r === 0) { if (e.t === "n") { if ((e.v | 0) === e.v) e.w = e.v.toString(10); else e.w = le(e.v) } else if (e.t === "d") { var l = fr(e.v); if ((l | 0) === l) e.w = l.toString(10); else e.w = le(l) } else if (e.v === undefined) return ""; else e.w = oe(e.v, Pi) } else if (e.t === "d") e.w = $e(r, fr(e.v), Pi); else e.w = $e(r, e.v, Pi) } catch (i) { if (a.WTF) throw i } if (!a.cellStyles) return; if (t != null) try { e.s = s.Fills[t]; if (e.s.fgColor && e.s.fgColor.theme && !e.s.fgColor.rgb) { e.s.fgColor.rgb = vs(n.themeElements.clrScheme[e.s.fgColor.theme].rgb, e.s.fgColor.tint || 0); if (a.WTF) e.s.fgColor.raw_rgb = n.themeElements.clrScheme[e.s.fgColor.theme].rgb } if (e.s.bgColor && e.s.bgColor.theme) { e.s.bgColor.rgb = vs(n.themeElements.clrScheme[e.s.bgColor.theme].rgb, e.s.bgColor.tint || 0); if (a.WTF) e.s.bgColor.raw_rgb = n.themeElements.clrScheme[e.s.bgColor.theme].rgb } } catch (i) { if (a.WTF && s.Fills) throw i } } function Wi(e, r, t) { if (e && e["!ref"]) { var a = $a(e["!ref"]); if (a.e.c < a.s.c || a.e.r < a.s.r) throw new Error("Bad range (" + t + "): " + e["!ref"]) } } function Ui(e, r) { var t = $a(r); if (t.s.r <= t.e.r && t.s.c <= t.e.c && t.s.r >= 0 && t.s.c >= 0) e["!ref"] = La(t) } var ji = /<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g; var Hi = /<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/; var Vi = /<(?:\w:)?hyperlink [^>]*>/gm; var Xi = /"(\w*:\w*)"/; var Gi = /<(?:\w:)?col\b[^>]*[\/]?>/g; var Yi = /<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g; var Ji = /<(?:\w:)?pageMargins[^>]*\/>/g; var Ki = /<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/; var Zi = /<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/; var qi = /<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/; function Qi(e, r, t, a, n, s, i) { if (!e) return e; if (!a) a = { "!id": {} }; if (g != null && r.dense == null) r.dense = g; var l = r.dense ? [] : {}; var o = { s: { r: 2e6, c: 2e6 }, e: { r: 0, c: 0 } }; var c = "", f = ""; var u = e.match(Hi); if (u) { c = e.slice(0, u.index); f = e.slice(u.index + u[0].length) } else c = f = e; var h = c.match(Ki); if (h) rl(h[0], l, n, t); else if (h = c.match(Zi)) tl(h[0], h[1] || "", l, n, t, i, s); var d = (c.match(/<(?:\w*:)?dimension/) || { index: -1 }).index; if (d > 0) { var m = c.slice(d, d + 50).match(Xi); if (m) Ui(l, m[1]) } var p = c.match(qi); if (p && p[1]) pl(p[1], n); var v = []; if (r.cellStyles) { var b = c.match(Gi); if (b) fl(v, b) } if (u) bl(u[1], l, r, o, s, i); var w = f.match(Yi); if (w) l["!autofilter"] = hl(w[0]); var k = []; var y = f.match(ji); if (y) for (d = 0; d != y.length; ++d)k[d] = $a(y[d].slice(y[d].indexOf('"') + 1)); var x = f.match(Vi); if (x) ll(l, x, a); var S = f.match(Ji); if (S) l["!margins"] = ol(Jr(S[0])); if (!l["!ref"] && o.e.c >= o.s.c && o.e.r >= o.s.r) l["!ref"] = La(o); if (r.sheetRows > 0 && l["!ref"]) { var C = $a(l["!ref"]); if (r.sheetRows <= +C.e.r) { C.e.r = r.sheetRows - 1; if (C.e.r > o.e.r) C.e.r = o.e.r; if (C.e.r < C.s.r) C.s.r = C.e.r; if (C.e.c > o.e.c) C.e.c = o.e.c; if (C.e.c < C.s.c) C.s.c = C.e.c; l["!fullref"] = l["!ref"]; l["!ref"] = La(C) } } if (v.length > 0) l["!cols"] = v; if (k.length > 0) l["!merges"] = k; return l } function el(e) { if (e.length === 0) return ""; var r = '<mergeCells count="' + e.length + '">'; for (var t = 0; t != e.length; ++t)r += '<mergeCell ref="' + La(e[t]) + '"/>'; return r + "</mergeCells>" } function rl(e, r, t, a) { var n = Jr(e); if (!t.Sheets[a]) t.Sheets[a] = {}; if (n.codeName) t.Sheets[a].CodeName = Qr(mt(n.codeName)) } function tl(e, r, t, a, n) { rl(e.slice(0, e.indexOf(">")), t, a, n) } function al(e, r, t, a, n) { var s = false; var i = {}, l = null; if (a.bookType !== "xlsx" && r.vbaraw) { var o = r.SheetNames[t]; try { if (r.Workbook) o = r.Workbook.Sheets[t].CodeName || o } catch (c) { } s = true; i.codeName = pt(tt(o)) } if (e && e["!outline"]) { var f = { summaryBelow: 1, summaryRight: 1 }; if (e["!outline"].above) f.summaryBelow = 0; if (e["!outline"].left) f.summaryRight = 0; l = (l || "") + _t("outlinePr", null, f) } if (!s && !l) return; n[n.length] = _t("sheetPr", l, i) } var nl = ["objects", "scenarios", "selectLockedCells", "selectUnlockedCells"]; var sl = ["formatColumns", "formatRows", "formatCells", "insertColumns", "insertRows", "insertHyperlinks", "deleteColumns", "deleteRows", "sort", "autoFilter", "pivotTables"]; function il(e) { var r = { sheet: 1 }; nl.forEach(function (t) { if (e[t] != null && e[t]) r[t] = "1" }); sl.forEach(function (t) { if (e[t] != null && !e[t]) r[t] = "0" }); if (e.password) r.password = crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase(); return _t("sheetProtection", null, r) } function ll(e, r, t) { var a = Array.isArray(e); for (var n = 0; n != r.length; ++n) { var s = Jr(mt(r[n]), true); if (!s.ref) return; var i = ((t || {})["!id"] || [])[s.id]; if (i) { s.Target = i.Target; if (s.location) s.Target += "#" + Qr(s.location) } else { s.Target = "#" + Qr(s.location); i = { Target: s.Target, TargetMode: "Internal" } } s.Rel = i; if (s.tooltip) { s.Tooltip = s.tooltip; delete s.tooltip } var l = $a(s.ref); for (var o = l.s.r; o <= l.e.r; ++o)for (var c = l.s.c; c <= l.e.c; ++c) { var f = Ia({ c: c, r: o }); if (a) { if (!e[o]) e[o] = []; if (!e[o][c]) e[o][c] = { t: "z", v: undefined }; e[o][c].l = s } else { if (!e[f]) e[f] = { t: "z", v: undefined }; e[f].l = s } } } } function ol(e) { var r = {};["left", "right", "top", "bottom", "header", "footer"].forEach(function (t) { if (e[t]) r[t] = parseFloat(e[t]) }); return r } function cl(e) { Bi(e); return _t("pageMargins", null, e) } function fl(e, r) { var t = false; for (var a = 0; a != r.length; ++a) { var n = Jr(r[a], true); if (n.hidden) n.hidden = ct(n.hidden); var s = parseInt(n.min, 10) - 1, i = parseInt(n.max, 10) - 1; if (n.outlineLevel) n.level = +n.outlineLevel || 0; delete n.min; delete n.max; n.width = +n.width; if (!t && n.width) { t = true; _s(n.width) } As(n); while (s <= i) e[s++] = yr(n) } } function ul(e, r) { var t = ["<cols>"], a; for (var n = 0; n != r.length; ++n) { if (!(a = r[n])) continue; t[t.length] = _t("col", null, Li(n, a)) } t[t.length] = "</cols>"; return t.join("") } function hl(e) { var r = { ref: (e.match(/ref="([^"]*)"/) || [])[1] }; return r } function dl(e, r, t, a) { var n = typeof e.ref == "string" ? e.ref : La(e.ref); if (!t.Workbook) t.Workbook = { Sheets: [] }; if (!t.Workbook.Names) t.Workbook.Names = []; var s = t.Workbook.Names; var i = Ra(n); if (i.s.r == i.e.r) { i.e.r = Ra(r["!ref"]).e.r; n = La(i) } for (var l = 0; l < s.length; ++l) { var o = s[l]; if (o.Name != "_xlnm._FilterDatabase") continue; if (o.Sheet != a) continue; o.Ref = za(t.SheetNames[a]) + "!" + Ba(n); break } if (l == s.length) s.push({ Name: "_xlnm._FilterDatabase", Sheet: a, Ref: "'" + t.SheetNames[a] + "'!" + n }); return _t("autoFilter", null, { ref: n }) } var ml = /<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/g; function pl(e, r) { if (!r.Views) r.Views = [{}]; (e.match(ml) || []).forEach(function (e, t) { var a = Jr(e); if (!r.Views[t]) r.Views[t] = {}; if (+a.zoomScale) r.Views[t].zoom = +a.zoomScale; if (a.rightToLeft && ct(a.rightToLeft)) r.Views[t].RTL = true }) } function vl(e, r, t, a) { var n = { workbookViewId: "0" }; if ((((a || {}).Workbook || {}).Views || [])[0]) n.rightToLeft = a.Workbook.Views[0].RTL ? "1" : "0"; return _t("sheetViews", _t("sheetView", null, n), {}) } function gl(e, r, t, a) { if (e.c) t["!comments"].push([r, e.c]); if (e.v === undefined && typeof e.f !== "string" || e.t === "z" && !e.f) return ""; var n = ""; var s = e.t, i = e.v; if (e.t !== "z") switch (e.t) { case "b": n = e.v ? "1" : "0"; break; case "n": n = "" + e.v; break; case "e": n = dn[e.v]; break; case "d": if (a && a.cellDates) n = wr(e.v, -1).toISOString(); else { e = yr(e); e.t = "n"; n = "" + (e.v = fr(wr(e.v))) } if (typeof e.z === "undefined") e.z = Y[14]; break; default: n = e.v; break; }var l = e.t == "z" || e.v == null ? "" : St("v", tt(n)), o = { r: r }; var c = zi(a.cellXfs, e, a); if (c !== 0) o.s = c; switch (e.t) { case "n": break; case "d": o.t = "d"; break; case "b": o.t = "b"; break; case "e": o.t = "e"; break; case "z": break; default: if (e.v == null) { delete e.t; break } if (e.v.length > 32767) throw new Error("Text length must not exceed 32767 characters"); if (a && a.bookSST) { l = St("v", "" + Ri(a.Strings, e.v, a.revStrings)); o.t = "s"; break } else o.t = "str"; break; }if (e.t != s) { e.t = s; e.v = i } if (typeof e.f == "string" && e.f) { var f = e.F && e.F.slice(0, r.length) == r ? { t: "array", ref: e.F } : null; l = _t("f", tt(e.f), f) + (e.v != null ? l : "") } if (e.l) t["!links"].push([r, e.l]); if (e.D) o.cm = 1; return _t("c", l, o) } var bl = function () { var e = /<(?:\w+:)?c[ \/>]/, r = /<\/(?:\w+:)?row>/; var t = /r=["']([^"']*)["']/, a = /<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/; var n = /ref=["']([^"']*)["']/; var s = vt("v"), i = vt("f"); return function l(o, c, f, u, h, d) { var m = 0, p = "", v = [], g = [], b = 0, w = 0, k = 0, y = "", x; var S, C = 0, _ = 0; var A, F; var E = 0, T = 0; var D = Array.isArray(d.CellXf), O; var M = []; var N = []; var P = Array.isArray(c); var I = [], R = {}, L = false; var B = !!f.sheetStubs; for (var z = o.split(r), $ = 0, W = z.length; $ != W; ++$) { p = z[$].trim(); var U = p.length; if (U === 0) continue; var j = 0; e: for (m = 0; m < U; ++m)switch (p[m]) { case ">": if (p[m - 1] != "/") { ++m; break e } if (f && f.cellStyles) { S = Jr(p.slice(j, m), true); C = S.r != null ? parseInt(S.r, 10) : C + 1; _ = -1; if (f.sheetRows && f.sheetRows < C) continue; R = {}; L = false; if (S.ht) { L = true; R.hpt = parseFloat(S.ht); R.hpx = Ds(R.hpt) } if (S.hidden && ct(S.hidden)) { L = true; R.hidden = true } if (S.outlineLevel != null) { L = true; R.level = +S.outlineLevel } if (L) I[C - 1] = R } break; case "<": j = m; break; }if (j >= m) break; S = Jr(p.slice(j, m), true); C = S.r != null ? parseInt(S.r, 10) : C + 1; _ = -1; if (f.sheetRows && f.sheetRows < C) continue; if (u.s.r > C - 1) u.s.r = C - 1; if (u.e.r < C - 1) u.e.r = C - 1; if (f && f.cellStyles) { R = {}; L = false; if (S.ht) { L = true; R.hpt = parseFloat(S.ht); R.hpx = Ds(R.hpt) } if (S.hidden && ct(S.hidden)) { L = true; R.hidden = true } if (S.outlineLevel != null) { L = true; R.level = +S.outlineLevel } if (L) I[C - 1] = R } v = p.slice(m).split(e); for (var H = 0; H != v.length; ++H)if (v[H].trim().charAt(0) != "<") break; v = v.slice(H); for (m = 0; m != v.length; ++m) { p = v[m].trim(); if (p.length === 0) continue; g = p.match(t); b = m; w = 0; k = 0; p = "<c " + (p.slice(0, 1) == "<" ? ">" : "") + p; if (g != null && g.length === 2) { b = 0; y = g[1]; for (w = 0; w != y.length; ++w) { if ((k = y.charCodeAt(w) - 64) < 1 || k > 26) break; b = 26 * b + k } --b; _ = b } else ++_; for (w = 0; w != p.length; ++w)if (p.charCodeAt(w) === 62) break; ++w; S = Jr(p.slice(0, w), true); if (!S.r) S.r = Ia({ r: C - 1, c: _ }); y = p.slice(w); x = { t: "" }; if ((g = y.match(s)) != null && g[1] !== "") x.v = Qr(g[1]); if (f.cellFormula) { if ((g = y.match(i)) != null && g[1] !== "") { x.f = Qr(mt(g[1]), true); if (!f.xlfn) x.f = Ei(x.f); if (g[0].indexOf('t="array"') > -1) { x.F = (y.match(n) || [])[1]; if (x.F.indexOf(":") > -1) M.push([$a(x.F), x.F]) } else if (g[0].indexOf('t="shared"') > -1) { F = Jr(g[0]); var V = Qr(mt(g[1])); if (!f.xlfn) V = Ei(V); N[parseInt(F.si, 10)] = [F, V, S.r] } } else if (g = y.match(/<f[^>]*\/>/)) { F = Jr(g[0]); if (N[F.si]) x.f = Ai(N[F.si][1], N[F.si][2], S.r) } var X = Pa(S.r); for (w = 0; w < M.length; ++w)if (X.r >= M[w][0].s.r && X.r <= M[w][0].e.r) if (X.c >= M[w][0].s.c && X.c <= M[w][0].e.c) x.F = M[w][1] } if (S.t == null && x.v === undefined) { if (x.f || x.F) { x.v = 0; x.t = "n" } else if (!B) continue; else x.t = "z" } else x.t = S.t || "n"; if (u.s.c > _) u.s.c = _; if (u.e.c < _) u.e.c = _; switch (x.t) { case "n": if (x.v == "" || x.v == null) { if (!B) continue; x.t = "z" } else x.v = parseFloat(x.v); break; case "s": if (typeof x.v == "undefined") { if (!B) continue; x.t = "z" } else { A = Ni[parseInt(x.v, 10)]; x.v = A.t; x.r = A.r; if (f.cellHTML) x.h = A.h } break; case "str": x.t = "s"; x.v = x.v != null ? Qr(mt(x.v), true) : ""; if (f.cellHTML) x.h = st(x.v); break; case "inlineStr": g = y.match(a); x.t = "s"; if (g != null && (A = ss(g[1]))) { x.v = A.t; if (f.cellHTML) x.h = A.h } else x.v = ""; break; case "b": x.v = ct(x.v); break; case "d": if (f.cellDates) x.v = wr(x.v, 1); else { x.v = fr(wr(x.v, 1)); x.t = "n" } break; case "e": if (!f || f.cellText !== false) x.w = x.v; x.v = mn[x.v]; break; }E = T = 0; O = null; if (D && S.s !== undefined) { O = d.CellXf[S.s]; if (O != null) { if (O.numFmtId != null) E = O.numFmtId; if (f.cellStyles) { if (O.fillId != null) T = O.fillId } } } $i(x, E, T, f, h, d); if (f.cellDates && D && x.t == "n" && Ie(Y[E])) { x.t = "d"; x.v = mr(x.v) } if (S.cm && f.xlmeta) { var G = (f.xlmeta.Cell || [])[+S.cm - 1]; if (G && G.type == "XLDAPR") x.D = true } if (P) { var J = Pa(S.r); if (!c[J.r]) c[J.r] = []; c[J.r][J.c] = x } else c[S.r] = x } } if (I.length > 0) c["!rows"] = I } }(); function wl(e, r, t, a) { var n = [], s = [], i = $a(e["!ref"]), l = "", o, c = "", f = [], u = 0, h = 0, d = e["!rows"]; var m = Array.isArray(e); var p = { r: c }, v, g = -1; for (h = i.s.c; h <= i.e.c; ++h)f[h] = Da(h); for (u = i.s.r; u <= i.e.r; ++u) { s = []; c = Aa(u); for (h = i.s.c; h <= i.e.c; ++h) { o = f[h] + c; var b = m ? (e[u] || [])[h] : e[o]; if (b === undefined) continue; if ((l = gl(b, o, e, r, t, a)) != null) s.push(l) } if (s.length > 0 || d && d[u]) { p = { r: c }; if (d && d[u]) { v = d[u]; if (v.hidden) p.hidden = 1; g = -1; if (v.hpx) g = Ts(v.hpx); else if (v.hpt) g = v.hpt; if (g > -1) { p.ht = g; p.customHeight = 1 } if (v.level) { p.outlineLevel = v.level } } n[n.length] = _t("row", s.join(""), p) } } if (d) for (; u < d.length; ++u) { if (d && d[u]) { p = { r: u + 1 }; v = d[u]; if (v.hidden) p.hidden = 1; g = -1; if (v.hpx) g = Ts(v.hpx); else if (v.hpt) g = v.hpt; if (g > -1) { p.ht = g; p.customHeight = 1 } if (v.level) { p.outlineLevel = v.level } n[n.length] = _t("row", "", p) } } return n.join("") } function kl(e, r, t, a) { var n = [Ur, _t("worksheet", null, { xmlns: Ot[0], "xmlns:r": Dt.r })]; var s = t.SheetNames[e], i = 0, l = ""; var o = t.Sheets[s]; if (o == null) o = {}; var c = o["!ref"] || "A1"; var f = $a(c); if (f.e.c > 16383 || f.e.r > 1048575) { if (r.WTF) throw new Error("Range " + c + " exceeds format limit A1:XFD1048576"); f.e.c = Math.min(f.e.c, 16383); f.e.r = Math.min(f.e.c, 1048575); c = La(f) } if (!a) a = {}; o["!comments"] = []; var u = []; al(o, t, e, r, n); n[n.length] = _t("dimension", null, { ref: c }); n[n.length] = vl(o, r, e, t); if (r.sheetFormat) n[n.length] = _t("sheetFormatPr", null, { defaultRowHeight: r.sheetFormat.defaultRowHeight || "16", baseColWidth: r.sheetFormat.baseColWidth || "10", outlineLevelRow: r.sheetFormat.outlineLevelRow || "7" }); if (o["!cols"] != null && o["!cols"].length > 0) n[n.length] = ul(o, o["!cols"]); n[i = n.length] = "<sheetData/>"; o["!links"] = []; if (o["!ref"] != null) { l = wl(o, r, e, t, a); if (l.length > 0) n[n.length] = l } if (n.length > i + 1) { n[n.length] = "</sheetData>"; n[i] = n[i].replace("/>", ">") } if (o["!protect"]) n[n.length] = il(o["!protect"]); if (o["!autofilter"] != null) n[n.length] = dl(o["!autofilter"], o, t, e); if (o["!merges"] != null && o["!merges"].length > 0) n[n.length] = el(o["!merges"]); var h = -1, d, m = -1; if (o["!links"].length > 0) { n[n.length] = "<hyperlinks>"; o["!links"].forEach(function (e) { if (!e[1].Target) return; d = { ref: e[0] }; if (e[1].Target.charAt(0) != "#") { m = _n(a, -1, tt(e[1].Target).replace(/#.*$/, ""), yn.HLINK); d["r:id"] = "rId" + m } if ((h = e[1].Target.indexOf("#")) > -1) d.location = tt(e[1].Target.slice(h + 1)); if (e[1].Tooltip) d.tooltip = tt(e[1].Tooltip); n[n.length] = _t("hyperlink", null, d) }); n[n.length] = "</hyperlinks>" } delete o["!links"]; if (o["!margins"] != null) n[n.length] = cl(o["!margins"]); if (!r || r.ignoreEC || r.ignoreEC == void 0) n[n.length] = St("ignoredErrors", _t("ignoredError", null, { numberStoredAsText: 1, sqref: c })); if (u.length > 0) { m = _n(a, -1, "../drawings/drawing" + (e + 1) + ".xml", yn.DRAW); n[n.length] = _t("drawing", null, { "r:id": "rId" + m }); o["!drawing"] = u } if (o["!comments"].length > 0) { m = _n(a, -1, "../drawings/vmlDrawing" + (e + 1) + ".vml", yn.VML); n[n.length] = _t("legacyDrawing", null, { "r:id": "rId" + m }); o["!legacy"] = m } if (n.length > 1) { n[n.length] = "</worksheet>"; n[1] = n[1].replace("/>", ">") } return n.join("") } function yl(e) { var r = []; var t = e.match(/^<c:numCache>/); var a; (e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm) || []).forEach(function (e) { var a = e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/); if (!a) return; r[+a[1]] = t ? +a[2] : a[2] }); var n = Qr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/) || ["", "General"])[1]); (e.match(/<c:f>(.*?)<\/c:f>/gm) || []).forEach(function (e) { a = e.replace(/<.*?>/g, "") }); return [r, n, a] } function xl(e, r, t, a, n, s) { var i = s || { "!type": "chart" }; if (!e) return s; var l = 0, o = 0, c = "A"; var f = { s: { r: 2e6, c: 2e6 }, e: { r: 0, c: 0 } }; (e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm) || []).forEach(function (e) { var r = yl(e); f.s.r = f.s.c = 0; f.e.c = l; c = Da(l); r[0].forEach(function (e, t) { i[c + Aa(t)] = { t: "n", v: e, z: r[1] }; o = t }); if (f.e.r < o) f.e.r = o; ++l }); if (l > 0) i["!ref"] = La(f); return i } function Sl(e, r, t, a, n) { if (!e) return e; if (!a) a = { "!id": {} }; var s = { "!type": "chart", "!drawel": null, "!rel": "" }; var i; var l = e.match(Ki); if (l) rl(l[0], s, n, t); if (i = e.match(/drawing r:id="(.*?)"/)) s["!rel"] = i[1]; if (a["!id"][s["!rel"]]) s["!drawel"] = a["!id"][s["!rel"]]; return s } var Cl = [["allowRefreshQuery", false, "bool"], ["autoCompressPictures", true, "bool"], ["backupFile", false, "bool"], ["checkCompatibility", false, "bool"], ["CodeName", ""], ["date1904", false, "bool"], ["defaultThemeVersion", 0, "int"], ["filterPrivacy", false, "bool"], ["hidePivotFieldList", false, "bool"], ["promptedSolutions", false, "bool"], ["publishItems", false, "bool"], ["refreshAllConnections", false, "bool"], ["saveExternalLinkValues", true, "bool"], ["showBorderUnselectedTables", true, "bool"], ["showInkAnnotation", true, "bool"], ["showObjects", "all"], ["showPivotChartFilter", false, "bool"], ["updateLinks", "userSet"]];
    var _l = [["activeTab", 0, "int"], ["autoFilterDateGrouping", true, "bool"], ["firstSheet", 0, "int"], ["minimized", false, "bool"], ["showHorizontalScroll", true, "bool"], ["showSheetTabs", true, "bool"], ["showVerticalScroll", true, "bool"], ["tabRatio", 600, "int"], ["visibility", "visible"]]; var Al = []; var Fl = [["calcCompleted", "true"], ["calcMode", "auto"], ["calcOnSave", "true"], ["concurrentCalc", "true"], ["fullCalcOnLoad", "false"], ["fullPrecision", "true"], ["iterate", "false"], ["iterateCount", "100"], ["iterateDelta", "0.001"], ["refMode", "A1"]]; function El(e, r) { for (var t = 0; t != e.length; ++t) { var a = e[t]; for (var n = 0; n != r.length; ++n) { var s = r[n]; if (a[s[0]] == null) a[s[0]] = s[1]; else switch (s[2]) { case "bool": if (typeof a[s[0]] == "string") a[s[0]] = ct(a[s[0]]); break; case "int": if (typeof a[s[0]] == "string") a[s[0]] = parseInt(a[s[0]], 10); break; } } } } function Tl(e, r) { for (var t = 0; t != r.length; ++t) { var a = r[t]; if (e[a[0]] == null) e[a[0]] = a[1]; else switch (a[2]) { case "bool": if (typeof e[a[0]] == "string") e[a[0]] = ct(e[a[0]]); break; case "int": if (typeof e[a[0]] == "string") e[a[0]] = parseInt(e[a[0]], 10); break; } } } function Dl(e) { Tl(e.WBProps, Cl); Tl(e.CalcPr, Fl); El(e.WBView, _l); El(e.Sheets, Al); Pi.date1904 = ct(e.WBProps.date1904) } function Ol(e) { if (!e.Workbook) return "false"; if (!e.Workbook.WBProps) return "false"; return ct(e.Workbook.WBProps.date1904) ? "true" : "false" } var Ml = "][*?/\\".split(""); function Nl(e, r) { if (e.length > 31) { if (r) return false; throw new Error("Sheet names cannot exceed 31 chars") } var t = true; Ml.forEach(function (a) { if (e.indexOf(a) == -1) return; if (!r) throw new Error("Sheet name cannot contain : \\ / ? * [ ]"); t = false }); return t } function Pl(e, r, t) { e.forEach(function (a, n) { Nl(a); for (var s = 0; s < n; ++s)if (a == e[s]) throw new Error("Duplicate Sheet Name: " + a); if (t) { var i = r && r[n] && r[n].CodeName || a; if (i.charCodeAt(0) == 95 && i.length > 22) throw new Error("Bad Code Name: Worksheet" + i) } }) } function Il(e) { if (!e || !e.SheetNames || !e.Sheets) throw new Error("Invalid Workbook"); if (!e.SheetNames.length) throw new Error("Workbook is empty"); var r = e.Workbook && e.Workbook.Sheets || []; Pl(e.SheetNames, r, !!e.vbaraw); for (var t = 0; t < e.SheetNames.length; ++t)Wi(e.Sheets[e.SheetNames[t]], e.SheetNames[t], t); e.SheetNames.forEach(function (r, t) { var a = e.Sheets[r]; if (!a || !a["!autofilter"]) return; var n; if (!e.Workbook) e.Workbook = {}; if (!e.Workbook.Names) e.Workbook.Names = []; e.Workbook.Names.forEach(function (e) { if (e.Name == "_xlnm._FilterDatabase" && e.Sheet == t) n = e }); var s = za(r) + "!" + Ba(a["!autofilter"].ref); if (n) n.Ref = s; else e.Workbook.Names.push({ Name: "_xlnm._FilterDatabase", Sheet: t, Ref: s }) }) } var Rl = /<\w+:workbook/; function Ll(e, r) { if (!e) throw new Error("Could not find file"); var t = { AppVersion: {}, WBProps: {}, WBView: [], Sheets: [], CalcPr: {}, Names: [], xmlns: "" }; var a = false, n = "xmlns"; var s = {}, i = 0; e.replace(Xr, function l(o, c) { var f = Jr(o); switch (Kr(f[0])) { case "<?xml": break; case "<workbook": if (o.match(Rl)) n = "xmlns" + o.match(/<(\w+):/)[1]; t.xmlns = f[n]; break; case "</workbook>": break; case "<fileVersion": delete f[0]; t.AppVersion = f; break; case "<fileVersion/>": ; case "</fileVersion>": break; case "<fileSharing": break; case "<fileSharing/>": break; case "<workbookPr": ; case "<workbookPr/>": Cl.forEach(function (e) { if (f[e[0]] == null) return; switch (e[2]) { case "bool": t.WBProps[e[0]] = ct(f[e[0]]); break; case "int": t.WBProps[e[0]] = parseInt(f[e[0]], 10); break; default: t.WBProps[e[0]] = f[e[0]]; } }); if (f.codeName) t.WBProps.CodeName = mt(f.codeName); break; case "</workbookPr>": break; case "<workbookProtection": break; case "<workbookProtection/>": break; case "<bookViews": ; case "<bookViews>": ; case "</bookViews>": break; case "<workbookView": ; case "<workbookView/>": delete f[0]; t.WBView.push(f); break; case "</workbookView>": break; case "<sheets": ; case "<sheets>": ; case "</sheets>": break; case "<sheet": switch (f.state) { case "hidden": f.Hidden = 1; break; case "veryHidden": f.Hidden = 2; break; default: f.Hidden = 0; }delete f.state; f.name = Qr(mt(f.name)); delete f[0]; t.Sheets.push(f); break; case "</sheet>": break; case "<functionGroups": ; case "<functionGroups/>": break; case "<functionGroup": break; case "<externalReferences": ; case "</externalReferences>": ; case "<externalReferences>": break; case "<externalReference": break; case "<definedNames/>": break; case "<definedNames>": ; case "<definedNames": a = true; break; case "</definedNames>": a = false; break; case "<definedName": { s = {}; s.Name = mt(f.name); if (f.comment) s.Comment = f.comment; if (f.localSheetId) s.Sheet = +f.localSheetId; if (ct(f.hidden || "0")) s.Hidden = true; i = c + o.length } break; case "</definedName>": { s.Ref = Qr(mt(e.slice(i, c))); t.Names.push(s) } break; case "<definedName/>": break; case "<calcPr": delete f[0]; t.CalcPr = f; break; case "<calcPr/>": delete f[0]; t.CalcPr = f; break; case "</calcPr>": break; case "<oleSize": break; case "<customWorkbookViews>": ; case "</customWorkbookViews>": ; case "<customWorkbookViews": break; case "<customWorkbookView": ; case "</customWorkbookView>": break; case "<pivotCaches>": ; case "</pivotCaches>": ; case "<pivotCaches": break; case "<pivotCache": break; case "<smartTagPr": ; case "<smartTagPr/>": break; case "<smartTagTypes": ; case "<smartTagTypes>": ; case "</smartTagTypes>": break; case "<smartTagType": break; case "<webPublishing": ; case "<webPublishing/>": break; case "<fileRecoveryPr": ; case "<fileRecoveryPr/>": break; case "<webPublishObjects>": ; case "<webPublishObjects": ; case "</webPublishObjects>": break; case "<webPublishObject": break; case "<extLst": ; case "<extLst>": ; case "</extLst>": ; case "<extLst/>": break; case "<ext": a = true; break; case "</ext>": a = false; break; case "<ArchID": break; case "<AlternateContent": ; case "<AlternateContent>": a = true; break; case "</AlternateContent>": a = false; break; case "<revisionPtr": break; default: if (!a && r.WTF) throw new Error("unrecognized " + f[0] + " in workbook"); }return o }); if (Ot.indexOf(t.xmlns) === -1) throw new Error("Unknown Namespace: " + t.xmlns); Dl(t); return t } function Bl(e) { var r = [Ur]; r[r.length] = _t("workbook", null, { xmlns: Ot[0], "xmlns:r": Dt.r }); var t = e.Workbook && (e.Workbook.Names || []).length > 0; var a = { codeName: "ThisWorkbook" }; if (e.Workbook && e.Workbook.WBProps) { Cl.forEach(function (r) { if (e.Workbook.WBProps[r[0]] == null) return; if (e.Workbook.WBProps[r[0]] == r[1]) return; a[r[0]] = e.Workbook.WBProps[r[0]] }); if (e.Workbook.WBProps.CodeName) { a.codeName = e.Workbook.WBProps.CodeName; delete a.CodeName } } r[r.length] = _t("workbookPr", null, a); var n = e.Workbook && e.Workbook.Sheets || []; var s = 0; if (n && n[0] && !!n[0].Hidden) { r[r.length] = "<bookViews>"; for (s = 0; s != e.SheetNames.length; ++s) { if (!n[s]) break; if (!n[s].Hidden) break } if (s == e.SheetNames.length) s = 0; r[r.length] = '<workbookView firstSheet="' + s + '" activeTab="' + s + '"/>'; r[r.length] = "</bookViews>" } r[r.length] = "<sheets>"; for (s = 0; s != e.SheetNames.length; ++s) { var i = { name: tt(e.SheetNames[s].slice(0, 31)) }; i.sheetId = "" + (s + 1); i["r:id"] = "rId" + (s + 1); if (n[s]) switch (n[s].Hidden) { case 1: i.state = "hidden"; break; case 2: i.state = "veryHidden"; break; }r[r.length] = _t("sheet", null, i) } r[r.length] = "</sheets>"; if (t) { r[r.length] = "<definedNames>"; if (e.Workbook && e.Workbook.Names) e.Workbook.Names.forEach(function (e) { var t = { name: e.Name }; if (e.Comment) t.comment = e.Comment; if (e.Sheet != null) t.localSheetId = "" + e.Sheet; if (e.Hidden) t.hidden = "1"; if (!e.Ref) return; r[r.length] = _t("definedName", tt(e.Ref), t) }); r[r.length] = "</definedNames>" } if (r.length > 2) { r[r.length] = "</workbook>"; r[1] = r[1].replace("/>", ">") } return r.join("") } function zl(e, r, t) { if (r.slice(-4) === ".bin") return parse_wb_bin(e, t); return Ll(e, t) } function $l(e, r, t, a, n, s, i, l) { if (r.slice(-4) === ".bin") return parse_ws_bin(e, a, t, n, s, i, l); return Qi(e, a, t, n, s, i, l) } function Wl(e, r, t, a, n, s, i, l) { if (r.slice(-4) === ".bin") return parse_cs_bin(e, a, t, n, s, i, l); return Sl(e, a, t, n, s, i, l) } function Ul(e, r, t, a, n, s, i, l) { if (r.slice(-4) === ".bin") return ki(e, a, t, n, s, i, l); return yi(e, a, t, n, s, i, l) } function jl(e, r, t, a, n, s, i, l) { if (r.slice(-4) === ".bin") return bi(e, a, t, n, s, i, l); return wi(e, a, t, n, s, i, l) } function Hl(e, r, t, a) { if (r.slice(-4) === ".bin") return parse_sty_bin(e, t, a); return Ws(e, t, a) } function Vl(e, r, t) { if (r.slice(-4) === ".bin") return parse_sst_bin(e, t); return cs(e, t) } function Xl(e, r, t) { if (r.slice(-4) === ".bin") return parse_comments_bin(e, t); return oi(e, t) } function Gl(e, r, t) { if (r.slice(-4) === ".bin") return parse_cc_bin(e, r, t); return parse_cc_xml(e, r, t) } function Yl(e, r, t, a) { if (t.slice(-4) === ".bin") return ai(e, r, t, a); return ti(e, r, t, a) } function Jl(e, r, t) { if (r.slice(-4) === ".bin") return parse_xlmeta_bin(e, r, t); return ei(e, r, t) } function Kl(e, r) { var t = r || {}; if (g != null && t.dense == null) t.dense = g; var a = t.dense ? [] : {}; e = e.replace(/<!--.*?-->/g, ""); var n = e.match(/<table/i); if (!n) throw new Error("Invalid HTML: could not find <table>"); var s = e.match(/<\/table/i); var i = n.index, l = s && s.index || e.length; var o = Er(e.slice(i, l), /(:?<tr[^>]*>)/i, "<tr>"); var c = -1, f = 0, u = 0, h = 0; var d = { s: { r: 1e7, c: 1e7 }, e: { r: 0, c: 0 } }; var m = []; for (i = 0; i < o.length; ++i) { var p = o[i].trim(); var v = p.slice(0, 3).toLowerCase(); if (v == "<tr") { ++c; if (t.sheetRows && t.sheetRows <= c) { --c; break } f = 0; continue } if (v != "<td" && v != "<th") continue; var b = p.split(/<\/t[dh]>/i); for (l = 0; l < b.length; ++l) { var w = b[l].trim(); if (!w.match(/<t[dh]/i)) continue; var k = w, y = 0; while (k.charAt(0) == "<" && (y = k.indexOf(">")) > -1) k = k.slice(y + 1); for (var x = 0; x < m.length; ++x) { var S = m[x]; if (S.s.c == f && S.s.r < c && c <= S.e.r) { f = S.e.c + 1; x = -1 } } var C = Jr(w.slice(0, w.indexOf(">"))); h = C.colspan ? +C.colspan : 1; if ((u = +C.rowspan) > 1 || h > 1) m.push({ s: { r: c, c: f }, e: { r: c + (u || 1) - 1, c: f + h - 1 } }); var _ = C.t || C["data-t"] || ""; if (!k.length) { f += h; continue } k = gt(k); if (d.s.r > c) d.s.r = c; if (d.e.r < c) d.e.r = c; if (d.s.c > f) d.s.c = f; if (d.e.c < f) d.e.c = f; if (!k.length) { f += h; continue } var A = { t: "s", v: k }; if (t.raw || !k.trim().length || _ == "s") { } else if (k === "TRUE") A = { t: "b", v: true }; else if (k === "FALSE") A = { t: "b", v: false }; else if (!isNaN(Sr(k))) A = { t: "n", v: Sr(k) }; else if (!isNaN(Fr(k).getDate())) { A = { t: "d", v: wr(k) }; if (!t.cellDates) A = { t: "n", v: fr(A.v) }; A.z = t.dateNF || Y[14] } if (t.dense) { if (!a[c]) a[c] = []; a[c][f] = A } else a[Ia({ r: c, c: f })] = A; f += h } } a["!ref"] = La(d); if (m.length) a["!merges"] = m; return a } function Zl(e, r, t, a) { var n = e["!merges"] || []; var s = []; var i = {}; for (var l = r.s.c; l <= r.e.c; ++l) { var o = 0, c = 0; for (var f = 0; f < n.length; ++f) { if (n[f].s.r > t || n[f].s.c > l) continue; if (n[f].e.r < t || n[f].e.c < l) continue; if (n[f].s.r < t || n[f].s.c < l) { o = -1; break } o = n[f].e.r - n[f].s.r + 1; c = n[f].e.c - n[f].s.c + 1; break } if (o < 0) continue; var u = Ia({ r: t, c: l }); var h = a.dense ? (e[t] || [])[l] : e[u]; var d = h && h.v != null && (h.h || st(h.w || (Ua(h), h.w) || "")) || ""; i = {}; if (o > 1) i.rowspan = o; if (c > 1) i.colspan = c; if (a.editable) d = '<span contenteditable="true">' + d + "</span>"; else if (h) { i["data-t"] = h && h.t || "z"; if (h.v != null) i["data-v"] = h.v; if (h.z != null) i["data-z"] = h.z; if (h.l && (h.l.Target || "#").charAt(0) != "#") d = '<a href="' + h.l.Target + '">' + d + "</a>" } i.id = (a.id || "sjs") + "-" + u; s.push(_t("td", d, i)) } var m = "<tr>"; return m + s.join("") + "</tr>" } var ql = '<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>'; var Ql = "</body></html>"; function eo(e, r) { var t = e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi); if (!t || t.length == 0) throw new Error("Invalid HTML: could not find <table>"); if (t.length == 1) return ja(Kl(t[0], r), r); var a = hc(); t.forEach(function (e, t) { dc(a, Kl(e, r), "Sheet" + (t + 1)) }); return a } function ro(e, r, t) { var a = []; return a.join("") + "<table" + (t && t.id ? ' id="' + t.id + '"' : "") + ">" } function to(e, r) { var t = r || {}; var a = t.header != null ? t.header : ql; var n = t.footer != null ? t.footer : Ql; var s = [a]; var i = Ra(e["!ref"]); t.dense = Array.isArray(e); s.push(ro(e, i, t)); for (var l = i.s.r; l <= i.e.r; ++l)s.push(Zl(e, i, l, t)); s.push("</table>" + n); return s.join("") } function ao(e, r, t) { var a = r.rows; if (!a) { throw "Unsupported origin when " + r.tagName + " is not a TABLE" } var n = t || {}; if (g != null) n.dense = g; var s = 0, i = 0; if (n.origin != null) { if (typeof n.origin == "number") s = n.origin; else { var l = typeof n.origin == "string" ? Pa(n.origin) : n.origin; s = l.r; i = l.c } } var o = Math.min(n.sheetRows || 1e7, a.length); var c = { s: { r: 0, c: 0 }, e: { r: s, c: i } }; if (e["!ref"]) { var f = Ra(e["!ref"]); c.s.r = Math.min(c.s.r, f.s.r); c.s.c = Math.min(c.s.c, f.s.c); c.e.r = Math.max(c.e.r, f.e.r); c.e.c = Math.max(c.e.c, f.e.c); if (s == -1) c.e.r = s = f.e.r + 1 } var u = [], h = 0; var d = e["!rows"] || (e["!rows"] = []); var m = 0, p = 0, v = 0, b = 0, w = 0, k = 0; if (!e["!cols"]) e["!cols"] = []; for (; m < a.length && p < o; ++m) { var y = a[m]; if (io(y)) { if (n.display) continue; d[p] = { hidden: true } } var x = y.cells; for (v = b = 0; v < x.length; ++v) { var S = x[v]; if (n.display && io(S)) continue; var C = S.hasAttribute("data-v") ? S.getAttribute("data-v") : S.hasAttribute("v") ? S.getAttribute("v") : gt(S.innerHTML); var _ = S.getAttribute("data-z") || S.getAttribute("z"); for (h = 0; h < u.length; ++h) { var A = u[h]; if (A.s.c == b + i && A.s.r < p + s && p + s <= A.e.r) { b = A.e.c + 1 - i; h = -1 } } k = +S.getAttribute("colspan") || 1; if ((w = +S.getAttribute("rowspan") || 1) > 1 || k > 1) u.push({ s: { r: p + s, c: b + i }, e: { r: p + s + (w || 1) - 1, c: b + i + (k || 1) - 1 } }); var F = { t: "s", v: C }; var E = S.getAttribute("data-t") || S.getAttribute("t") || ""; if (C != null) { if (C.length == 0) F.t = E || "z"; else if (n.raw || C.trim().length == 0 || E == "s") { } else if (C === "TRUE") F = { t: "b", v: true }; else if (C === "FALSE") F = { t: "b", v: false }; else if (!isNaN(Sr(C))) F = { t: "n", v: Sr(C) }; else if (!isNaN(Fr(C).getDate())) { F = { t: "d", v: wr(C) }; if (!n.cellDates) F = { t: "n", v: fr(F.v) }; F.z = n.dateNF || Y[14] } } if (F.z === undefined && _ != null) F.z = _; var T = "", D = S.getElementsByTagName("A"); if (D && D.length) for (var O = 0; O < D.length; ++O)if (D[O].hasAttribute("href")) { T = D[O].getAttribute("href"); if (T.charAt(0) != "#") break } if (T && T.charAt(0) != "#" && T.slice(0, 11).toLowerCase() != "javascript:") F.l = { Target: T }; if (n.dense) { if (!e[p + s]) e[p + s] = []; e[p + s][b + i] = F } else e[Ia({ c: b + i, r: p + s })] = F; if (c.e.c < b + i) c.e.c = b + i; b += k } ++p } if (u.length) e["!merges"] = (e["!merges"] || []).concat(u); c.e.r = Math.max(c.e.r, p - 1 + s); e["!ref"] = La(c); if (p >= o) e["!fullref"] = La((c.e.r = a.length - m + p - 1 + s, c)); return e } function no(e, r) { var t = r || {}; var a = t.dense ? [] : {}; return ao(a, e, r) } function so(e, r) { return ja(no(e, r), r) } function io(e) { var r = ""; var t = lo(e); if (t) r = t(e).getPropertyValue("display"); if (!r) r = e.style && e.style.display; return r === "none" } function lo(e) { if (e.ownerDocument.defaultView && typeof e.ownerDocument.defaultView.getComputedStyle === "function") return e.ownerDocument.defaultView.getComputedStyle; if (typeof getComputedStyle === "function") return getComputedStyle; return null } function oo(e) { var r = e.replace(/[\t\r\n]/g, " ").trim().replace(/ +/g, " ").replace(/<text:s\/>/g, " ").replace(/<text:s text:c="(\d+)"\/>/g, function (e, r) { return Array(parseInt(r, 10) + 1).join(" ") }).replace(/<text:tab[^>]*\/>/g, "\t").replace(/<text:line-break\/>/g, "\n"); var t = Qr(r.replace(/<[^>]*>/g, "")); return [t] } function co(e, r, t) { var a = t || {}; var n = Et(e); Tt.lastIndex = 0; n = n.replace(/<!--([\s\S]*?)-->/gm, "").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm, ""); var s, i, l = "", o = "", c, f = 0, u = -1, h = false, d = ""; while (s = Tt.exec(n)) { switch (s[3] = s[3].replace(/_.*$/, "")) { case "number-style": ; case "currency-style": ; case "percentage-style": ; case "date-style": ; case "time-style": ; case "text-style": if (s[1] === "/") { h = false; if (i["truncate-on-overflow"] == "false") { if (l.match(/h/)) l = l.replace(/h+/, "[$&]"); else if (l.match(/m/)) l = l.replace(/m+/, "[$&]"); else if (l.match(/s/)) l = l.replace(/s+/, "[$&]") } a[i.name] = l; l = "" } else if (s[0].charAt(s[0].length - 2) !== "/") { h = true; l = ""; i = Jr(s[0], false) } break; case "boolean-style": if (s[1] === "/") { h = false; a[i.name] = "General"; l = "" } else if (s[0].charAt(s[0].length - 2) !== "/") { h = true; l = ""; i = Jr(s[0], false) } break; case "boolean": l += "General"; break; case "text": if (s[1] === "/") { d = n.slice(u, Tt.lastIndex - s[0].length); if (d == "%" && i[0] == "<number:percentage-style") l += "%"; else l += '"' + d.replace(/"/g, '""') + '"' } else if (s[0].charAt(s[0].length - 2) !== "/") { u = Tt.lastIndex } break; case "day": { c = Jr(s[0], false); switch (c["style"]) { case "short": l += "d"; break; case "long": l += "dd"; break; default: l += "dd"; break; } } break; case "day-of-week": { c = Jr(s[0], false); switch (c["style"]) { case "short": l += "ddd"; break; case "long": l += "dddd"; break; default: l += "ddd"; break; } } break; case "era": { c = Jr(s[0], false); switch (c["style"]) { case "short": l += "ee"; break; case "long": l += "eeee"; break; default: l += "eeee"; break; } } break; case "hours": { c = Jr(s[0], false); switch (c["style"]) { case "short": l += "h"; break; case "long": l += "hh"; break; default: l += "hh"; break; } } break; case "minutes": { c = Jr(s[0], false); switch (c["style"]) { case "short": l += "m"; break; case "long": l += "mm"; break; default: l += "mm"; break; } } break; case "month": { c = Jr(s[0], false); if (c["textual"]) l += "mm"; switch (c["style"]) { case "short": l += "m"; break; case "long": l += "mm"; break; default: l += "m"; break; } } break; case "seconds": { c = Jr(s[0], false); switch (c["style"]) { case "short": l += "s"; break; case "long": l += "ss"; break; default: l += "ss"; break; }if (c["decimal-places"]) l += "." + xr("0", +c["decimal-places"]) } break; case "year": { c = Jr(s[0], false); switch (c["style"]) { case "short": l += "yy"; break; case "long": l += "yyyy"; break; default: l += "yy"; break; } } break; case "am-pm": l += "AM/PM"; break; case "week-of-year": ; case "quarter": console.error("Excel does not support ODS format token " + s[3]); break; case "fill-character": if (s[1] === "/") { d = n.slice(u, Tt.lastIndex - s[0].length); l += '"' + d.replace(/"/g, '""') + '"*' } else if (s[0].charAt(s[0].length - 2) !== "/") { u = Tt.lastIndex } break; case "scientific-number": c = Jr(s[0], false); l += "0." + xr("0", +c["min-decimal-places"] || +c["decimal-places"] || 2) + xr("?", +c["decimal-places"] - +c["min-decimal-places"] || 0) + "E" + (ct(c["forced-exponent-sign"]) ? "+" : "") + xr("0", +c["min-exponent-digits"] || 2); break; case "fraction": c = Jr(s[0], false); if (!+c["min-integer-digits"]) l += "#"; else l += xr("0", +c["min-integer-digits"]); l += " "; l += xr("?", +c["min-numerator-digits"] || 1); l += "/"; if (+c["denominator-value"]) l += c["denominator-value"]; else l += xr("?", +c["min-denominator-digits"] || 1); break; case "currency-symbol": if (s[1] === "/") { l += '"' + n.slice(u, Tt.lastIndex - s[0].length).replace(/"/g, '""') + '"' } else if (s[0].charAt(s[0].length - 2) !== "/") { u = Tt.lastIndex } else l += "$"; break; case "text-properties": c = Jr(s[0], false); switch ((c["color"] || "").toLowerCase().replace("#", "")) { case "ff0000": ; case "red": l = "[Red]" + l; break; }break; case "text-content": l += "@"; break; case "map": c = Jr(s[0], false); if (Qr(c["condition"]) == "value()>=0") l = a[c["apply-style-name"]] + ";" + l; else console.error("ODS number format may be incorrect: " + c["condition"]); break; case "number": if (s[1] === "/") break; c = Jr(s[0], false); o = ""; o += xr("0", +c["min-integer-digits"] || 1); if (ct(c["grouping"])) o = ue(xr("#", Math.max(0, 4 - o.length)) + o); if (+c["min-decimal-places"] || +c["decimal-places"]) o += "."; if (+c["min-decimal-places"]) o += xr("0", +c["min-decimal-places"] || 1); if (+c["decimal-places"] - (+c["min-decimal-places"] || 0)) o += xr("0", +c["decimal-places"] - (+c["min-decimal-places"] || 0)); l += o; break; case "embedded-text": if (s[1] === "/") { if (f == 0) l += '"' + n.slice(u, Tt.lastIndex - s[0].length).replace(/"/g, '""') + '"'; else l = l.slice(0, f) + '"' + n.slice(u, Tt.lastIndex - s[0].length).replace(/"/g, '""') + '"' + l.slice(f) } else if (s[0].charAt(s[0].length - 2) !== "/") { u = Tt.lastIndex; f = -+Jr(s[0], false)["position"] || 0 } break; } } return a } function fo(e, r, t) { var a = r || {}; if (g != null && a.dense == null) a.dense = g; var n = Et(e); var s = [], i; var l; var o, c = "", f = 0; var u; var h; var d = {}, m = []; var p = a.dense ? [] : {}; var v, b; var w = { value: "" }; var k = "", y = 0, x; var S = []; var C = -1, _ = -1, A = { s: { r: 1e6, c: 1e7 }, e: { r: 0, c: 0 } }; var F = 0; var E = t || {}, T = {}; var D = [], O = {}, M = 0, N = 0; var P = [], I = 1, R = 1; var L = []; var B = { Names: [], WBProps: {} }; var z = {}; var $ = ["", ""]; var W = [], U = {}; var j = "", H = 0; var V = false, X = false; var G = 0; var Y = 0; Tt.lastIndex = 0; n = n.replace(/<!--([\s\S]*?)-->/gm, "").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm, ""); while (v = Tt.exec(n)) switch (v[3] = v[3].replace(/_.*$/, "")) { case "table": ; case "工作表": if (v[1] === "/") { if (A.e.c >= A.s.c && A.e.r >= A.s.r) p["!ref"] = La(A); else p["!ref"] = "A1:A1"; if (a.sheetRows > 0 && a.sheetRows <= A.e.r) { p["!fullref"] = p["!ref"]; A.e.r = a.sheetRows - 1; p["!ref"] = La(A) } if (D.length) p["!merges"] = D; if (P.length) p["!rows"] = P; u.name = u["名称"] || u.name; if (typeof JSON !== "undefined") JSON.stringify(u); m.push(u.name); d[u.name] = p; X = false } else if (v[0].charAt(v[0].length - 2) !== "/") { u = Jr(v[0], false); C = _ = -1; A.s.r = A.s.c = 1e7; A.e.r = A.e.c = 0; p = a.dense ? [] : {}; D = []; P = []; X = true } break; case "table-row-group": if (v[1] === "/") --F; else ++F; break; case "table-row": ; case "行": if (v[1] === "/") { C += I; I = 1; break } h = Jr(v[0], false); if (h["行号"]) C = h["行号"] - 1; else if (C == -1) C = 0; I = +h["number-rows-repeated"] || 1; if (I < 10) for (G = 0; G < I; ++G)if (F > 0) P[C + G] = { level: F }; _ = -1; break; case "covered-table-cell": if (v[1] !== "/") ++_; if (a.sheetStubs) { if (a.dense) { if (!p[C]) p[C] = []; p[C][_] = { t: "z" } } else p[Ia({ r: C, c: _ })] = { t: "z" } } k = ""; S = []; break; case "table-cell": ; case "数据": if (v[0].charAt(v[0].length - 2) === "/") { ++_; w = Jr(v[0], false); R = parseInt(w["number-columns-repeated"] || "1", 10); b = { t: "z", v: null }; if (w.formula && a.cellFormula != false) b.f = Ti(Qr(w.formula)); if (w["style-name"] && T[w["style-name"]]) b.z = T[w["style-name"]]; if ((w["数据类型"] || w["value-type"]) == "string") { b.t = "s"; b.v = Qr(w["string-value"] || ""); if (a.dense) { if (!p[C]) p[C] = []; p[C][_] = b } else { p[Ia({ r: C, c: _ })] = b } } _ += R - 1 } else if (v[1] !== "/") { ++_; k = ""; y = 0; S = []; R = 1; var J = I ? C + I - 1 : C; if (_ > A.e.c) A.e.c = _; if (_ < A.s.c) A.s.c = _; if (C < A.s.r) A.s.r = C; if (J > A.e.r) A.e.r = J; w = Jr(v[0], false); W = []; U = {}; b = { t: w["数据类型"] || w["value-type"], v: null }; if (w["style-name"] && T[w["style-name"]]) b.z = T[w["style-name"]]; if (a.cellFormula) { if (w.formula) w.formula = Qr(w.formula); if (w["number-matrix-columns-spanned"] && w["number-matrix-rows-spanned"]) { M = parseInt(w["number-matrix-rows-spanned"], 10) || 0; N = parseInt(w["number-matrix-columns-spanned"], 10) || 0; O = { s: { r: C, c: _ }, e: { r: C + M - 1, c: _ + N - 1 } }; b.F = La(O); L.push([O, b.F]) } if (w.formula) b.f = Ti(w.formula); else for (G = 0; G < L.length; ++G)if (C >= L[G][0].s.r && C <= L[G][0].e.r) if (_ >= L[G][0].s.c && _ <= L[G][0].e.c) b.F = L[G][1] } if (w["number-columns-spanned"] || w["number-rows-spanned"]) { M = parseInt(w["number-rows-spanned"], 10) || 0; N = parseInt(w["number-columns-spanned"], 10) || 0; O = { s: { r: C, c: _ }, e: { r: C + M - 1, c: _ + N - 1 } }; D.push(O) } if (w["number-columns-repeated"]) R = parseInt(w["number-columns-repeated"], 10); switch (b.t) { case "boolean": b.t = "b"; b.v = ct(w["boolean-value"]) || +w["boolean-value"] >= 1; break; case "float": b.t = "n"; b.v = parseFloat(w.value); break; case "percentage": b.t = "n"; b.v = parseFloat(w.value); break; case "currency": b.t = "n"; b.v = parseFloat(w.value); break; case "date": b.t = "d"; b.v = wr(w["date-value"]); if (!a.cellDates) { b.t = "n"; b.v = fr(b.v, B.WBProps.date1904) - Y } if (!b.z) b.z = "m/d/yy"; break; case "time": b.t = "n"; b.v = pr(w["time-value"]) / 86400; if (a.cellDates) { b.t = "d"; b.v = mr(b.v) } if (!b.z) b.z = "HH:MM:SS"; break; case "number": b.t = "n"; b.v = parseFloat(w["数据数值"]); break; default: if (b.t === "string" || b.t === "text" || !b.t) { b.t = "s"; if (w["string-value"] != null) { k = Qr(w["string-value"]); S = [] } } else throw new Error("Unsupported value type " + b.t); } } else { V = false; if (b.t === "s") { b.v = k || ""; if (S.length) b.R = S; V = y == 0 } if (z.Target) b.l = z; if (W.length > 0) { b.c = W; W = [] } if (k && a.cellText !== false) b.w = k; if (V) { b.t = "z"; delete b.v } if (!V || a.sheetStubs) { if (!(a.sheetRows && a.sheetRows <= C)) { for (var K = 0; K < I; ++K) { R = parseInt(w["number-columns-repeated"] || "1", 10); if (a.dense) { if (!p[C + K]) p[C + K] = []; p[C + K][_] = K == 0 ? b : yr(b); while (--R > 0) p[C + K][_ + R] = yr(b) } else { p[Ia({ r: C + K, c: _ })] = b; while (--R > 0) p[Ia({ r: C + K, c: _ + R })] = yr(b) } if (A.e.c <= _) A.e.c = _ } } } R = parseInt(w["number-columns-repeated"] || "1", 10); _ += R - 1; R = 0; b = {}; k = ""; S = [] } z = {}; break; case "document": ; case "document-content": ; case "电子表格文档": ; case "spreadsheet": ; case "主体": ; case "scripts": ; case "styles": ; case "font-face-decls": ; case "master-styles": if (v[1] === "/") { if ((i = s.pop())[0] !== v[3]) throw "Bad state: " + i } else if (v[0].charAt(v[0].length - 2) !== "/") s.push([v[3], true]); break; case "annotation": if (v[1] === "/") { if ((i = s.pop())[0] !== v[3]) throw "Bad state: " + i; U.t = k; if (S.length) U.R = S; U.a = j; W.push(U) } else if (v[0].charAt(v[0].length - 2) !== "/") { s.push([v[3], false]) } j = ""; H = 0; k = ""; y = 0; S = []; break; case "creator": if (v[1] === "/") { j = n.slice(H, v.index) } else H = v.index + v[0].length; break; case "meta": ; case "元数据": ; case "settings": ; case "config-item-set": ; case "config-item-map-indexed": ; case "config-item-map-entry": ; case "config-item-map-named": ; case "shapes": ; case "frame": ; case "text-box": ; case "image": ; case "data-pilot-tables": ; case "list-style": ; case "form": ; case "dde-links": ; case "event-listeners": ; case "chart": if (v[1] === "/") { if ((i = s.pop())[0] !== v[3]) throw "Bad state: " + i } else if (v[0].charAt(v[0].length - 2) !== "/") s.push([v[3], false]); k = ""; y = 0; S = []; break; case "scientific-number": ; case "currency-symbol": ; case "fill-character": break; case "text-style": ; case "boolean-style": ; case "number-style": ; case "currency-style": ; case "percentage-style": ; case "date-style": ; case "time-style": if (v[1] === "/") { var Z = Tt.lastIndex; co(n.slice(o, Tt.lastIndex), r, E); Tt.lastIndex = Z } else if (v[0].charAt(v[0].length - 2) !== "/") { o = Tt.lastIndex - v[0].length } break; case "script": break; case "libraries": break; case "automatic-styles": break; case "default-style": ; case "page-layout": break; case "style": { var q = Jr(v[0], false); if (q["family"] == "table-cell" && E[q["data-style-name"]]) T[q["name"]] = E[q["data-style-name"]] } break; case "map": break; case "font-face": break; case "paragraph-properties": break; case "table-properties": break; case "table-column-properties": break; case "table-row-properties": break; case "table-cell-properties": break; case "number": break; case "fraction": break; case "day": ; case "month": ; case "year": ; case "era": ; case "day-of-week": ; case "week-of-year": ; case "quarter": ; case "hours": ; case "minutes": ; case "seconds": ; case "am-pm": break; case "boolean": break; case "text": if (v[0].slice(-2) === "/>") break; else if (v[1] === "/") switch (s[s.length - 1][0]) { case "number-style": ; case "date-style": ; case "time-style": c += n.slice(f, v.index); break; } else f = v.index + v[0].length; break; case "named-range": l = Jr(v[0], false); $ = Oi(l["cell-range-address"]); var Q = { Name: l.name, Ref: $[0] + "!" + $[1] }; if (X) Q.Sheet = m.length; B.Names.push(Q); break; case "text-content": break; case "text-properties": break; case "embedded-text": break; case "body": ; case "电子表格": break; case "forms": break; case "table-column": break; case "table-header-rows": break; case "table-rows": break; case "table-column-group": break; case "table-header-columns": break; case "table-columns": break; case "null-date": l = Jr(v[0], false); switch (l["date-value"]) { case "1904-01-01": B.WBProps.date1904 = true; case "1900-01-01": Y = 0; }break; case "graphic-properties": break; case "calculation-settings": break; case "named-expressions": break; case "label-range": break; case "label-ranges": break; case "named-expression": break; case "sort": break; case "sort-by": break; case "sort-groups": break; case "tab": break; case "line-break": break; case "span": break; case "p": ; case "文本串": if (["master-styles"].indexOf(s[s.length - 1][0]) > -1) break; if (v[1] === "/" && (!w || !w["string-value"])) { var ee = oo(n.slice(y, v.index), x); k = (k.length > 0 ? k + "\n" : "") + ee[0] } else { x = Jr(v[0], false); y = v.index + v[0].length } break; case "s": break; case "database-range": if (v[1] === "/") break; try { $ = Oi(Jr(v[0])["target-range-address"]); d[$[0]]["!autofilter"] = { ref: $[1] } } catch (re) { } break; case "date": break; case "object": break; case "title": ; case "标题": break; case "desc": break; case "binary-data": break; case "table-source": break; case "scenario": break; case "iteration": break; case "content-validations": break; case "content-validation": break; case "help-message": break; case "error-message": break; case "database-ranges": break; case "filter": break; case "filter-and": break; case "filter-or": break; case "filter-condition": break; case "list-level-style-bullet": break; case "list-level-style-number": break; case "list-level-properties": break; case "sender-firstname": ; case "sender-lastname": ; case "sender-initials": ; case "sender-title": ; case "sender-position": ; case "sender-email": ; case "sender-phone-private": ; case "sender-fax": ; case "sender-company": ; case "sender-phone-work": ; case "sender-street": ; case "sender-city": ; case "sender-postal-code": ; case "sender-country": ; case "sender-state-or-province": ; case "author-name": ; case "author-initials": ; case "chapter": ; case "file-name": ; case "template-name": ; case "sheet-name": break; case "event-listener": break; case "initial-creator": ; case "creation-date": ; case "print-date": ; case "generator": ; case "document-statistic": ; case "user-defined": ; case "editing-duration": ; case "editing-cycles": break; case "config-item": break; case "page-number": break; case "page-count": break; case "time": break; case "cell-range-source": break; case "detective": break; case "operation": break; case "highlighted-range": break; case "data-pilot-table": ; case "source-cell-range": ; case "source-service": ; case "data-pilot-field": ; case "data-pilot-level": ; case "data-pilot-subtotals": ; case "data-pilot-subtotal": ; case "data-pilot-members": ; case "data-pilot-member": ; case "data-pilot-display-info": ; case "data-pilot-sort-info": ; case "data-pilot-layout-info": ; case "data-pilot-field-reference": ; case "data-pilot-groups": ; case "data-pilot-group": ; case "data-pilot-group-member": break; case "rect": break; case "dde-connection-decls": ; case "dde-connection-decl": ; case "dde-link": ; case "dde-source": break; case "properties": break; case "property": break; case "a": if (v[1] !== "/") { z = Jr(v[0], false); if (!z.href) break; z.Target = Qr(z.href); delete z.href; if (z.Target.charAt(0) == "#" && z.Target.indexOf(".") > -1) { $ = Oi(z.Target.slice(1)); z.Target = "#" + $[0] + "!" + $[1] } else if (z.Target.match(/^\.\.[\\\/]/)) z.Target = z.Target.slice(3) } break; case "table-protection": break; case "data-pilot-grand-total": break; case "office-document-common-attrs": break; default: switch (v[2]) { case "dc:": ; case "calcext:": ; case "loext:": ; case "ooo:": ; case "chartooo:": ; case "draw:": ; case "style:": ; case "chart:": ; case "form:": ; case "uof:": ; case "表:": ; case "字:": break; default: if (a.WTF) throw new Error(v); }; }var te = { Sheets: d, SheetNames: m, Workbook: B }; if (a.bookSheets) delete te.Sheets; return te } function uo(e, r) { r = r || {}; if (Mr(e, "META-INF/manifest.xml")) Fn(Pr(e, "META-INF/manifest.xml"), r); var t = Ir(e, "styles.xml"); var a = t && co(mt(t), r); var n = Ir(e, "content.xml"); if (!n) throw new Error("Missing content.xml in ODS / UOF file"); var s = fo(mt(n), r, a); if (Mr(e, "meta.xml")) s.Props = In(Pr(e, "meta.xml")); return s } function ho(e, r) { return fo(e, r) } var mo = function () { var e = ["<office:master-styles>", '<style:master-page style:name="mp1" style:page-layout-name="mp1">', "<style:header/>", '<style:header-left style:display="false"/>', "<style:footer/>", '<style:footer-left style:display="false"/>', "</style:master-page>", "</office:master-styles>"].join(""); var r = "<office:document-styles " + Ct({ "xmlns:office": "urn:oasis:names:tc:opendocument:xmlns:office:1.0", "xmlns:table": "urn:oasis:names:tc:opendocument:xmlns:table:1.0", "xmlns:style": "urn:oasis:names:tc:opendocument:xmlns:style:1.0", "xmlns:text": "urn:oasis:names:tc:opendocument:xmlns:text:1.0", "xmlns:draw": "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0", "xmlns:fo": "urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0", "xmlns:xlink": "http://www.w3.org/1999/xlink", "xmlns:dc": "http://purl.org/dc/elements/1.1/", "xmlns:number": "urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0", "xmlns:svg": "urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0", "xmlns:of": "urn:oasis:names:tc:opendocument:xmlns:of:1.2", "office:version": "1.2" }) + ">" + e + "</office:document-styles>"; return function t() { return Ur + r } }(); function po(e, r) {
        var t = "number", a = "", n = { "style:name": r }, s = "", i = 0; e = e.replace(/"[$]"/g, "$"); e: {
            if (e.indexOf(";") > -1) { console.error("Unsupported ODS Style Map exported.  Using first branch of " + e); e = e.slice(0, e.indexOf(";")) } if (e == "@") { t = "text"; a = "<number:text-content/>"; break e } if (e.indexOf(/\$/) > -1) { t = "currency" } if (e[i] == '"') { s = ""; while (e[++i] != '"' || e[++i] == '"') s += e[i]; --i; if (e[i + 1] == "*") { i++; a += "<number:fill-character>" + tt(s.replace(/""/g, '"')) + "</number:fill-character>" } else { a += "<number:text>" + tt(s.replace(/""/g, '"')) + "</number:text>" } e = e.slice(i + 1); i = 0 } var l = e.match(/# (\?+)\/(\?+)/); if (l) { a += _t("number:fraction", null, { "number:min-integer-digits": 0, "number:min-numerator-digits": l[1].length, "number:max-denominator-value": Math.max(+l[1].replace(/./g, "9"), +l[2].replace(/./g, "9")) }); break e } if (l = e.match(/# (\?+)\/(\d+)/)) { a += _t("number:fraction", null, { "number:min-integer-digits": 0, "number:min-numerator-digits": l[1].length, "number:denominator-value": +l[2] }); break e } if (l = e.match(/(\d+)(|\.\d+)%/)) { t = "percentage"; a += _t("number:number", null, { "number:decimal-places": l[2] && l.length - 1 || 0, "number:min-decimal-places": l[2] && l.length - 1 || 0, "number:min-integer-digits": l[1].length }) + "<number:text>%</number:text>"; break e } var o = false; if (["y", "m", "d"].indexOf(e[0]) > -1) {
                t = "date"; r: for (; i < e.length; ++i)switch (s = e[i].toLowerCase()) {
                    case "h": ; case "s": o = true; --i; break r; case "m": t: for (var c = i + 1; c < e.length; ++c)switch (e[c]) { case "y": ; case "d": break t; case "h": ; case "s": o = true; --i; break r; }; case "y": ; case "d": while ((e[++i] || "").toLowerCase() == s[0]) s += s[0]; --i; switch (s) {
                        case "y": ; case "yy": a += "<number:year/>"; break; case "yyy": ; case "yyyy": a += '<number:year number:style="long"/>'; break; case "mmmmm": console.error("ODS has no equivalent of format |mmmmm|"); case "m": ; case "mm": ; case "mmm": ; case "mmmm": a += '<number:month number:style="' + (s.length % 2 ? "short" : "long") + '" number:textual="' + (s.length >= 3 ? "true" : "false") + '"/>'; break; case "d": ; case "dd": a += '<number:day number:style="' + (s.length % 2 ? "short" : "long") + '"/>';
                            break; case "ddd": ; case "dddd": a += '<number:day-of-week number:style="' + (s.length % 2 ? "short" : "long") + '"/>'; break;
                    }break; case '"': while (e[++i] != '"' || e[++i] == '"') s += e[i]; --i; a += "<number:text>" + tt(s.slice(1).replace(/""/g, '"')) + "</number:text>"; break; case "/": a += "<number:text>" + tt(s) + "</number:text>"; break; default: console.error("unrecognized character " + s + " in ODF format " + e);
                }if (!o) break e; e = e.slice(i + 1); i = 0
            } if (e.match(/^\[?[hms]/)) { if (t == "number") t = "time"; if (e.match(/\[/)) { e = e.replace(/[\[\]]/g, ""); n["number:truncate-on-overflow"] = "false" } for (; i < e.length; ++i)switch (s = e[i].toLowerCase()) { case "h": ; case "m": ; case "s": while ((e[++i] || "").toLowerCase() == s[0]) s += s[0]; --i; switch (s) { case "h": ; case "hh": a += '<number:hours number:style="' + (s.length % 2 ? "short" : "long") + '"/>'; break; case "m": ; case "mm": a += '<number:minutes number:style="' + (s.length % 2 ? "short" : "long") + '"/>'; break; case "s": ; case "ss": if (e[i + 1] == ".") do { s += e[i + 1]; ++i } while (e[i + 1] == "0"); a += '<number:seconds number:style="' + (s.match("ss") ? "long" : "short") + '"' + (s.match(/\./) ? ' number:decimal-places="' + (s.match(/0+/) || [""])[0].length + '"' : "") + "/>"; break; }break; case '"': while (e[++i] != '"' || e[++i] == '"') s += e[i]; --i; a += "<number:text>" + tt(s.slice(1).replace(/""/g, '"')) + "</number:text>"; break; case "/": a += "<number:text>" + tt(s) + "</number:text>"; break; case "a": if (e.slice(i, i + 3).toLowerCase() == "a/p") { a += "<number:am-pm/>"; i += 2; break } if (e.slice(i, i + 5).toLowerCase() == "am/pm") { a += "<number:am-pm/>"; i += 4; break }; default: console.error("unrecognized character " + s + " in ODF format " + e); }break e } if (e.indexOf(/\$/) > -1) { t = "currency" } if (e[0] == "$") { a += '<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>'; e = e.slice(1); i = 0 } i = 0; if (e[i] == '"') { while (e[++i] != '"' || e[++i] == '"') s += e[i]; --i; if (e[i + 1] == "*") { i++; a += "<number:fill-character>" + tt(s.replace(/""/g, '"')) + "</number:fill-character>" } else { a += "<number:text>" + tt(s.replace(/""/g, '"')) + "</number:text>" } e = e.slice(i + 1); i = 0 } var f = e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i); if (!f || !f[0]) console.error("Could not find numeric part of " + e); else { var u = f[1].replace(/,/g, ""); a += "<number:" + (f[3] ? "scientific-" : "") + "number" + ' number:min-integer-digits="' + (u.indexOf("0") == -1 ? "0" : u.length - u.indexOf("0")) + '"' + (f[0].indexOf(",") > -1 ? ' number:grouping="true"' : "") + (f[2] && ' number:decimal-places="' + (f[2].length - 1) + '"' || ' number:decimal-places="0"') + (f[3] && f[3].indexOf("+") > -1 ? ' number:forced-exponent-sign="true"' : "") + (f[3] ? ' number:min-exponent-digits="' + f[3].match(/0+/)[0].length + '"' : "") + ">" + "</number:" + (f[3] ? "scientific-" : "") + "number>"; i = f.index + f[0].length } if (e[i] == '"') { s = ""; while (e[++i] != '"' || e[++i] == '"') s += e[i]; --i; a += "<number:text>" + tt(s.replace(/""/g, '"')) + "</number:text>" }
        } if (!a) { console.error("Could not generate ODS number format for |" + e + "|"); return "" } return _t("number:" + t + "-style", a, n)
    } function vo(e, r, t) { var a = e.filter(function (e) { return e.Sheet == (t == -1 ? null : t) }); if (!a.length) return ""; return "      <table:named-expressions>\n" + a.map(function (e) { var r = Mi(e.Ref); return "        " + _t("table:named-range", null, { "table:name": e.Name, "table:cell-range-address": r, "table:base-cell-address": r.replace(/[\.]?[^\.]*$/, ".$A$1") }) }).join("\n") + "\n      </table:named-expressions>\n" } var go = function () { var e = function (e) { return tt(e).replace(/  +/g, function (e) { return '<text:s text:c="' + e.length + '"/>' }).replace(/\t/g, "<text:tab/>").replace(/\n/g, "</text:p><text:p>").replace(/^ /, "<text:s/>").replace(/ $/, "<text:s/>") }; var r = "          <table:table-cell />\n"; var t = "          <table:covered-table-cell/>\n"; var a = function (a, n, s, i, l) { var o = []; o.push('      <table:table table:name="' + tt(n.SheetNames[s]) + '" table:style-name="ta1">\n'); var c = 0, f = 0, u = Ra(a["!ref"] || "A1"); var h = a["!merges"] || [], d = 0; var m = Array.isArray(a); if (a["!cols"]) { for (f = 0; f <= u.e.c; ++f)o.push("        <table:table-column" + (a["!cols"][f] ? ' table:style-name="co' + a["!cols"][f].ods + '"' : "") + "></table:table-column>\n") } var p = "", v = a["!rows"] || []; for (c = 0; c < u.s.r; ++c) { p = v[c] ? ' table:style-name="ro' + v[c].ods + '"' : ""; o.push("        <table:table-row" + p + "></table:table-row>\n") } for (; c <= u.e.r; ++c) { p = v[c] ? ' table:style-name="ro' + v[c].ods + '"' : ""; o.push("        <table:table-row" + p + ">\n"); for (f = 0; f < u.s.c; ++f)o.push(r); for (; f <= u.e.c; ++f) { var g = false, b = {}, w = ""; for (d = 0; d != h.length; ++d) { if (h[d].s.c > f) continue; if (h[d].s.r > c) continue; if (h[d].e.c < f) continue; if (h[d].e.r < c) continue; if (h[d].s.c != f || h[d].s.r != c) g = true; b["table:number-columns-spanned"] = h[d].e.c - h[d].s.c + 1; b["table:number-rows-spanned"] = h[d].e.r - h[d].s.r + 1; break } if (g) { o.push(t); continue } var k = Ia({ r: c, c: f }), y = m ? (a[c] || [])[f] : a[k]; if (y && y.f) { b["table:formula"] = tt(Di(y.f)); if (y.F) { if (y.F.slice(0, k.length) == k) { var x = Ra(y.F); b["table:number-matrix-columns-spanned"] = x.e.c - x.s.c + 1; b["table:number-matrix-rows-spanned"] = x.e.r - x.s.r + 1 } } } if (!y) { o.push(r); continue } switch (y.t) { case "b": w = y.v ? "TRUE" : "FALSE"; b["office:value-type"] = "boolean"; b["office:boolean-value"] = y.v ? "true" : "false"; break; case "n": w = y.w || String(y.v || 0); b["office:value-type"] = "float"; b["office:value"] = y.v || 0; break; case "s": ; case "str": w = y.v == null ? "" : y.v; b["office:value-type"] = "string"; break; case "d": w = y.w || wr(y.v).toISOString(); b["office:value-type"] = "date"; b["office:date-value"] = wr(y.v).toISOString(); b["table:style-name"] = "ce1"; break; default: o.push(r); continue; }var S = e(w); if (y.l && y.l.Target) { var C = y.l.Target; C = C.charAt(0) == "#" ? "#" + Mi(C.slice(1)) : C; if (C.charAt(0) != "#" && !C.match(/^\w+:/)) C = "../" + C; S = _t("text:a", S, { "xlink:href": C.replace(/&/g, "&amp;") }) } if (l[y.z]) b["table:style-name"] = "ce" + l[y.z].slice(1); o.push("          " + _t("table:table-cell", _t("text:p", S, {}), b) + "\n") } o.push("        </table:table-row>\n") } if ((n.Workbook || {}).Names) o.push(vo(n.Workbook.Names, n.SheetNames, s)); o.push("      </table:table>\n"); return o.join("") }; var n = function (e, r) { e.push(" <office:automatic-styles>\n"); var t = 0; r.SheetNames.map(function (e) { return r.Sheets[e] }).forEach(function (r) { if (!r) return; if (r["!cols"]) { for (var a = 0; a < r["!cols"].length; ++a)if (r["!cols"][a]) { var n = r["!cols"][a]; if (n.width == null && n.wpx == null && n.wch == null) continue; As(n); n.ods = t; var s = r["!cols"][a].wpx + "px"; e.push('  <style:style style:name="co' + t + '" style:family="table-column">\n'); e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="' + s + '"/>\n'); e.push("  </style:style>\n"); ++t } } }); var a = 0; r.SheetNames.map(function (e) { return r.Sheets[e] }).forEach(function (r) { if (!r) return; if (r["!rows"]) { for (var t = 0; t < r["!rows"].length; ++t)if (r["!rows"][t]) { r["!rows"][t].ods = a; var n = r["!rows"][t].hpx + "px"; e.push('  <style:style style:name="ro' + a + '" style:family="table-row">\n'); e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="' + n + '"/>\n'); e.push("  </style:style>\n"); ++a } } }); e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'); e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'); e.push("  </style:style>\n"); e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'); e.push('   <number:month number:style="long"/>\n'); e.push("   <number:text>/</number:text>\n"); e.push('   <number:day number:style="long"/>\n'); e.push("   <number:text>/</number:text>\n"); e.push("   <number:year/>\n"); e.push("  </number:date-style>\n"); var n = {}; var s = 69; r.SheetNames.map(function (e) { return r.Sheets[e] }).forEach(function (r) { if (!r) return; var t = Ra(r["!ref"]); for (var a = 0; a <= t.e.r; ++a)for (var i = 0; i <= t.e.c; ++i) { var l = Array.isArray(r) ? (r[a] || [])[i] : r[Ia({ r: a, c: i })]; if (!l || !l.z || l.z.toLowerCase() == "general") continue; if (!n[l.z]) { var o = po(l.z, "N" + s); if (o) { n[l.z] = "N" + s; ++s; e.push(o + "\n") } } } }); e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'); nr(n).forEach(function (r) { e.push('<style:style style:name="ce' + n[r].slice(1) + '" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="' + n[r] + '"/>\n') }); e.push(" </office:automatic-styles>\n"); return n }; return function s(e, r) { var t = [Ur]; var s = Ct({ "xmlns:office": "urn:oasis:names:tc:opendocument:xmlns:office:1.0", "xmlns:table": "urn:oasis:names:tc:opendocument:xmlns:table:1.0", "xmlns:style": "urn:oasis:names:tc:opendocument:xmlns:style:1.0", "xmlns:text": "urn:oasis:names:tc:opendocument:xmlns:text:1.0", "xmlns:draw": "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0", "xmlns:fo": "urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0", "xmlns:xlink": "http://www.w3.org/1999/xlink", "xmlns:dc": "http://purl.org/dc/elements/1.1/", "xmlns:meta": "urn:oasis:names:tc:opendocument:xmlns:meta:1.0", "xmlns:number": "urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0", "xmlns:presentation": "urn:oasis:names:tc:opendocument:xmlns:presentation:1.0", "xmlns:svg": "urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0", "xmlns:chart": "urn:oasis:names:tc:opendocument:xmlns:chart:1.0", "xmlns:dr3d": "urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0", "xmlns:math": "http://www.w3.org/1998/Math/MathML", "xmlns:form": "urn:oasis:names:tc:opendocument:xmlns:form:1.0", "xmlns:script": "urn:oasis:names:tc:opendocument:xmlns:script:1.0", "xmlns:ooo": "http://openoffice.org/2004/office", "xmlns:ooow": "http://openoffice.org/2004/writer", "xmlns:oooc": "http://openoffice.org/2004/calc", "xmlns:dom": "http://www.w3.org/2001/xml-events", "xmlns:xforms": "http://www.w3.org/2002/xforms", "xmlns:xsd": "http://www.w3.org/2001/XMLSchema", "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance", "xmlns:sheet": "urn:oasis:names:tc:opendocument:sh33tjs:1.0", "xmlns:rpt": "http://openoffice.org/2005/report", "xmlns:of": "urn:oasis:names:tc:opendocument:xmlns:of:1.2", "xmlns:xhtml": "http://www.w3.org/1999/xhtml", "xmlns:grddl": "http://www.w3.org/2003/g/data-view#", "xmlns:tableooo": "http://openoffice.org/2009/table", "xmlns:drawooo": "http://openoffice.org/2010/draw", "xmlns:calcext": "urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0", "xmlns:loext": "urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0", "xmlns:field": "urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0", "xmlns:formx": "urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0", "xmlns:css3t": "http://www.w3.org/TR/css3-text/", "office:version": "1.2" }); var i = Ct({ "xmlns:config": "urn:oasis:names:tc:opendocument:xmlns:config:1.0", "office:mimetype": "application/vnd.oasis.opendocument.spreadsheet" }); if (r.bookType == "fods") { t.push("<office:document" + s + i + ">\n"); t.push(Mn().replace(/<office:document-meta.*?>/, "").replace(/<\/office:document-meta>/, "") + "\n") } else t.push("<office:document-content" + s + ">\n"); var l = n(t, e); t.push("  <office:body>\n"); t.push("    <office:spreadsheet>\n"); if (((e.Workbook || {}).WBProps || {}).date1904) t.push('      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">\n        <table:null-date table:date-value="1904-01-01"/>\n      </table:calculation-settings>\n'); for (var o = 0; o != e.SheetNames.length; ++o)t.push(a(e.Sheets[e.SheetNames[o]], e, o, r, l)); if ((e.Workbook || {}).Names) t.push(vo(e.Workbook.Names, e.SheetNames, -1)); t.push("    </office:spreadsheet>\n"); t.push("  </office:body>\n"); if (r.bookType == "fods") t.push("</office:document>"); else t.push("</office:document-content>"); return t.join("") } }(); function bo(e, r) { if (r.bookType == "fods") return go(e, r); var t = zr(); var a = ""; var n = []; var s = []; a = "mimetype"; Br(t, a, "application/vnd.oasis.opendocument.spreadsheet"); a = "content.xml"; Br(t, a, go(e, r)); n.push([a, "text/xml"]); s.push([a, "ContentFile"]); a = "styles.xml"; Br(t, a, mo(e, r)); n.push([a, "text/xml"]); s.push([a, "StylesFile"]); a = "meta.xml"; Br(t, a, Ur + Mn()); n.push([a, "text/xml"]); s.push([a, "MetadataFile"]); a = "manifest.rdf"; Br(t, a, On(s)); n.push([a, "application/rdf+xml"]); a = "META-INF/manifest.xml"; Br(t, a, En(n)); return t } function wo(e) { return function r(t) { for (var a = 0; a != e.length; ++a) { var n = e[a]; if (t[n[0]] === undefined) t[n[0]] = n[1]; if (n[2] === "n") t[n[0]] = Number(t[n[0]]) } } } function ko(e) { wo([["cellNF", false], ["cellHTML", true], ["cellFormula", true], ["cellStyles", false], ["cellText", true], ["cellDates", false], ["sheetStubs", false], ["sheetRows", 0, "n"], ["bookDeps", false], ["bookSheets", false], ["bookProps", false], ["bookFiles", false], ["bookVBA", false], ["password", ""], ["WTF", false]])(e) } function yo(e) { wo([["cellDates", false], ["bookSST", false], ["bookType", "xlsx"], ["compression", false], ["WTF", false]])(e) } function xo(e) { if (yn.WS.indexOf(e) > -1) return "sheet"; if (yn.CS && e == yn.CS) return "chart"; if (yn.DS && e == yn.DS) return "dialog"; if (yn.MS && e == yn.MS) return "macro"; return e && e.length ? e : "sheet" } function So(e, r) { if (!e) return 0; try { e = r.map(function a(r) { if (!r.id) r.id = r.strRelID; return [r.name, e["!id"][r.id].Target, xo(e["!id"][r.id].Type)] }) } catch (t) { return null } return !e || e.length === 0 ? null : e } function Co(e, r, t, a, n, s, i, l, o, c, f, u) { try { s[a] = Sn(Ir(e, t, true), r); var h = Pr(e, r); var d; switch (l) { case "sheet": d = $l(h, r, n, o, s[a], c, f, u); break; case "chart": d = Wl(h, r, n, o, s[a], c, f, u); if (!d || !d["!drawel"]) break; var m = Wr(d["!drawel"].Target, r); var p = xn(m); var v = ni(Ir(e, m, true), Sn(Ir(e, p, true), m)); var g = Wr(v, m); var b = xn(g); d = xl(Ir(e, g, true), g, o, Sn(Ir(e, b, true), g), c, d); break; case "macro": d = Ul(h, r, n, o, s[a], c, f, u); break; case "dialog": d = jl(h, r, n, o, s[a], c, f, u); break; default: throw new Error("Unrecognized sheet type " + l); }i[a] = d; var w = []; if (s && s[a]) nr(s[a]).forEach(function (t) { var n = ""; if (s[a][t].Type == yn.CMNT) { n = Wr(s[a][t].Target, r); var i = Xl(Pr(e, n, true), n, o); if (!i || !i.length) return; li(d, i, false) } if (s[a][t].Type == yn.TCMNT) { n = Wr(s[a][t].Target, r); w = w.concat(fi(Pr(e, n, true), o)) } }); if (w && w.length) li(d, w, true, o.people || []) } catch (k) { if (o.WTF) throw k } } function _o(e) { return e.charAt(0) == "/" ? e.slice(1) : e } function Ao(e, r) { je(); r = r || {}; ko(r); if (Mr(e, "META-INF/manifest.xml")) return uo(e, r); if (Mr(e, "objectdata.xml")) return uo(e, r); if (Mr(e, "Index/Document.iwa")) { if (typeof Uint8Array == "undefined") throw new Error("NUMBERS file parsing requires Uint8Array support"); if (typeof parse_numbers_iwa != "undefined") { if (e.FileIndex) return parse_numbers_iwa(e); var t = qe.utils.cfb_new(); Lr(e).forEach(function (r) { Br(t, r, Rr(e, r)) }); return parse_numbers_iwa(t) } throw new Error("Unsupported NUMBERS file") } if (!Mr(e, "[Content_Types].xml")) { if (Mr(e, "index.xml.gz")) throw new Error("Unsupported NUMBERS 08 file"); if (Mr(e, "index.xml")) throw new Error("Unsupported NUMBERS 09 file"); throw new Error("Unsupported ZIP file") } var a = Lr(e); var n = wn(Ir(e, "[Content_Types].xml")); var s = false; var i, l; if (n.workbooks.length === 0) { l = "xl/workbook.xml"; if (Pr(e, l, true)) n.workbooks.push(l) } if (n.workbooks.length === 0) { l = "xl/workbook.bin"; if (!Pr(e, l, true)) throw new Error("Could not find workbook"); n.workbooks.push(l); s = true } if (n.workbooks[0].slice(-3) == "bin") s = true; var o = {}; var c = {}; if (!r.bookSheets && !r.bookProps) { Ni = []; if (n.sst) try { Ni = Vl(Pr(e, _o(n.sst)), n.sst, r) } catch (f) { if (r.WTF) throw f } if (r.cellStyles && n.themes.length) o = qs(Ir(e, n.themes[0].replace(/^\//, ""), true) || "", r); if (n.style) c = Hl(Pr(e, _o(n.style)), n.style, o, r) } n.links.map(function (t) { try { var a = Sn(Ir(e, xn(_o(t))), t); return Yl(Pr(e, _o(t)), a, t, r) } catch (n) { } }); var u = zl(Pr(e, _o(n.workbooks[0])), n.workbooks[0], r); var h = {}, d = ""; if (n.coreprops.length) { d = Pr(e, _o(n.coreprops[0]), true); if (d) h = In(d); if (n.extprops.length !== 0) { d = Pr(e, _o(n.extprops[0]), true); if (d) Wn(d, h, r) } } var m = {}; if (!r.bookSheets || r.bookProps) { if (n.custprops.length !== 0) { d = Ir(e, _o(n.custprops[0]), true); if (d) m = Hn(d, r) } } var p = {}; if (r.bookSheets || r.bookProps) { if (u.Sheets) i = u.Sheets.map(function O(e) { return e.name }); else if (h.Worksheets && h.SheetNames.length > 0) i = h.SheetNames; if (r.bookProps) { p.Props = h; p.Custprops = m } if (r.bookSheets && typeof i !== "undefined") p.SheetNames = i; if (r.bookSheets ? p.SheetNames : r.bookProps) return p } i = {}; var v = {}; if (r.bookDeps && n.calcchain) v = Gl(Pr(e, _o(n.calcchain)), n.calcchain, r); var g = 0; var b = {}; var w, k; { var y = u.Sheets; h.Worksheets = y.length; h.SheetNames = []; for (var x = 0; x != y.length; ++x) { h.SheetNames[x] = y[x].name } } var S = s ? "bin" : "xml"; var C = n.workbooks[0].lastIndexOf("/"); var _ = (n.workbooks[0].slice(0, C + 1) + "_rels/" + n.workbooks[0].slice(C + 1) + ".rels").replace(/^\//, ""); if (!Mr(e, _)) _ = "xl/_rels/workbook." + S + ".rels"; var A = Sn(Ir(e, _, true), _.replace(/_rels.*/, "s5s")); if ((n.metadata || []).length >= 1) { r.xlmeta = Jl(Pr(e, _o(n.metadata[0])), n.metadata[0], r) } if ((n.people || []).length >= 1) { r.people = hi(Pr(e, _o(n.people[0])), r) } if (A) A = So(A, u.Sheets); var F = Pr(e, "xl/worksheets/sheet.xml", true) ? 1 : 0; e: for (g = 0; g != h.Worksheets; ++g) { var E = "sheet"; if (A && A[g]) { w = "xl/" + A[g][1].replace(/[\/]?xl\//, ""); if (!Mr(e, w)) w = A[g][1]; if (!Mr(e, w)) w = _.replace(/_rels\/.*$/, "") + A[g][1]; E = A[g][2] } else { w = "xl/worksheets/sheet" + (g + 1 - F) + "." + S; w = w.replace(/sheet0\./, "sheet.") } k = w.replace(/^(.*)(\/)([^\/]*)$/, "$1/_rels/$3.rels"); if (r && r.sheets != null) switch (typeof r.sheets) { case "number": if (g != r.sheets) continue e; break; case "string": if (h.SheetNames[g].toLowerCase() != r.sheets.toLowerCase()) continue e; break; default: if (Array.isArray && Array.isArray(r.sheets)) { var T = false; for (var D = 0; D != r.sheets.length; ++D) { if (typeof r.sheets[D] == "number" && r.sheets[D] == g) T = 1; if (typeof r.sheets[D] == "string" && r.sheets[D].toLowerCase() == h.SheetNames[g].toLowerCase()) T = 1 } if (!T) continue e }; }Co(e, w, k, h.SheetNames[g], g, b, i, E, r, u, o, c) } p = { Directory: n, Workbook: u, Props: h, Custprops: m, Deps: v, Sheets: i, SheetNames: h.SheetNames, Strings: Ni, Styles: c, Themes: o, SSF: yr(Y) }; if (r && r.bookFiles) { if (e.files) { p.keys = a; p.files = e.files } else { p.keys = []; p.files = {}; e.FullPaths.forEach(function (r, t) { r = r.replace(/^Root Entry[\/]/, ""); p.keys.push(r); p.files[r] = e.FileIndex[t] }) } } if (r && r.bookVBA) { if (n.vba.length > 0) p.vbaraw = Pr(e, _o(n.vba[0]), true); else if (n.defaults && n.defaults.bin === mi) p.vbaraw = Pr(e, "xl/vbaProject.bin", true) } return p } function Fo(e, r) { var t = r || {}; var a = "Workbook", n = qe.find(e, a); try { a = "/!DataSpaces/Version"; n = qe.find(e, a); if (!n || !n.content) throw new Error("ECMA-376 Encrypted file missing " + a); parse_DataSpaceVersionInfo(n.content); a = "/!DataSpaces/DataSpaceMap"; n = qe.find(e, a); if (!n || !n.content) throw new Error("ECMA-376 Encrypted file missing " + a); var s = parse_DataSpaceMap(n.content); if (s.length !== 1 || s[0].comps.length !== 1 || s[0].comps[0].t !== 0 || s[0].name !== "StrongEncryptionDataSpace" || s[0].comps[0].v !== "EncryptedPackage") throw new Error("ECMA-376 Encrypted file bad " + a); a = "/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace"; n = qe.find(e, a); if (!n || !n.content) throw new Error("ECMA-376 Encrypted file missing " + a); var i = parse_DataSpaceDefinition(n.content); if (i.length != 1 || i[0] != "StrongEncryptionTransform") throw new Error("ECMA-376 Encrypted file bad " + a); a = "/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary"; n = qe.find(e, a); if (!n || !n.content) throw new Error("ECMA-376 Encrypted file missing " + a); parse_Primary(n.content) } catch (l) { } a = "/EncryptionInfo"; n = qe.find(e, a); if (!n || !n.content) throw new Error("ECMA-376 Encrypted file missing " + a); var o = parse_EncryptionInfo(n.content); a = "/EncryptedPackage"; n = qe.find(e, a); if (!n || !n.content) throw new Error("ECMA-376 Encrypted file missing " + a); if (o[0] == 4 && typeof decrypt_agile !== "undefined") return decrypt_agile(o[1], n.content, t.password || "", t); if (o[0] == 2 && typeof decrypt_std76 !== "undefined") return decrypt_std76(o[1], n.content, t.password || "", t); throw new Error("File is password-protected") } function Eo(e, r) { if (e && !e.SSF) { e.SSF = yr(Y) } if (e && e.SSF) { je(); Ue(e.SSF); r.revssf = lr(e.SSF); r.revssf[e.SSF[65535]] = 0; r.ssf = e.SSF } r.rels = {}; r.wbrels = {}; r.Strings = []; r.Strings.Count = 0; r.Strings.Unique = 0; if (Ii) r.revStrings = new Map; else { r.revStrings = {}; r.revStrings.foo = []; delete r.revStrings.foo } var t = "bin"; var a = true; var n = bn(); yo(r = r || {}); var s = zr(); var i = "", l = 0; r.cellXfs = []; zi(r.cellXfs, {}, { revssf: { General: 0 } }); if (!e.Props) e.Props = {}; i = "docProps/core.xml"; Br(s, i, Ln(e.Props, r)); n.coreprops.push(i); _n(r.rels, 2, i, yn.CORE_PROPS); i = "docProps/app.xml"; if (e.Props && e.Props.SheetNames) { } else if (!e.Workbook || !e.Workbook.Sheets) e.Props.SheetNames = e.SheetNames; else { var o = []; for (var c = 0; c < e.SheetNames.length; ++c)if ((e.Workbook.Sheets[c] || {}).Hidden != 2) o.push(e.SheetNames[c]); e.Props.SheetNames = o } e.Props.Worksheets = e.Props.SheetNames.length; Br(s, i, Un(e.Props, r)); n.extprops.push(i); _n(r.rels, 3, i, yn.EXT_PROPS); if (e.Custprops !== e.Props && nr(e.Custprops || {}).length > 0) { i = "docProps/custom.xml"; Br(s, i, Vn(e.Custprops, r)); n.custprops.push(i); _n(r.rels, 4, i, yn.CUST_PROPS) } for (l = 1; l <= e.SheetNames.length; ++l) { var f = { "!id": {} }; var u = e.Sheets[e.SheetNames[l - 1]]; var h = (u || {})["!type"] || "sheet"; switch (h) { case "chart": ; default: i = "xl/worksheets/sheet" + l + "." + t; Br(s, i, write_ws_bin(l - 1, r, e, f)); n.sheets.push(i); _n(r.wbrels, -1, "worksheets/sheet" + l + "." + t, yn.WS[0]); }if (u) { var d = u["!comments"]; var m = false; var p = ""; if (d && d.length > 0) { p = "xl/comments" + l + "." + t; Br(s, p, write_comments_bin(d, r)); n.comments.push(p); _n(f, -1, "../comments" + l + "." + t, yn.CMNT); m = true } if (u["!legacy"]) { if (m) Br(s, "xl/drawings/vmlDrawing" + l + ".vml", si(l, u["!comments"])) } delete u["!comments"]; delete u["!legacy"] } if (f["!id"].rId1) Br(s, xn(i), Cn(f)) } if (r.Strings != null && r.Strings.length > 0) { i = "xl/sharedStrings." + t; Br(s, i, write_sst_bin(r.Strings, r)); n.strs.push(i); _n(r.wbrels, -1, "sharedStrings." + t, yn.SST) } i = "xl/workbook." + t; Br(s, i, write_wb_bin(e, r)); n.workbooks.push(i); _n(r.rels, 1, i, yn.WB); i = "xl/theme/theme1.xml"; Br(s, i, Qs(e.Themes, r)); n.themes.push(i); _n(r.wbrels, -1, "theme/theme1.xml", yn.THEME); i = "xl/styles." + t; Br(s, i, write_sty_bin(e, r)); n.styles.push(i); _n(r.wbrels, -1, "styles." + t, yn.STY); if (e.vbaraw && a) { i = "xl/vbaProject.bin"; Br(s, i, e.vbaraw); n.vba.push(i); _n(r.wbrels, -1, "vbaProject.bin", yn.VBA) } i = "xl/metadata." + t; Br(s, i, write_xlmeta_bin()); n.metadata.push(i); _n(r.wbrels, -1, "metadata." + t, yn.XLMETA); Br(s, "[Content_Types].xml", kn(n, r)); Br(s, "_rels/.rels", Cn(r.rels)); Br(s, "xl/_rels/workbook." + t + ".rels", Cn(r.wbrels)); delete r.revssf; delete r.ssf; return s } function To(e, r) { if (e && !e.SSF) { e.SSF = yr(Y) } if (e && e.SSF) { je(); Ue(e.SSF); r.revssf = lr(e.SSF); r.revssf[e.SSF[65535]] = 0; r.ssf = e.SSF } r.rels = {}; r.wbrels = {}; r.Strings = []; r.Strings.Count = 0; r.Strings.Unique = 0; if (Ii) r.revStrings = new Map; else { r.revStrings = {}; r.revStrings.foo = []; delete r.revStrings.foo } var t = "xml"; var a = gi.indexOf(r.bookType) > -1; var n = bn(); yo(r = r || {}); var s = zr(); var i = "", l = 0; r.cellXfs = []; zi(r.cellXfs, {}, { revssf: { General: 0 } }); if (!e.Props) e.Props = {}; i = "docProps/core.xml"; Br(s, i, Ln(e.Props, r)); n.coreprops.push(i); _n(r.rels, 2, i, yn.CORE_PROPS); i = "docProps/app.xml"; if (e.Props && e.Props.SheetNames) { } else if (!e.Workbook || !e.Workbook.Sheets) e.Props.SheetNames = e.SheetNames; else { var o = []; for (var c = 0; c < e.SheetNames.length; ++c)if ((e.Workbook.Sheets[c] || {}).Hidden != 2) o.push(e.SheetNames[c]); e.Props.SheetNames = o } e.Props.Worksheets = e.Props.SheetNames.length; Br(s, i, Un(e.Props, r)); n.extprops.push(i); _n(r.rels, 3, i, yn.EXT_PROPS); if (e.Custprops !== e.Props && nr(e.Custprops || {}).length > 0) { i = "docProps/custom.xml"; Br(s, i, Vn(e.Custprops, r)); n.custprops.push(i); _n(r.rels, 4, i, yn.CUST_PROPS) } var f = ["SheetJ5"]; r.tcid = 0; for (l = 1; l <= e.SheetNames.length; ++l) { var u = { "!id": {} }; var h = e.Sheets[e.SheetNames[l - 1]]; var d = (h || {})["!type"] || "sheet"; switch (d) { case "chart": ; default: i = "xl/worksheets/sheet" + l + "." + t; Br(s, i, kl(l - 1, r, e, u)); n.sheets.push(i); _n(r.wbrels, -1, "worksheets/sheet" + l + "." + t, yn.WS[0]); }if (h) { var m = h["!comments"]; var p = false; var v = ""; if (m && m.length > 0) { var g = false; m.forEach(function (e) { e[1].forEach(function (e) { if (e.T == true) g = true }) }); if (g) { v = "xl/threadedComments/threadedComment" + l + ".xml"; Br(s, v, ui(m, f, r)); n.threadedcomments.push(v); _n(u, -1, "../threadedComments/threadedComment" + l + ".xml", yn.TCMNT) } v = "xl/comments" + l + "." + t; Br(s, v, ci(m, r)); n.comments.push(v); _n(u, -1, "../comments" + l + "." + t, yn.CMNT); p = true } if (h["!legacy"]) { if (p) Br(s, "xl/drawings/vmlDrawing" + l + ".vml", si(l, h["!comments"])) } delete h["!comments"]; delete h["!legacy"] } if (u["!id"].rId1) Br(s, xn(i), Cn(u)) } if (r.Strings != null && r.Strings.length > 0) { i = "xl/sharedStrings." + t; Br(s, i, us(r.Strings, r)); n.strs.push(i); _n(r.wbrels, -1, "sharedStrings." + t, yn.SST) } i = "xl/workbook." + t; Br(s, i, Bl(e, r)); n.workbooks.push(i); _n(r.rels, 1, i, yn.WB); i = "xl/theme/theme1.xml"; Br(s, i, Qs(e.Themes, r)); n.themes.push(i); _n(r.wbrels, -1, "theme/theme1.xml", yn.THEME); i = "xl/styles." + t; Br(s, i, Us(e, r)); n.styles.push(i); _n(r.wbrels, -1, "styles." + t, yn.STY); if (e.vbaraw && a) { i = "xl/vbaProject.bin"; Br(s, i, e.vbaraw); n.vba.push(i); _n(r.wbrels, -1, "vbaProject.bin", yn.VBA) } i = "xl/metadata." + t; Br(s, i, ri()); n.metadata.push(i); _n(r.wbrels, -1, "metadata." + t, yn.XLMETA); if (f.length > 1) { i = "xl/persons/person.xml"; Br(s, i, di(f, r)); n.people.push(i); _n(r.wbrels, -1, "persons/person.xml", yn.PEOPLE) } Br(s, "[Content_Types].xml", kn(n, r)); Br(s, "_rels/.rels", Cn(r.rels)); Br(s, "xl/_rels/workbook." + t + ".rels", Cn(r.wbrels)); delete r.revssf; delete r.ssf; return s } function Do(e, r) { var t = ""; switch ((r || {}).type || "base64") { case "buffer": return [e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7]]; case "base64": t = y(e.slice(0, 12)); break; case "binary": t = e; break; case "array": return [e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7]]; default: throw new Error("Unrecognized type " + (r && r.type || "undefined")); }return [t.charCodeAt(0), t.charCodeAt(1), t.charCodeAt(2), t.charCodeAt(3), t.charCodeAt(4), t.charCodeAt(5), t.charCodeAt(6), t.charCodeAt(7)] } function Oo(e, r) { if (qe.find(e, "EncryptedPackage")) return Fo(e, r); return parse_xlscfb(e, r) } function Mo(e, r) { var t, a = e; var n = r || {}; if (!n.type) n.type = x && Buffer.isBuffer(e) ? "buffer" : "base64"; t = $r(a, n); return Ao(t, n) } function No(e, r) { var t = 0; e: while (t < e.length) switch (e.charCodeAt(t)) { case 10: ; case 13: ; case 32: ++t; break; case 60: return parse_xlml(e.slice(t), r); default: break e; }return Zn.to_workbook(e, r) } function Po(e, r) { var t = "", a = Do(e, r); switch (r.type) { case "base64": t = y(e); break; case "binary": t = e; break; case "buffer": t = e.toString("binary"); break; case "array": t = kr(e); break; default: throw new Error("Unrecognized type " + r.type); }if (a[0] == 239 && a[1] == 187 && a[2] == 191) t = mt(t); r.type = "binary"; return No(t, r) } function Io(e, r) { var t = e; if (r.type == "base64") t = y(t); t = a.utils.decode(1200, t.slice(2), "str"); r.type = "binary"; return No(t, r) } function Ro(e) { return !e.match(/[^\x00-\x7F]/) ? e : pt(e) } function Lo(e, r, t, a) { if (a) { t.type = "string"; return Zn.to_workbook(e, t) } return Zn.to_workbook(r, t) } function Bo(e, r) { c(); var t = r || {}; if (typeof ArrayBuffer !== "undefined" && e instanceof ArrayBuffer) return Bo(new Uint8Array(e), (t = yr(t), t.type = "array", t)); if (typeof Uint8Array !== "undefined" && e instanceof Uint8Array && !t.type) t.type = typeof Deno !== "undefined" ? "buffer" : "array"; var a = e, n = [0, 0, 0, 0], s = false; if (t.cellStyles) { t.cellNF = true; t.sheetStubs = true } Pi = {}; if (t.dateNF) Pi.dateNF = t.dateNF; if (!t.type) t.type = x && Buffer.isBuffer(e) ? "buffer" : "base64"; if (t.type == "file") { t.type = x ? "buffer" : "binary"; a = ar(e); if (typeof Uint8Array !== "undefined" && !x) t.type = "array" } if (t.type == "string") { s = true; t.type = "binary"; t.codepage = 65001; a = Ro(e) } if (t.type == "array" && typeof Uint8Array !== "undefined" && e instanceof Uint8Array && typeof ArrayBuffer !== "undefined") { var i = new ArrayBuffer(3), l = new Uint8Array(i); l.foo = "bar"; if (!l.foo) { t = yr(t); t.type = "array"; return Bo(D(a), t) } } switch ((n = Do(a, t))[0]) { case 208: if (n[1] === 207 && n[2] === 17 && n[3] === 224 && n[4] === 161 && n[5] === 177 && n[6] === 26 && n[7] === 225) return Oo(qe.read(a, t), t); break; case 9: if (n[1] <= 8) return parse_xlscfb(a, t); break; case 60: return parse_xlml(a, t); case 73: if (n[1] === 73 && n[2] === 42 && n[3] === 0) throw new Error("TIFF Image File is not a spreadsheet"); if (n[1] === 68) return qn(a, t); break; case 84: if (n[1] === 65 && n[2] === 66 && n[3] === 76) return Jn.to_workbook(a, t); break; case 80: return n[1] === 75 && n[2] < 9 && n[3] < 9 ? Mo(a, t) : Lo(e, a, t, s); case 239: return n[3] === 60 ? parse_xlml(a, t) : Lo(e, a, t, s); case 255: if (n[1] === 254) { return Io(a, t) } else if (n[1] === 0 && n[2] === 2 && n[3] === 0) return WK_.to_workbook(a, t); break; case 0: if (n[1] === 0) { if (n[2] >= 2 && n[3] === 0) return WK_.to_workbook(a, t); if (n[2] === 0 && (n[3] === 8 || n[3] === 9)) return WK_.to_workbook(a, t) } break; case 3: ; case 131: ; case 139: ; case 140: return Gn.to_workbook(a, t); case 123: if (n[1] === 92 && n[2] === 114 && n[3] === 116) return RTF.to_workbook(a, t); break; case 10: ; case 13: ; case 32: return Po(a, t); case 137: if (n[1] === 80 && n[2] === 78 && n[3] === 71) throw new Error("PNG Image File is not a spreadsheet"); break; case 8: if (n[1] === 231) throw new Error("Unsupported Multiplan 1.x file!"); break; case 12: if (n[1] === 236) throw new Error("Unsupported Multiplan 2.x file!"); if (n[1] === 237) throw new Error("Unsupported Multiplan 3.x file!"); break; }if (Xn.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return Gn.to_workbook(a, t); return Lo(e, a, t, s) } function zo(e, r) { var t = r || {}; t.type = "file"; return Bo(e, t) } function $o(e, r) { switch (r.type) { case "base64": ; case "binary": break; case "buffer": ; case "array": r.type = ""; break; case "file": return tr(r.file, qe.write(e, { type: x ? "buffer" : "" })); case "string": throw new Error("'string' output type invalid for '" + r.bookType + "' files"); default: throw new Error("Unrecognized type " + r.type); }return qe.write(e, r) } function Wo(e, r) { switch (r.bookType) { case "ods": return bo(e, r); case "numbers": return write_numbers_iwa(e, r); case "xlsb": return Eo(e, r); default: return To(e, r); } } function Uo(e, r) { var t = yr(r || {}); var a = Wo(e, t); return Ho(a, t) } function jo(e, r) { var t = yr(r || {}); var a = To(e, t); return Ho(a, t) } function Ho(e, r) { var t = {}; var a = x ? "nodebuffer" : typeof Uint8Array !== "undefined" ? "array" : "string"; if (r.compression) t.compression = "DEFLATE"; if (r.password) t.type = a; else switch (r.type) { case "base64": t.type = "base64"; break; case "binary": t.type = "string"; break; case "string": throw new Error("'string' output type invalid for '" + r.bookType + "' files"); case "buffer": ; case "file": t.type = a; break; default: throw new Error("Unrecognized type " + r.type); }var n = e.FullPaths ? qe.write(e, { fileType: "zip", type: { nodebuffer: "buffer", string: "binary" }[t.type] || t.type, compression: !!r.compression }) : e.generate(t); if (typeof Deno !== "undefined") { if (typeof n == "string") { if (r.type == "binary" || r.type == "base64") return n; n = new Uint8Array(F(n)) } } if (r.password && typeof encrypt_agile !== "undefined") return $o(encrypt_agile(n, r.password), r); if (r.type === "file") return tr(r.file, n); return r.type == "string" ? mt(n) : n } function Vo(e, r) { var t = r || {}; var a = write_xlscfb(e, t); return $o(a, t) } function Xo(e, r, t) { if (!t) t = ""; var a = t + e; switch (r.type) { case "base64": return k(pt(a)); case "binary": return pt(a); case "string": return e; case "file": return tr(r.file, a, "utf8"); case "buffer": { if (x) return S(a, "utf8"); else if (typeof TextEncoder !== "undefined") return (new TextEncoder).encode(a); else return Xo(a, { type: "binary" }).split("").map(function (e) { return e.charCodeAt(0) }) }; }throw new Error("Unrecognized type " + r.type) } function Go(e, r) { switch (r.type) { case "base64": return k(e); case "binary": return e; case "string": return e; case "file": return tr(r.file, e, "binary"); case "buffer": { if (x) return S(e, "binary"); else return e.split("").map(function (e) { return e.charCodeAt(0) }) }; }throw new Error("Unrecognized type " + r.type) } function Yo(e, r) { switch (r.type) { case "string": ; case "base64": ; case "binary": var t = ""; for (var a = 0; a < e.length; ++a)t += String.fromCharCode(e[a]); return r.type == "base64" ? k(t) : r.type == "string" ? mt(t) : t; case "file": return tr(r.file, e); case "buffer": return e; default: throw new Error("Unrecognized type " + r.type); } } function Jo(e, r) { c(); Il(e); var t = yr(r || {}); if (t.cellStyles) { t.cellNF = true; t.sheetStubs = true } if (t.type == "array") { t.type = "binary"; var a = Jo(e, t); t.type = "array"; return F(a) } return jo(e, t) } function Ko(e, r) {
        c(); Il(e); var t = yr(r || {}); if (t.cellStyles) { t.cellNF = true; t.sheetStubs = true } if (t.type == "array") { t.type = "binary"; var a = Ko(e, t); t.type = "array"; return F(a) } var n = 0; if (t.sheet) { if (typeof t.sheet == "number") n = t.sheet; else n = e.SheetNames.indexOf(t.sheet); if (!e.SheetNames[n]) throw new Error("Sheet not found: " + t.sheet + " : " + typeof t.sheet) } switch (t.bookType || "xlsb") {
            case "xml": ; case "xlml": return Xo(write_xlml(e, t), t); case "slk": ; case "sylk": return Xo(Yn.from_sheet(e.Sheets[e.SheetNames[n]], t, e), t); case "htm": ; case "html": return Xo(to(e.Sheets[e.SheetNames[n]], t), t); case "txt": return Go(ic(e.Sheets[e.SheetNames[n]], t), t); case "csv": return Xo(sc(e.Sheets[e.SheetNames[n]], t), t, "\ufeff"); case "dif": return Xo(Jn.from_sheet(e.Sheets[e.SheetNames[n]], t), t); case "dbf": return Yo(Gn.from_sheet(e.Sheets[e.SheetNames[n]], t), t); case "prn": return Xo(Zn.from_sheet(e.Sheets[e.SheetNames[n]], t), t); case "rtf": return Xo(RTF.from_sheet(e.Sheets[e.SheetNames[n]], t), t); case "eth": return Xo(Kn.from_sheet(e.Sheets[e.SheetNames[n]], t), t); case "fods":
                return Xo(bo(e, t), t); case "wk1": return Yo(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[n]], t), t); case "wk3": return Yo(WK_.book_to_wk3(e, t), t); case "biff2": if (!t.biff) t.biff = 2; case "biff3": if (!t.biff) t.biff = 3; case "biff4": if (!t.biff) t.biff = 4; return Yo(write_biff_buf(e, t), t); case "biff5": if (!t.biff) t.biff = 5; case "biff8": ; case "xla": ; case "xls": if (!t.biff) t.biff = 8; return Vo(e, t); case "xlsx": ; case "xlsm": ; case "xlam": ; case "xlsb": ; case "numbers": ; case "ods": return Uo(e, t); default: throw new Error("Unrecognized bookType |" + t.bookType + "|");
        }
    } function Zo(e) { if (e.bookType) return; var r = { xls: "biff8", htm: "html", slk: "sylk", socialcalc: "eth", Sh33tJS: "WTF" }; var t = e.file.slice(e.file.lastIndexOf(".")).toLowerCase(); if (t.match(/^\.[a-z]+$/)) e.bookType = t.slice(1); e.bookType = r[e.bookType] || e.bookType } function qo(e, r, t) { var a = t || {}; a.type = "file"; a.file = r; Zo(a); return Ko(e, a) } function Qo(e, r, t) { var a = t || {}; a.type = "file"; a.file = r; Zo(a); return Jo(e, a) } function ec(e, r, t, a) { var n = t || {}; n.type = "file"; n.file = e; Zo(n); n.type = "buffer"; var s = a; if (!(s instanceof Function)) s = t; return Qe.writeFile(e, Ko(r, n), s) } function rc(e, r, t, a, n, s, i, l) { var o = Aa(t); var c = l.defval, f = l.raw || !Object.prototype.hasOwnProperty.call(l, "raw"); var u = true; var h = n === 1 ? [] : {}; if (n !== 1) { if (Object.defineProperty) try { Object.defineProperty(h, "__rowNum__", { value: t, enumerable: false }) } catch (d) { h.__rowNum__ = t } else h.__rowNum__ = t } if (!i || e[t]) for (var m = r.s.c; m <= r.e.c; ++m) { var p = i ? e[t][m] : e[a[m] + o]; if (p === undefined || p.t === undefined) { if (c === undefined) continue; if (s[m] != null) { h[s[m]] = c } continue } var v = p.v; switch (p.t) { case "z": if (v == null) break; continue; case "e": v = v == 0 ? null : void 0; break; case "s": ; case "d": ; case "b": ; case "n": break; default: throw new Error("unrecognized type " + p.t); }if (s[m] != null) { if (v == null) { if (p.t == "e" && v === null) h[s[m]] = null; else if (c !== undefined) h[s[m]] = c; else if (f && v === null) h[s[m]] = null; else continue } else { h[s[m]] = f && (p.t !== "n" || p.t === "n" && l.rawNumbers !== false) ? v : Ua(p, v, l) } if (v != null) u = false } } return { row: h, isempty: u } } function tc(e, r) { if (e == null || e["!ref"] == null) return []; var t = { t: "n", v: 0 }, a = 0, n = 1, s = [], i = 0, l = ""; var o = { s: { r: 0, c: 0 }, e: { r: 0, c: 0 } }; var c = r || {}; var f = c.range != null ? c.range : e["!ref"]; if (c.header === 1) a = 1; else if (c.header === "A") a = 2; else if (Array.isArray(c.header)) a = 3; else if (c.header == null) a = 0; switch (typeof f) { case "string": o = $a(f); break; case "number": o = $a(e["!ref"]); o.s.r = f; break; default: o = f; }if (a > 0) n = 0; var u = Aa(o.s.r); var h = []; var d = []; var m = 0, p = 0; var v = Array.isArray(e); var g = o.s.r, b = 0; var w = {}; if (v && !e[g]) e[g] = []; var k = c.skipHidden && e["!cols"] || []; var y = c.skipHidden && e["!rows"] || []; for (b = o.s.c; b <= o.e.c; ++b) { if ((k[b] || {}).hidden) continue; h[b] = Da(b); t = v ? e[g][b] : e[h[b] + u]; switch (a) { case 1: s[b] = b - o.s.c; break; case 2: s[b] = h[b]; break; case 3: s[b] = c.header[b - o.s.c]; break; default: if (t == null) t = { w: "__EMPTY", t: "s" }; l = i = Ua(t, null, c); p = w[i] || 0; if (!p) w[i] = 1; else { do { l = i + "_" + p++ } while (w[l]); w[i] = p; w[l] = 1 } s[b] = l; } } for (g = o.s.r + n; g <= o.e.r; ++g) { if ((y[g] || {}).hidden) continue; var x = rc(e, o, g, h, a, s, v, c); if (x.isempty === false || (a === 1 ? c.blankrows !== false : !!c.blankrows)) d[m++] = x.row } d.length = m; return d } var ac = /"/g; function nc(e, r, t, a, n, s, i, l) { var o = true; var c = [], f = "", u = Aa(t); for (var h = r.s.c; h <= r.e.c; ++h) { if (!a[h]) continue; var d = l.dense ? (e[t] || [])[h] : e[a[h] + u]; if (d == null) f = ""; else if (d.v != null) { o = false; f = "" + (l.rawNumbers && d.t == "n" ? d.v : Ua(d, null, l)); for (var m = 0, p = 0; m !== f.length; ++m)if ((p = f.charCodeAt(m)) === n || p === s || p === 34 || l.forceQuotes) { f = '"' + f.replace(ac, '""') + '"'; break } if (f == "ID") f = '"ID"' } else if (d.f != null && !d.F) { o = false; f = "=" + d.f; if (f.indexOf(",") >= 0) f = '"' + f.replace(ac, '""') + '"' } else f = ""; c.push(f) } if (l.blankrows === false && o) return null; return c.join(i) } function sc(e, r) { var t = []; var a = r == null ? {} : r; if (e == null || e["!ref"] == null) return ""; var n = $a(e["!ref"]); var s = a.FS !== undefined ? a.FS : ",", i = s.charCodeAt(0); var l = a.RS !== undefined ? a.RS : "\n", o = l.charCodeAt(0); var c = new RegExp((s == "|" ? "\\|" : s) + "+$"); var f = "", u = []; a.dense = Array.isArray(e); var h = a.skipHidden && e["!cols"] || []; var d = a.skipHidden && e["!rows"] || []; for (var m = n.s.c; m <= n.e.c; ++m)if (!(h[m] || {}).hidden) u[m] = Da(m); var p = 0; for (var v = n.s.r; v <= n.e.r; ++v) { if ((d[v] || {}).hidden) continue; f = nc(e, n, v, u, i, o, s, a); if (f == null) { continue } if (a.strip) f = f.replace(c, ""); if (f || a.blankrows !== false) t.push((p++ ? l : "") + f) } delete a.dense; return t.join("") } function ic(e, r) { if (!r) r = {}; r.FS = "\t"; r.RS = "\n"; var t = sc(e, r); if (typeof a == "undefined" || r.type == "string") return t; var n = a.utils.encode(1200, t, "str"); return String.fromCharCode(255) + String.fromCharCode(254) + n } function lc(e) { var r = "", t, a = ""; if (e == null || e["!ref"] == null) return []; var n = $a(e["!ref"]), s = "", i = [], l; var o = []; var c = Array.isArray(e); for (l = n.s.c; l <= n.e.c; ++l)i[l] = Da(l); for (var f = n.s.r; f <= n.e.r; ++f) { s = Aa(f); for (l = n.s.c; l <= n.e.c; ++l) { r = i[l] + s; t = c ? (e[f] || [])[l] : e[r]; a = ""; if (t === undefined) continue; else if (t.F != null) { r = t.F; if (!t.f) continue; a = t.f; if (r.indexOf(":") == -1) r = r + ":" + r } if (t.f != null) a = t.f; else if (t.t == "z") continue; else if (t.t == "n" && t.v != null) a = "" + t.v; else if (t.t == "b") a = t.v ? "TRUE" : "FALSE"; else if (t.w !== undefined) a = "'" + t.w; else if (t.v === undefined) continue; else if (t.t == "s") a = "'" + t.v; else a = "" + t.v; o[o.length] = r + "=" + a } } return o } function oc(e, r, t) { var a = t || {}; var n = +!a.skipHeader; var s = e || {}; var i = 0, l = 0; if (s && a.origin != null) { if (typeof a.origin == "number") i = a.origin; else { var o = typeof a.origin == "string" ? Pa(a.origin) : a.origin; i = o.r; l = o.c } } var c; var f = { s: { c: 0, r: 0 }, e: { c: l, r: i + r.length - 1 + n } }; if (s["!ref"]) { var u = $a(s["!ref"]); f.e.c = Math.max(f.e.c, u.e.c); f.e.r = Math.max(f.e.r, u.e.r); if (i == -1) { i = u.e.r + 1; f.e.r = i + r.length - 1 + n } } else { if (i == -1) { i = 0; f.e.r = r.length - 1 + n } } var h = a.header || [], d = 0; r.forEach(function (e, r) { nr(e).forEach(function (t) { if ((d = h.indexOf(t)) == -1) h[d = h.length] = t; var o = e[t]; var f = "z"; var u = ""; var m = Ia({ c: l + d, r: i + r + n }); c = fc(s, m); if (o && typeof o === "object" && !(o instanceof Date)) { s[m] = o } else { if (typeof o == "number") f = "n"; else if (typeof o == "boolean") f = "b"; else if (typeof o == "string") f = "s"; else if (o instanceof Date) { f = "d"; if (!a.cellDates) { f = "n"; o = fr(o) } u = c.z && Ie(c.z) ? c.z : a.dateNF || Y[14] } else if (o === null && a.nullError) { f = "e"; o = 0 } if (!c) s[m] = c = { t: f, v: o }; else { c.t = f; c.v = o; delete c.w; delete c.R; if (u) c.z = u } if (u) c.z = u } }) }); f.e.c = Math.max(f.e.c, l + h.length - 1); var m = Aa(i); if (n) for (d = 0; d < h.length; ++d)s[Da(d + l) + m] = { t: "s", v: h[d] }; s["!ref"] = La(f); return s } function cc(e, r) { return oc(null, e, r) } function fc(e, r, t) { if (typeof r == "string") { if (Array.isArray(e)) { var a = Pa(r); if (!e[a.r]) e[a.r] = []; return e[a.r][a.c] || (e[a.r][a.c] = { t: "z" }) } return e[r] || (e[r] = { t: "z" }) } if (typeof r != "number") return fc(e, Ia(r)); return fc(e, Ia({ r: r, c: t || 0 })) } function uc(e, r) { if (typeof r == "number") { if (r >= 0 && e.SheetNames.length > r) return r; throw new Error("Cannot find sheet # " + r) } else if (typeof r == "string") { var t = e.SheetNames.indexOf(r); if (t > -1) return t; throw new Error("Cannot find sheet name |" + r + "|") } else throw new Error("Cannot find sheet |" + r + "|") } function hc() { return { SheetNames: [], Sheets: {} } } function dc(e, r, t, a) { var n = 1; if (!t) for (; n <= 65535; ++n, t = undefined)if (e.SheetNames.indexOf(t = "Sheet" + n) == -1) break; if (!t || e.SheetNames.length >= 65535) throw new Error("Too many worksheets"); if (a && e.SheetNames.indexOf(t) >= 0) { var s = t.match(/(^.*?)(\d+)$/); n = s && +s[2] || 0; var i = s && s[1] || t; for (++n; n <= 65535; ++n)if (e.SheetNames.indexOf(t = i + n) == -1) break } Nl(t); if (e.SheetNames.indexOf(t) >= 0) throw new Error("Worksheet with name |" + t + "| already exists!"); e.SheetNames.push(t); e.Sheets[t] = r; return t } function mc(e, r, t) { if (!e.Workbook) e.Workbook = {}; if (!e.Workbook.Sheets) e.Workbook.Sheets = []; var a = uc(e, r); if (!e.Workbook.Sheets[a]) e.Workbook.Sheets[a] = {}; switch (t) { case 0: ; case 1: ; case 2: break; default: throw new Error("Bad sheet visibility setting " + t); }e.Workbook.Sheets[a].Hidden = t } function pc(e, r) { e.z = r; return e } function vc(e, r, t) { if (!r) { delete e.l } else { e.l = { Target: r }; if (t) e.l.Tooltip = t } return e } function gc(e, r, t) { return vc(e, "#" + r, t) } function bc(e, r, t) { if (!e.c) e.c = []; e.c.push({ t: r, a: t || "SheetJS" }) } function wc(e, r, t, a) { var n = typeof r != "string" ? r : $a(r); var s = typeof r == "string" ? r : La(r); for (var i = n.s.r; i <= n.e.r; ++i)for (var l = n.s.c; l <= n.e.c; ++l) { var o = fc(e, i, l); o.t = "n"; o.F = s; delete o.v; if (i == n.s.r && l == n.s.c) { o.f = t; if (a) o.D = true } } var c = Ra(e["!ref"]); if (c.s.r > n.s.r) c.s.r = n.s.r; if (c.s.c > n.s.c) c.s.c = n.s.c; if (c.e.r < n.e.r) c.e.r = n.e.r; if (c.e.c < n.e.c) c.e.c = n.e.c; e["!ref"] = La(c); return e } var kc = { encode_col: Da, encode_row: Aa, encode_cell: Ia, encode_range: La, decode_col: Ta, decode_row: _a, split_cell: Na, decode_cell: Pa, decode_range: Ra, format_cell: Ua, sheet_add_aoa: Ha, sheet_add_json: oc, sheet_add_dom: ao, aoa_to_sheet: Va, json_to_sheet: cc, table_to_sheet: no, table_to_book: so, sheet_to_csv: sc, sheet_to_txt: ic, sheet_to_json: tc, sheet_to_html: to, sheet_to_formulae: lc, sheet_to_row_object_array: tc, sheet_get_cell: fc, book_new: hc, book_append_sheet: dc, book_set_sheet_visibility: mc, cell_set_number_format: pc, cell_set_hyperlink: vc, cell_set_internal_link: gc, cell_add_comment: bc, sheet_set_array_formula: wc, consts: { SHEET_VISIBLE: 0, SHEET_HIDDEN: 1, SHEET_VERY_HIDDEN: 2 } }; if (typeof parse_xlscfb !== "undefined") e.parse_xlscfb = parse_xlscfb; e.parse_zip = Ao; e.read = Bo; e.readFile = zo; e.readFileSync = zo; e.write = Ko; e.writeFile = qo; e.writeFileSync = qo; e.writeFileAsync = ec; e.utils = kc; e.writeXLSX = Jo; e.writeFileXLSX = Qo; e.SSF = He; if (typeof __stream !== "undefined") e.stream = __stream; if (typeof qe !== "undefined") e.CFB = qe; if (typeof require !== "undefined") { var yc = undefined; if ((yc || {}).Readable) set_readable(yc.Readable); try { Qe = undefined } catch (xc) { } }
} if (typeof exports !== "undefined") make_xlsx_lib(exports); else if (typeof module !== "undefined" && module.exports) make_xlsx_lib(module.exports); else if (typeof define === "function" && define.amd) define("xlsx", function () { if (!XLSX.version) make_xlsx_lib(XLSX); return XLSX }); else make_xlsx_lib(XLSX); if (typeof window !== "undefined" && !window.XLSX) try { window.XLSX = XLSX } catch (e) { }